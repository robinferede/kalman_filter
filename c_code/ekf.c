
#include "ekf.h"
#include <math.h>

float X[N_STATES];
float P[N_STATES][N_STATES];
float Q_diag[N_INPUTS];
float R_diag[N_MEASUREMENTS];
               
/** Calculate inverse of any n x n matrix (passed as C array) o = mat^-1
Algorithm verified with Matlab.
Thanks to: https://www.quora.com/How-do-I-make-a-C++-program-to-get-the-inverse-of-a-matrix-100-X-100
*/
void float_mat_invert(float **o, float **mat, int n)
{
  int i, j, k;
  float t;
  float a[n][2 * n];

  // Append an identity matrix on the right of the original matrix
  for (i = 0; i < n; i++) {
    for (j = 0; j < 2 * n; j++) {
      if (j < n) {
        a[i][j] = mat[i][j];
      } else if ((j >= n) && (j == i + n)) {
        a[i][j] = 1.0;
      } else {
        a[i][j] = 0.0;
      }
    }
  }

  // Do the inversion
  for (i = 0; i < n; i++) {
    t = a[i][i]; // Store diagonal variable (temp)

    for (j = i; j < 2 * n; j++) {
      a[i][j] = a[i][j] / t; // Divide by the diagonal value
    }

    for (j = 0; j < n; j++) {
      if (i != j) {
        t = a[j][i];
        for (k = 0; k < 2 * n; k++) {
          a[j][k] = a[j][k] - t * a[i][k];
        }
      }
    }
  }

  // Cut out the identity, which has now moved to the left side
  for (i = 0 ; i < n ; i++) {
    for (j = n; j < 2 * n; j++) {
      o[i][j - n] = a[i][j];
    }
  }
}

void ekf_predict(float U[N_INPUTS], float dt) {
    // [1] state prediction X_pred = f(X,U,dt)
    float X_pred[N_STATES];
    X_pred[0] = X[0] + X[3]*dt;
    X_pred[1] = X[1] + X[4]*dt;
    X_pred[2] = X[2] + X[5]*dt;
    X_pred[3] = X[3] + dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])));
    X_pred[4] = X[4] + dt*((U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*sin(X[8]) + cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])));
    X_pred[5] = X[5] + dt*(-(U[0] - X[9])*sin(X[7]) + (U[1] - X[10])*sin(X[6])*cos(X[7]) + (U[2] - X[11])*cos(X[6])*cos(X[7]) + 9.8100000000000005);
    X_pred[6] = X[6] + dt*(U[3] - X[12] + (U[4] - X[13])*sin(X[6])*tan(X[7]) + (U[5] - X[14])*cos(X[6])*tan(X[7]));
    X_pred[7] = X[7] + dt*((U[4] - X[13])*cos(X[6]) - (U[5] - X[14])*sin(X[6]));
    X_pred[8] = X[8] + dt*((U[4] - X[13])*sin(X[6])/cos(X[7]) + (U[5] - X[14])*cos(X[6])/cos(X[7]));
    X_pred[9] = X[9];
    X_pred[10] = X[10];
    X_pred[11] = X[11];
    X_pred[12] = X[12];
    X_pred[13] = X[13];
    X_pred[14] = X[14];

    // [2] covariance prediction P = F*P*F.T + L*Q*L.T
    float P_pred[N_STATES][N_STATES]; 
    P_pred[0][0] = P[0][0] + P[3][0]*dt + dt*(P[0][3] + P[3][3]*dt);
    P_pred[0][1] = P[0][1] + P[3][1]*dt + dt*(P[0][4] + P[3][4]*dt);
    P_pred[0][2] = P[0][2] + P[3][2]*dt + dt*(P[0][5] + P[3][5]*dt);
    P_pred[0][3] = P[0][3] + P[3][3]*dt + dt*(P[0][10] + P[3][10]*dt)*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + dt*(P[0][11] + P[3][11]*dt)*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + dt*(P[0][6] + P[3][6]*dt)*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + dt*(P[0][7] + P[3][7]*dt)*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + dt*(P[0][8] + P[3][8]*dt)*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - dt*(P[0][9] + P[3][9]*dt)*cos(X[7])*cos(X[8]);
    P_pred[0][4] = P[0][4] + P[3][4]*dt + dt*(P[0][10] + P[3][10]*dt)*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + dt*(P[0][11] + P[3][11]*dt)*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + dt*(P[0][6] + P[3][6]*dt)*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + dt*(P[0][7] + P[3][7]*dt)*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + dt*(P[0][8] + P[3][8]*dt)*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - dt*(P[0][9] + P[3][9]*dt)*sin(X[8])*cos(X[7]);
    P_pred[0][5] = P[0][5] + P[3][5]*dt - dt*(P[0][10] + P[3][10]*dt)*sin(X[6])*cos(X[7]) - dt*(P[0][11] + P[3][11]*dt)*cos(X[6])*cos(X[7]) + dt*(P[0][6] + P[3][6]*dt)*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + dt*(P[0][7] + P[3][7]*dt)*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + dt*(P[0][9] + P[3][9]*dt)*sin(X[7]);
    P_pred[0][6] = -dt*(P[0][12] + P[3][12]*dt) - dt*(P[0][13] + P[3][13]*dt)*sin(X[6])*tan(X[7]) - dt*(P[0][14] + P[3][14]*dt)*cos(X[6])*tan(X[7]) + dt*(P[0][7] + P[3][7]*dt)*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])) + (P[0][6] + P[3][6]*dt)*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1);
    P_pred[0][7] = P[0][7] + P[3][7]*dt - dt*(P[0][13] + P[3][13]*dt)*cos(X[6]) + dt*(P[0][14] + P[3][14]*dt)*sin(X[6]) + dt*(P[0][6] + P[3][6]*dt)*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6]));
    P_pred[0][8] = P[0][8] + P[3][8]*dt - dt*(P[0][13] + P[3][13]*dt)*sin(X[6])/cos(X[7]) - dt*(P[0][14] + P[3][14]*dt)*cos(X[6])/cos(X[7]) + dt*(P[0][6] + P[3][6]*dt)*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + dt*(P[0][7] + P[3][7]*dt)*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2));
    P_pred[0][9] = P[0][9] + P[3][9]*dt;
    P_pred[0][10] = P[0][10] + P[3][10]*dt;
    P_pred[0][11] = P[0][11] + P[3][11]*dt;
    P_pred[0][12] = P[0][12] + P[3][12]*dt;
    P_pred[0][13] = P[0][13] + P[3][13]*dt;
    P_pred[0][14] = P[0][14] + P[3][14]*dt;
    P_pred[1][0] = P[1][0] + P[4][0]*dt + dt*(P[1][3] + P[4][3]*dt);
    P_pred[1][1] = P[1][1] + P[4][1]*dt + dt*(P[1][4] + P[4][4]*dt);
    P_pred[1][2] = P[1][2] + P[4][2]*dt + dt*(P[1][5] + P[4][5]*dt);
    P_pred[1][3] = P[1][3] + P[4][3]*dt + dt*(P[1][10] + P[4][10]*dt)*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + dt*(P[1][11] + P[4][11]*dt)*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + dt*(P[1][6] + P[4][6]*dt)*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + dt*(P[1][7] + P[4][7]*dt)*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + dt*(P[1][8] + P[4][8]*dt)*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - dt*(P[1][9] + P[4][9]*dt)*cos(X[7])*cos(X[8]);
    P_pred[1][4] = P[1][4] + P[4][4]*dt + dt*(P[1][10] + P[4][10]*dt)*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + dt*(P[1][11] + P[4][11]*dt)*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + dt*(P[1][6] + P[4][6]*dt)*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + dt*(P[1][7] + P[4][7]*dt)*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + dt*(P[1][8] + P[4][8]*dt)*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - dt*(P[1][9] + P[4][9]*dt)*sin(X[8])*cos(X[7]);
    P_pred[1][5] = P[1][5] + P[4][5]*dt - dt*(P[1][10] + P[4][10]*dt)*sin(X[6])*cos(X[7]) - dt*(P[1][11] + P[4][11]*dt)*cos(X[6])*cos(X[7]) + dt*(P[1][6] + P[4][6]*dt)*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + dt*(P[1][7] + P[4][7]*dt)*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + dt*(P[1][9] + P[4][9]*dt)*sin(X[7]);
    P_pred[1][6] = -dt*(P[1][12] + P[4][12]*dt) - dt*(P[1][13] + P[4][13]*dt)*sin(X[6])*tan(X[7]) - dt*(P[1][14] + P[4][14]*dt)*cos(X[6])*tan(X[7]) + dt*(P[1][7] + P[4][7]*dt)*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])) + (P[1][6] + P[4][6]*dt)*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1);
    P_pred[1][7] = P[1][7] + P[4][7]*dt - dt*(P[1][13] + P[4][13]*dt)*cos(X[6]) + dt*(P[1][14] + P[4][14]*dt)*sin(X[6]) + dt*(P[1][6] + P[4][6]*dt)*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6]));
    P_pred[1][8] = P[1][8] + P[4][8]*dt - dt*(P[1][13] + P[4][13]*dt)*sin(X[6])/cos(X[7]) - dt*(P[1][14] + P[4][14]*dt)*cos(X[6])/cos(X[7]) + dt*(P[1][6] + P[4][6]*dt)*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + dt*(P[1][7] + P[4][7]*dt)*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2));
    P_pred[1][9] = P[1][9] + P[4][9]*dt;
    P_pred[1][10] = P[1][10] + P[4][10]*dt;
    P_pred[1][11] = P[1][11] + P[4][11]*dt;
    P_pred[1][12] = P[1][12] + P[4][12]*dt;
    P_pred[1][13] = P[1][13] + P[4][13]*dt;
    P_pred[1][14] = P[1][14] + P[4][14]*dt;
    P_pred[2][0] = P[2][0] + P[5][0]*dt + dt*(P[2][3] + P[5][3]*dt);
    P_pred[2][1] = P[2][1] + P[5][1]*dt + dt*(P[2][4] + P[5][4]*dt);
    P_pred[2][2] = P[2][2] + P[5][2]*dt + dt*(P[2][5] + P[5][5]*dt);
    P_pred[2][3] = P[2][3] + P[5][3]*dt + dt*(P[2][10] + P[5][10]*dt)*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + dt*(P[2][11] + P[5][11]*dt)*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + dt*(P[2][6] + P[5][6]*dt)*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + dt*(P[2][7] + P[5][7]*dt)*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + dt*(P[2][8] + P[5][8]*dt)*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - dt*(P[2][9] + P[5][9]*dt)*cos(X[7])*cos(X[8]);
    P_pred[2][4] = P[2][4] + P[5][4]*dt + dt*(P[2][10] + P[5][10]*dt)*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + dt*(P[2][11] + P[5][11]*dt)*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + dt*(P[2][6] + P[5][6]*dt)*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + dt*(P[2][7] + P[5][7]*dt)*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + dt*(P[2][8] + P[5][8]*dt)*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - dt*(P[2][9] + P[5][9]*dt)*sin(X[8])*cos(X[7]);
    P_pred[2][5] = P[2][5] + P[5][5]*dt - dt*(P[2][10] + P[5][10]*dt)*sin(X[6])*cos(X[7]) - dt*(P[2][11] + P[5][11]*dt)*cos(X[6])*cos(X[7]) + dt*(P[2][6] + P[5][6]*dt)*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + dt*(P[2][7] + P[5][7]*dt)*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + dt*(P[2][9] + P[5][9]*dt)*sin(X[7]);
    P_pred[2][6] = -dt*(P[2][12] + P[5][12]*dt) - dt*(P[2][13] + P[5][13]*dt)*sin(X[6])*tan(X[7]) - dt*(P[2][14] + P[5][14]*dt)*cos(X[6])*tan(X[7]) + dt*(P[2][7] + P[5][7]*dt)*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])) + (P[2][6] + P[5][6]*dt)*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1);
    P_pred[2][7] = P[2][7] + P[5][7]*dt - dt*(P[2][13] + P[5][13]*dt)*cos(X[6]) + dt*(P[2][14] + P[5][14]*dt)*sin(X[6]) + dt*(P[2][6] + P[5][6]*dt)*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6]));
    P_pred[2][8] = P[2][8] + P[5][8]*dt - dt*(P[2][13] + P[5][13]*dt)*sin(X[6])/cos(X[7]) - dt*(P[2][14] + P[5][14]*dt)*cos(X[6])/cos(X[7]) + dt*(P[2][6] + P[5][6]*dt)*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + dt*(P[2][7] + P[5][7]*dt)*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2));
    P_pred[2][9] = P[2][9] + P[5][9]*dt;
    P_pred[2][10] = P[2][10] + P[5][10]*dt;
    P_pred[2][11] = P[2][11] + P[5][11]*dt;
    P_pred[2][12] = P[2][12] + P[5][12]*dt;
    P_pred[2][13] = P[2][13] + P[5][13]*dt;
    P_pred[2][14] = P[2][14] + P[5][14]*dt;
    P_pred[3][0] = P[10][0]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][0]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][0] + P[6][0]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][0]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][0]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][0]*dt*cos(X[7])*cos(X[8]) + dt*(P[10][3]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][3]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][3] + P[6][3]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][3]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][3]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][3]*dt*cos(X[7])*cos(X[8]));
    P_pred[3][1] = P[10][1]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][1]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][1] + P[6][1]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][1]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][1]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][1]*dt*cos(X[7])*cos(X[8]) + dt*(P[10][4]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][4]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][4] + P[6][4]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][4]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][4]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][4]*dt*cos(X[7])*cos(X[8]));
    P_pred[3][2] = P[10][2]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][2]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][2] + P[6][2]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][2]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][2]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][2]*dt*cos(X[7])*cos(X[8]) + dt*(P[10][5]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][5]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][5] + P[6][5]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][5]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][5]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][5]*dt*cos(X[7])*cos(X[8]));
    P_pred[3][3] = P[10][3]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][3]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][3] + P[6][3]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][3]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][3]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][3]*dt*cos(X[7])*cos(X[8]) + Q_diag[0]*pow(dt, 2)*pow(cos(X[7]), 2)*pow(cos(X[8]), 2) + Q_diag[1]*pow(dt, 2)*pow(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]), 2) + Q_diag[2]*pow(dt, 2)*pow(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8]), 2) + dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])))*(P[10][6]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][6]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][6] + P[6][6]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][6]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][6]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][6]*dt*cos(X[7])*cos(X[8])) + dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8]))*(P[10][11]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][11]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][11] + P[6][11]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][11]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][11]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][11]*dt*cos(X[7])*cos(X[8])) + dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))*(P[10][10]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][10]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][10] + P[6][10]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][10]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][10]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][10]*dt*cos(X[7])*cos(X[8])) + dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8]))*(P[10][7]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][7]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][7] + P[6][7]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][7]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][7]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][7]*dt*cos(X[7])*cos(X[8])) + dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])))*(P[10][8]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][8]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][8] + P[6][8]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][8]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][8]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][8]*dt*cos(X[7])*cos(X[8])) - dt*(P[10][9]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][9]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][9] + P[6][9]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][9]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][9]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][9]*dt*cos(X[7])*cos(X[8]))*cos(X[7])*cos(X[8]);
    P_pred[3][4] = P[10][4]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][4]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][4] + P[6][4]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][4]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][4]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][4]*dt*cos(X[7])*cos(X[8]) + Q_diag[0]*pow(dt, 2)*sin(X[8])*pow(cos(X[7]), 2)*cos(X[8]) + Q_diag[1]*pow(dt, 2)*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + Q_diag[2]*pow(dt, 2)*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8]))*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])))*(P[10][6]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][6]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][6] + P[6][6]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][6]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][6]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][6]*dt*cos(X[7])*cos(X[8])) + dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))*(P[10][11]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][11]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][11] + P[6][11]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][11]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][11]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][11]*dt*cos(X[7])*cos(X[8])) + dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))*(P[10][10]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][10]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][10] + P[6][10]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][10]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][10]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][10]*dt*cos(X[7])*cos(X[8])) + dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7]))*(P[10][7]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][7]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][7] + P[6][7]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][7]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][7]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][7]*dt*cos(X[7])*cos(X[8])) + dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])))*(P[10][8]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][8]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][8] + P[6][8]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][8]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][8]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][8]*dt*cos(X[7])*cos(X[8])) - dt*(P[10][9]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][9]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][9] + P[6][9]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][9]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][9]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][9]*dt*cos(X[7])*cos(X[8]))*sin(X[8])*cos(X[7]);
    P_pred[3][5] = P[10][5]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][5]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][5] + P[6][5]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][5]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][5]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][5]*dt*cos(X[7])*cos(X[8]) - Q_diag[0]*pow(dt, 2)*sin(X[7])*cos(X[7])*cos(X[8]) - Q_diag[1]*pow(dt, 2)*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))*sin(X[6])*cos(X[7]) - Q_diag[2]*pow(dt, 2)*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8]))*cos(X[6])*cos(X[7]) + dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7]))*(P[10][6]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][6]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][6] + P[6][6]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][6]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][6]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][6]*dt*cos(X[7])*cos(X[8])) + dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6]))*(P[10][7]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][7]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][7] + P[6][7]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][7]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][7]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][7]*dt*cos(X[7])*cos(X[8])) - dt*(P[10][10]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][10]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][10] + P[6][10]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][10]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][10]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][10]*dt*cos(X[7])*cos(X[8]))*sin(X[6])*cos(X[7]) - dt*(P[10][11]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][11]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][11] + P[6][11]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][11]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][11]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][11]*dt*cos(X[7])*cos(X[8]))*cos(X[6])*cos(X[7]) + dt*(P[10][9]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][9]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][9] + P[6][9]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][9]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][9]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][9]*dt*cos(X[7])*cos(X[8]))*sin(X[7]);
    P_pred[3][6] = dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))*(P[10][7]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][7]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][7] + P[6][7]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][7]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][7]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][7]*dt*cos(X[7])*cos(X[8])) - dt*(P[10][12]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][12]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][12] + P[6][12]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][12]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][12]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][12]*dt*cos(X[7])*cos(X[8])) - dt*(P[10][13]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][13]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][13] + P[6][13]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][13]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][13]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][13]*dt*cos(X[7])*cos(X[8]))*sin(X[6])*tan(X[7]) - dt*(P[10][14]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][14]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][14] + P[6][14]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][14]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][14]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][14]*dt*cos(X[7])*cos(X[8]))*cos(X[6])*tan(X[7]) + (dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1)*(P[10][6]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][6]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][6] + P[6][6]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][6]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][6]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][6]*dt*cos(X[7])*cos(X[8]));
    P_pred[3][7] = P[10][7]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][7]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][7] + P[6][7]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][7]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][7]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][7]*dt*cos(X[7])*cos(X[8]) + dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6]))*(P[10][6]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][6]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][6] + P[6][6]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][6]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][6]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][6]*dt*cos(X[7])*cos(X[8])) - dt*(P[10][13]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][13]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][13] + P[6][13]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][13]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][13]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][13]*dt*cos(X[7])*cos(X[8]))*cos(X[6]) + dt*(P[10][14]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][14]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][14] + P[6][14]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][14]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][14]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][14]*dt*cos(X[7])*cos(X[8]))*sin(X[6]);
    P_pred[3][8] = P[10][8]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][8]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][8] + P[6][8]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][8]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][8]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][8]*dt*cos(X[7])*cos(X[8]) + dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7]))*(P[10][6]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][6]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][6] + P[6][6]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][6]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][6]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][6]*dt*cos(X[7])*cos(X[8])) + dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2))*(P[10][7]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][7]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][7] + P[6][7]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][7]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][7]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][7]*dt*cos(X[7])*cos(X[8])) - dt*(P[10][13]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][13]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][13] + P[6][13]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][13]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][13]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][13]*dt*cos(X[7])*cos(X[8]))*sin(X[6])/cos(X[7]) - dt*(P[10][14]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][14]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][14] + P[6][14]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][14]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][14]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][14]*dt*cos(X[7])*cos(X[8]))*cos(X[6])/cos(X[7]);
    P_pred[3][9] = P[10][9]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][9]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][9] + P[6][9]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][9]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][9]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][9]*dt*cos(X[7])*cos(X[8]);
    P_pred[3][10] = P[10][10]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][10]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][10] + P[6][10]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][10]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][10]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][10]*dt*cos(X[7])*cos(X[8]);
    P_pred[3][11] = P[10][11]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][11]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][11] + P[6][11]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][11]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][11]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][11]*dt*cos(X[7])*cos(X[8]);
    P_pred[3][12] = P[10][12]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][12]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][12] + P[6][12]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][12]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][12]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][12]*dt*cos(X[7])*cos(X[8]);
    P_pred[3][13] = P[10][13]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][13]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][13] + P[6][13]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][13]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][13]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][13]*dt*cos(X[7])*cos(X[8]);
    P_pred[3][14] = P[10][14]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][14]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[3][14] + P[6][14]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[7][14]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[8][14]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][14]*dt*cos(X[7])*cos(X[8]);
    P_pred[4][0] = P[10][0]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][0]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][0] + P[6][0]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][0]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][0]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][0]*dt*sin(X[8])*cos(X[7]) + dt*(P[10][3]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][3]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][3] + P[6][3]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][3]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][3]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][3]*dt*sin(X[8])*cos(X[7]));
    P_pred[4][1] = P[10][1]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][1]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][1] + P[6][1]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][1]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][1]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][1]*dt*sin(X[8])*cos(X[7]) + dt*(P[10][4]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][4]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][4] + P[6][4]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][4]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][4]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][4]*dt*sin(X[8])*cos(X[7]));
    P_pred[4][2] = P[10][2]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][2]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][2] + P[6][2]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][2]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][2]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][2]*dt*sin(X[8])*cos(X[7]) + dt*(P[10][5]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][5]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][5] + P[6][5]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][5]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][5]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][5]*dt*sin(X[8])*cos(X[7]));
    P_pred[4][3] = P[10][3]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][3]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][3] + P[6][3]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][3]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][3]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][3]*dt*sin(X[8])*cos(X[7]) + Q_diag[0]*pow(dt, 2)*sin(X[8])*pow(cos(X[7]), 2)*cos(X[8]) + Q_diag[1]*pow(dt, 2)*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + Q_diag[2]*pow(dt, 2)*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8]))*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])))*(P[10][6]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][6]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][6] + P[6][6]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][6]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][6]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][6]*dt*sin(X[8])*cos(X[7])) + dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8]))*(P[10][11]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][11]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][11] + P[6][11]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][11]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][11]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][11]*dt*sin(X[8])*cos(X[7])) + dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))*(P[10][10]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][10]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][10] + P[6][10]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][10]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][10]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][10]*dt*sin(X[8])*cos(X[7])) + dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8]))*(P[10][7]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][7]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][7] + P[6][7]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][7]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][7]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][7]*dt*sin(X[8])*cos(X[7])) + dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])))*(P[10][8]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][8]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][8] + P[6][8]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][8]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][8]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][8]*dt*sin(X[8])*cos(X[7])) - dt*(P[10][9]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][9]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][9] + P[6][9]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][9]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][9]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][9]*dt*sin(X[8])*cos(X[7]))*cos(X[7])*cos(X[8]);
    P_pred[4][4] = P[10][4]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][4]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][4] + P[6][4]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][4]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][4]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][4]*dt*sin(X[8])*cos(X[7]) + Q_diag[0]*pow(dt, 2)*pow(sin(X[8]), 2)*pow(cos(X[7]), 2) + Q_diag[1]*pow(dt, 2)*pow(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]), 2) + Q_diag[2]*pow(dt, 2)*pow(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]), 2) + dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])))*(P[10][6]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][6]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][6] + P[6][6]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][6]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][6]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][6]*dt*sin(X[8])*cos(X[7])) + dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))*(P[10][11]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][11]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][11] + P[6][11]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][11]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][11]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][11]*dt*sin(X[8])*cos(X[7])) + dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))*(P[10][10]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][10]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][10] + P[6][10]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][10]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][10]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][10]*dt*sin(X[8])*cos(X[7])) + dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7]))*(P[10][7]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][7]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][7] + P[6][7]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][7]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][7]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][7]*dt*sin(X[8])*cos(X[7])) + dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])))*(P[10][8]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][8]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][8] + P[6][8]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][8]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][8]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][8]*dt*sin(X[8])*cos(X[7])) - dt*(P[10][9]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][9]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][9] + P[6][9]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][9]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][9]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][9]*dt*sin(X[8])*cos(X[7]))*sin(X[8])*cos(X[7]);
    P_pred[4][5] = P[10][5]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][5]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][5] + P[6][5]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][5]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][5]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][5]*dt*sin(X[8])*cos(X[7]) - Q_diag[0]*pow(dt, 2)*sin(X[7])*sin(X[8])*cos(X[7]) - Q_diag[1]*pow(dt, 2)*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))*sin(X[6])*cos(X[7]) - Q_diag[2]*pow(dt, 2)*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))*cos(X[6])*cos(X[7]) + dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7]))*(P[10][6]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][6]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][6] + P[6][6]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][6]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][6]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][6]*dt*sin(X[8])*cos(X[7])) + dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6]))*(P[10][7]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][7]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][7] + P[6][7]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][7]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][7]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][7]*dt*sin(X[8])*cos(X[7])) - dt*(P[10][10]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][10]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][10] + P[6][10]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][10]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][10]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][10]*dt*sin(X[8])*cos(X[7]))*sin(X[6])*cos(X[7]) - dt*(P[10][11]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][11]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][11] + P[6][11]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][11]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][11]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][11]*dt*sin(X[8])*cos(X[7]))*cos(X[6])*cos(X[7]) + dt*(P[10][9]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][9]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][9] + P[6][9]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][9]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][9]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][9]*dt*sin(X[8])*cos(X[7]))*sin(X[7]);
    P_pred[4][6] = dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))*(P[10][7]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][7]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][7] + P[6][7]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][7]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][7]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][7]*dt*sin(X[8])*cos(X[7])) - dt*(P[10][12]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][12]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][12] + P[6][12]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][12]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][12]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][12]*dt*sin(X[8])*cos(X[7])) - dt*(P[10][13]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][13]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][13] + P[6][13]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][13]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][13]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][13]*dt*sin(X[8])*cos(X[7]))*sin(X[6])*tan(X[7]) - dt*(P[10][14]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][14]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][14] + P[6][14]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][14]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][14]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][14]*dt*sin(X[8])*cos(X[7]))*cos(X[6])*tan(X[7]) + (dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1)*(P[10][6]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][6]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][6] + P[6][6]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][6]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][6]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][6]*dt*sin(X[8])*cos(X[7]));
    P_pred[4][7] = P[10][7]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][7]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][7] + P[6][7]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][7]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][7]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][7]*dt*sin(X[8])*cos(X[7]) + dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6]))*(P[10][6]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][6]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][6] + P[6][6]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][6]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][6]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][6]*dt*sin(X[8])*cos(X[7])) - dt*(P[10][13]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][13]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][13] + P[6][13]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][13]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][13]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][13]*dt*sin(X[8])*cos(X[7]))*cos(X[6]) + dt*(P[10][14]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][14]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][14] + P[6][14]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][14]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][14]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][14]*dt*sin(X[8])*cos(X[7]))*sin(X[6]);
    P_pred[4][8] = P[10][8]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][8]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][8] + P[6][8]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][8]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][8]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][8]*dt*sin(X[8])*cos(X[7]) + dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7]))*(P[10][6]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][6]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][6] + P[6][6]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][6]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][6]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][6]*dt*sin(X[8])*cos(X[7])) + dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2))*(P[10][7]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][7]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][7] + P[6][7]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][7]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][7]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][7]*dt*sin(X[8])*cos(X[7])) - dt*(P[10][13]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][13]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][13] + P[6][13]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][13]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][13]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][13]*dt*sin(X[8])*cos(X[7]))*sin(X[6])/cos(X[7]) - dt*(P[10][14]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][14]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][14] + P[6][14]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][14]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][14]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][14]*dt*sin(X[8])*cos(X[7]))*cos(X[6])/cos(X[7]);
    P_pred[4][9] = P[10][9]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][9]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][9] + P[6][9]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][9]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][9]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][9]*dt*sin(X[8])*cos(X[7]);
    P_pred[4][10] = P[10][10]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][10]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][10] + P[6][10]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][10]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][10]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][10]*dt*sin(X[8])*cos(X[7]);
    P_pred[4][11] = P[10][11]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][11]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][11] + P[6][11]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][11]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][11]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][11]*dt*sin(X[8])*cos(X[7]);
    P_pred[4][12] = P[10][12]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][12]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][12] + P[6][12]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][12]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][12]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][12]*dt*sin(X[8])*cos(X[7]);
    P_pred[4][13] = P[10][13]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][13]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][13] + P[6][13]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][13]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][13]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][13]*dt*sin(X[8])*cos(X[7]);
    P_pred[4][14] = P[10][14]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][14]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[4][14] + P[6][14]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[7][14]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[8][14]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][14]*dt*sin(X[8])*cos(X[7]);
    P_pred[5][0] = -P[10][0]*dt*sin(X[6])*cos(X[7]) - P[11][0]*dt*cos(X[6])*cos(X[7]) + P[5][0] + P[6][0]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][0]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][0]*dt*sin(X[7]) + dt*(-P[10][3]*dt*sin(X[6])*cos(X[7]) - P[11][3]*dt*cos(X[6])*cos(X[7]) + P[5][3] + P[6][3]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][3]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][3]*dt*sin(X[7]));
    P_pred[5][1] = -P[10][1]*dt*sin(X[6])*cos(X[7]) - P[11][1]*dt*cos(X[6])*cos(X[7]) + P[5][1] + P[6][1]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][1]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][1]*dt*sin(X[7]) + dt*(-P[10][4]*dt*sin(X[6])*cos(X[7]) - P[11][4]*dt*cos(X[6])*cos(X[7]) + P[5][4] + P[6][4]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][4]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][4]*dt*sin(X[7]));
    P_pred[5][2] = -P[10][2]*dt*sin(X[6])*cos(X[7]) - P[11][2]*dt*cos(X[6])*cos(X[7]) + P[5][2] + P[6][2]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][2]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][2]*dt*sin(X[7]) + dt*(-P[10][5]*dt*sin(X[6])*cos(X[7]) - P[11][5]*dt*cos(X[6])*cos(X[7]) + P[5][5] + P[6][5]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][5]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][5]*dt*sin(X[7]));
    P_pred[5][3] = -P[10][3]*dt*sin(X[6])*cos(X[7]) - P[11][3]*dt*cos(X[6])*cos(X[7]) + P[5][3] + P[6][3]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][3]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][3]*dt*sin(X[7]) - Q_diag[0]*pow(dt, 2)*sin(X[7])*cos(X[7])*cos(X[8]) - Q_diag[1]*pow(dt, 2)*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))*sin(X[6])*cos(X[7]) - Q_diag[2]*pow(dt, 2)*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8]))*cos(X[6])*cos(X[7]) + dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])))*(-P[10][6]*dt*sin(X[6])*cos(X[7]) - P[11][6]*dt*cos(X[6])*cos(X[7]) + P[5][6] + P[6][6]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][6]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][6]*dt*sin(X[7])) + dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8]))*(-P[10][11]*dt*sin(X[6])*cos(X[7]) - P[11][11]*dt*cos(X[6])*cos(X[7]) + P[5][11] + P[6][11]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][11]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][11]*dt*sin(X[7])) + dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))*(-P[10][10]*dt*sin(X[6])*cos(X[7]) - P[11][10]*dt*cos(X[6])*cos(X[7]) + P[5][10] + P[6][10]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][10]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][10]*dt*sin(X[7])) + dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8]))*(-P[10][7]*dt*sin(X[6])*cos(X[7]) - P[11][7]*dt*cos(X[6])*cos(X[7]) + P[5][7] + P[6][7]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][7]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][7]*dt*sin(X[7])) + dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])))*(-P[10][8]*dt*sin(X[6])*cos(X[7]) - P[11][8]*dt*cos(X[6])*cos(X[7]) + P[5][8] + P[6][8]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][8]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][8]*dt*sin(X[7])) - dt*(-P[10][9]*dt*sin(X[6])*cos(X[7]) - P[11][9]*dt*cos(X[6])*cos(X[7]) + P[5][9] + P[6][9]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][9]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][9]*dt*sin(X[7]))*cos(X[7])*cos(X[8]);
    P_pred[5][4] = -P[10][4]*dt*sin(X[6])*cos(X[7]) - P[11][4]*dt*cos(X[6])*cos(X[7]) + P[5][4] + P[6][4]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][4]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][4]*dt*sin(X[7]) - Q_diag[0]*pow(dt, 2)*sin(X[7])*sin(X[8])*cos(X[7]) - Q_diag[1]*pow(dt, 2)*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))*sin(X[6])*cos(X[7]) - Q_diag[2]*pow(dt, 2)*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))*cos(X[6])*cos(X[7]) + dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])))*(-P[10][6]*dt*sin(X[6])*cos(X[7]) - P[11][6]*dt*cos(X[6])*cos(X[7]) + P[5][6] + P[6][6]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][6]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][6]*dt*sin(X[7])) + dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))*(-P[10][11]*dt*sin(X[6])*cos(X[7]) - P[11][11]*dt*cos(X[6])*cos(X[7]) + P[5][11] + P[6][11]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][11]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][11]*dt*sin(X[7])) + dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))*(-P[10][10]*dt*sin(X[6])*cos(X[7]) - P[11][10]*dt*cos(X[6])*cos(X[7]) + P[5][10] + P[6][10]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][10]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][10]*dt*sin(X[7])) + dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7]))*(-P[10][7]*dt*sin(X[6])*cos(X[7]) - P[11][7]*dt*cos(X[6])*cos(X[7]) + P[5][7] + P[6][7]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][7]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][7]*dt*sin(X[7])) + dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])))*(-P[10][8]*dt*sin(X[6])*cos(X[7]) - P[11][8]*dt*cos(X[6])*cos(X[7]) + P[5][8] + P[6][8]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][8]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][8]*dt*sin(X[7])) - dt*(-P[10][9]*dt*sin(X[6])*cos(X[7]) - P[11][9]*dt*cos(X[6])*cos(X[7]) + P[5][9] + P[6][9]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][9]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][9]*dt*sin(X[7]))*sin(X[8])*cos(X[7]);
    P_pred[5][5] = -P[10][5]*dt*sin(X[6])*cos(X[7]) - P[11][5]*dt*cos(X[6])*cos(X[7]) + P[5][5] + P[6][5]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][5]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][5]*dt*sin(X[7]) + Q_diag[0]*pow(dt, 2)*pow(sin(X[7]), 2) + Q_diag[1]*pow(dt, 2)*pow(sin(X[6]), 2)*pow(cos(X[7]), 2) + Q_diag[2]*pow(dt, 2)*pow(cos(X[6]), 2)*pow(cos(X[7]), 2) + dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7]))*(-P[10][6]*dt*sin(X[6])*cos(X[7]) - P[11][6]*dt*cos(X[6])*cos(X[7]) + P[5][6] + P[6][6]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][6]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][6]*dt*sin(X[7])) + dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6]))*(-P[10][7]*dt*sin(X[6])*cos(X[7]) - P[11][7]*dt*cos(X[6])*cos(X[7]) + P[5][7] + P[6][7]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][7]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][7]*dt*sin(X[7])) - dt*(-P[10][10]*dt*sin(X[6])*cos(X[7]) - P[11][10]*dt*cos(X[6])*cos(X[7]) + P[5][10] + P[6][10]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][10]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][10]*dt*sin(X[7]))*sin(X[6])*cos(X[7]) - dt*(-P[10][11]*dt*sin(X[6])*cos(X[7]) - P[11][11]*dt*cos(X[6])*cos(X[7]) + P[5][11] + P[6][11]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][11]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][11]*dt*sin(X[7]))*cos(X[6])*cos(X[7]) + dt*(-P[10][9]*dt*sin(X[6])*cos(X[7]) - P[11][9]*dt*cos(X[6])*cos(X[7]) + P[5][9] + P[6][9]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][9]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][9]*dt*sin(X[7]))*sin(X[7]);
    P_pred[5][6] = dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))*(-P[10][7]*dt*sin(X[6])*cos(X[7]) - P[11][7]*dt*cos(X[6])*cos(X[7]) + P[5][7] + P[6][7]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][7]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][7]*dt*sin(X[7])) - dt*(-P[10][12]*dt*sin(X[6])*cos(X[7]) - P[11][12]*dt*cos(X[6])*cos(X[7]) + P[5][12] + P[6][12]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][12]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][12]*dt*sin(X[7])) - dt*(-P[10][13]*dt*sin(X[6])*cos(X[7]) - P[11][13]*dt*cos(X[6])*cos(X[7]) + P[5][13] + P[6][13]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][13]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][13]*dt*sin(X[7]))*sin(X[6])*tan(X[7]) - dt*(-P[10][14]*dt*sin(X[6])*cos(X[7]) - P[11][14]*dt*cos(X[6])*cos(X[7]) + P[5][14] + P[6][14]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][14]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][14]*dt*sin(X[7]))*cos(X[6])*tan(X[7]) + (dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1)*(-P[10][6]*dt*sin(X[6])*cos(X[7]) - P[11][6]*dt*cos(X[6])*cos(X[7]) + P[5][6] + P[6][6]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][6]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][6]*dt*sin(X[7]));
    P_pred[5][7] = -P[10][7]*dt*sin(X[6])*cos(X[7]) - P[11][7]*dt*cos(X[6])*cos(X[7]) + P[5][7] + P[6][7]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][7]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][7]*dt*sin(X[7]) + dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6]))*(-P[10][6]*dt*sin(X[6])*cos(X[7]) - P[11][6]*dt*cos(X[6])*cos(X[7]) + P[5][6] + P[6][6]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][6]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][6]*dt*sin(X[7])) - dt*(-P[10][13]*dt*sin(X[6])*cos(X[7]) - P[11][13]*dt*cos(X[6])*cos(X[7]) + P[5][13] + P[6][13]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][13]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][13]*dt*sin(X[7]))*cos(X[6]) + dt*(-P[10][14]*dt*sin(X[6])*cos(X[7]) - P[11][14]*dt*cos(X[6])*cos(X[7]) + P[5][14] + P[6][14]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][14]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][14]*dt*sin(X[7]))*sin(X[6]);
    P_pred[5][8] = -P[10][8]*dt*sin(X[6])*cos(X[7]) - P[11][8]*dt*cos(X[6])*cos(X[7]) + P[5][8] + P[6][8]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][8]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][8]*dt*sin(X[7]) + dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7]))*(-P[10][6]*dt*sin(X[6])*cos(X[7]) - P[11][6]*dt*cos(X[6])*cos(X[7]) + P[5][6] + P[6][6]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][6]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][6]*dt*sin(X[7])) + dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2))*(-P[10][7]*dt*sin(X[6])*cos(X[7]) - P[11][7]*dt*cos(X[6])*cos(X[7]) + P[5][7] + P[6][7]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][7]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][7]*dt*sin(X[7])) - dt*(-P[10][13]*dt*sin(X[6])*cos(X[7]) - P[11][13]*dt*cos(X[6])*cos(X[7]) + P[5][13] + P[6][13]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][13]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][13]*dt*sin(X[7]))*sin(X[6])/cos(X[7]) - dt*(-P[10][14]*dt*sin(X[6])*cos(X[7]) - P[11][14]*dt*cos(X[6])*cos(X[7]) + P[5][14] + P[6][14]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][14]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][14]*dt*sin(X[7]))*cos(X[6])/cos(X[7]);
    P_pred[5][9] = -P[10][9]*dt*sin(X[6])*cos(X[7]) - P[11][9]*dt*cos(X[6])*cos(X[7]) + P[5][9] + P[6][9]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][9]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][9]*dt*sin(X[7]);
    P_pred[5][10] = -P[10][10]*dt*sin(X[6])*cos(X[7]) - P[11][10]*dt*cos(X[6])*cos(X[7]) + P[5][10] + P[6][10]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][10]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][10]*dt*sin(X[7]);
    P_pred[5][11] = -P[10][11]*dt*sin(X[6])*cos(X[7]) - P[11][11]*dt*cos(X[6])*cos(X[7]) + P[5][11] + P[6][11]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][11]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][11]*dt*sin(X[7]);
    P_pred[5][12] = -P[10][12]*dt*sin(X[6])*cos(X[7]) - P[11][12]*dt*cos(X[6])*cos(X[7]) + P[5][12] + P[6][12]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][12]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][12]*dt*sin(X[7]);
    P_pred[5][13] = -P[10][13]*dt*sin(X[6])*cos(X[7]) - P[11][13]*dt*cos(X[6])*cos(X[7]) + P[5][13] + P[6][13]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][13]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][13]*dt*sin(X[7]);
    P_pred[5][14] = -P[10][14]*dt*sin(X[6])*cos(X[7]) - P[11][14]*dt*cos(X[6])*cos(X[7]) + P[5][14] + P[6][14]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[7][14]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][14]*dt*sin(X[7]);
    P_pred[6][0] = -P[12][0]*dt - P[13][0]*dt*sin(X[6])*tan(X[7]) - P[14][0]*dt*cos(X[6])*tan(X[7]) + P[6][0]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][0]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])) + dt*(-P[12][3]*dt - P[13][3]*dt*sin(X[6])*tan(X[7]) - P[14][3]*dt*cos(X[6])*tan(X[7]) + P[6][3]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][3]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])));
    P_pred[6][1] = -P[12][1]*dt - P[13][1]*dt*sin(X[6])*tan(X[7]) - P[14][1]*dt*cos(X[6])*tan(X[7]) + P[6][1]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][1]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])) + dt*(-P[12][4]*dt - P[13][4]*dt*sin(X[6])*tan(X[7]) - P[14][4]*dt*cos(X[6])*tan(X[7]) + P[6][4]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][4]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])));
    P_pred[6][2] = -P[12][2]*dt - P[13][2]*dt*sin(X[6])*tan(X[7]) - P[14][2]*dt*cos(X[6])*tan(X[7]) + P[6][2]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][2]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])) + dt*(-P[12][5]*dt - P[13][5]*dt*sin(X[6])*tan(X[7]) - P[14][5]*dt*cos(X[6])*tan(X[7]) + P[6][5]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][5]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])));
    P_pred[6][3] = -P[12][3]*dt - P[13][3]*dt*sin(X[6])*tan(X[7]) - P[14][3]*dt*cos(X[6])*tan(X[7]) + P[6][3]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][3]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])) + dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])))*(-P[12][6]*dt - P[13][6]*dt*sin(X[6])*tan(X[7]) - P[14][6]*dt*cos(X[6])*tan(X[7]) + P[6][6]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][6]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) + dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8]))*(-P[12][11]*dt - P[13][11]*dt*sin(X[6])*tan(X[7]) - P[14][11]*dt*cos(X[6])*tan(X[7]) + P[6][11]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][11]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) + dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))*(-P[12][10]*dt - P[13][10]*dt*sin(X[6])*tan(X[7]) - P[14][10]*dt*cos(X[6])*tan(X[7]) + P[6][10]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][10]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) + dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8]))*(-P[12][7]*dt - P[13][7]*dt*sin(X[6])*tan(X[7]) - P[14][7]*dt*cos(X[6])*tan(X[7]) + P[6][7]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][7]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) + dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])))*(-P[12][8]*dt - P[13][8]*dt*sin(X[6])*tan(X[7]) - P[14][8]*dt*cos(X[6])*tan(X[7]) + P[6][8]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][8]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) - dt*(-P[12][9]*dt - P[13][9]*dt*sin(X[6])*tan(X[7]) - P[14][9]*dt*cos(X[6])*tan(X[7]) + P[6][9]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][9]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])))*cos(X[7])*cos(X[8]);
    P_pred[6][4] = -P[12][4]*dt - P[13][4]*dt*sin(X[6])*tan(X[7]) - P[14][4]*dt*cos(X[6])*tan(X[7]) + P[6][4]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][4]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])) + dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])))*(-P[12][6]*dt - P[13][6]*dt*sin(X[6])*tan(X[7]) - P[14][6]*dt*cos(X[6])*tan(X[7]) + P[6][6]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][6]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) + dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))*(-P[12][11]*dt - P[13][11]*dt*sin(X[6])*tan(X[7]) - P[14][11]*dt*cos(X[6])*tan(X[7]) + P[6][11]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][11]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) + dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))*(-P[12][10]*dt - P[13][10]*dt*sin(X[6])*tan(X[7]) - P[14][10]*dt*cos(X[6])*tan(X[7]) + P[6][10]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][10]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) + dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7]))*(-P[12][7]*dt - P[13][7]*dt*sin(X[6])*tan(X[7]) - P[14][7]*dt*cos(X[6])*tan(X[7]) + P[6][7]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][7]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) + dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])))*(-P[12][8]*dt - P[13][8]*dt*sin(X[6])*tan(X[7]) - P[14][8]*dt*cos(X[6])*tan(X[7]) + P[6][8]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][8]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) - dt*(-P[12][9]*dt - P[13][9]*dt*sin(X[6])*tan(X[7]) - P[14][9]*dt*cos(X[6])*tan(X[7]) + P[6][9]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][9]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])))*sin(X[8])*cos(X[7]);
    P_pred[6][5] = -P[12][5]*dt - P[13][5]*dt*sin(X[6])*tan(X[7]) - P[14][5]*dt*cos(X[6])*tan(X[7]) + P[6][5]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][5]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])) + dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7]))*(-P[12][6]*dt - P[13][6]*dt*sin(X[6])*tan(X[7]) - P[14][6]*dt*cos(X[6])*tan(X[7]) + P[6][6]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][6]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) + dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6]))*(-P[12][7]*dt - P[13][7]*dt*sin(X[6])*tan(X[7]) - P[14][7]*dt*cos(X[6])*tan(X[7]) + P[6][7]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][7]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) - dt*(-P[12][10]*dt - P[13][10]*dt*sin(X[6])*tan(X[7]) - P[14][10]*dt*cos(X[6])*tan(X[7]) + P[6][10]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][10]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])))*sin(X[6])*cos(X[7]) - dt*(-P[12][11]*dt - P[13][11]*dt*sin(X[6])*tan(X[7]) - P[14][11]*dt*cos(X[6])*tan(X[7]) + P[6][11]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][11]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])))*cos(X[6])*cos(X[7]) + dt*(-P[12][9]*dt - P[13][9]*dt*sin(X[6])*tan(X[7]) - P[14][9]*dt*cos(X[6])*tan(X[7]) + P[6][9]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][9]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])))*sin(X[7]);
    P_pred[6][6] = Q_diag[3]*pow(dt, 2) + Q_diag[4]*pow(dt, 2)*pow(sin(X[6]), 2)*pow(tan(X[7]), 2) + Q_diag[5]*pow(dt, 2)*pow(cos(X[6]), 2)*pow(tan(X[7]), 2) + dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))*(-P[12][7]*dt - P[13][7]*dt*sin(X[6])*tan(X[7]) - P[14][7]*dt*cos(X[6])*tan(X[7]) + P[6][7]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][7]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) - dt*(-P[12][12]*dt - P[13][12]*dt*sin(X[6])*tan(X[7]) - P[14][12]*dt*cos(X[6])*tan(X[7]) + P[6][12]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][12]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) - dt*(-P[12][13]*dt - P[13][13]*dt*sin(X[6])*tan(X[7]) - P[14][13]*dt*cos(X[6])*tan(X[7]) + P[6][13]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][13]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])))*sin(X[6])*tan(X[7]) - dt*(-P[12][14]*dt - P[13][14]*dt*sin(X[6])*tan(X[7]) - P[14][14]*dt*cos(X[6])*tan(X[7]) + P[6][14]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][14]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])))*cos(X[6])*tan(X[7]) + (dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1)*(-P[12][6]*dt - P[13][6]*dt*sin(X[6])*tan(X[7]) - P[14][6]*dt*cos(X[6])*tan(X[7]) + P[6][6]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][6]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])));
    P_pred[6][7] = -P[12][7]*dt - P[13][7]*dt*sin(X[6])*tan(X[7]) - P[14][7]*dt*cos(X[6])*tan(X[7]) + P[6][7]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][7]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])) + Q_diag[4]*pow(dt, 2)*sin(X[6])*cos(X[6])*tan(X[7]) - Q_diag[5]*pow(dt, 2)*sin(X[6])*cos(X[6])*tan(X[7]) + dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6]))*(-P[12][6]*dt - P[13][6]*dt*sin(X[6])*tan(X[7]) - P[14][6]*dt*cos(X[6])*tan(X[7]) + P[6][6]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][6]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) - dt*(-P[12][13]*dt - P[13][13]*dt*sin(X[6])*tan(X[7]) - P[14][13]*dt*cos(X[6])*tan(X[7]) + P[6][13]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][13]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])))*cos(X[6]) + dt*(-P[12][14]*dt - P[13][14]*dt*sin(X[6])*tan(X[7]) - P[14][14]*dt*cos(X[6])*tan(X[7]) + P[6][14]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][14]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])))*sin(X[6]);
    P_pred[6][8] = -P[12][8]*dt - P[13][8]*dt*sin(X[6])*tan(X[7]) - P[14][8]*dt*cos(X[6])*tan(X[7]) + P[6][8]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][8]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])) + Q_diag[4]*pow(dt, 2)*pow(sin(X[6]), 2)*tan(X[7])/cos(X[7]) + Q_diag[5]*pow(dt, 2)*pow(cos(X[6]), 2)*tan(X[7])/cos(X[7]) + dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7]))*(-P[12][6]*dt - P[13][6]*dt*sin(X[6])*tan(X[7]) - P[14][6]*dt*cos(X[6])*tan(X[7]) + P[6][6]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][6]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) + dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2))*(-P[12][7]*dt - P[13][7]*dt*sin(X[6])*tan(X[7]) - P[14][7]*dt*cos(X[6])*tan(X[7]) + P[6][7]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][7]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))) - dt*(-P[12][13]*dt - P[13][13]*dt*sin(X[6])*tan(X[7]) - P[14][13]*dt*cos(X[6])*tan(X[7]) + P[6][13]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][13]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])))*sin(X[6])/cos(X[7]) - dt*(-P[12][14]*dt - P[13][14]*dt*sin(X[6])*tan(X[7]) - P[14][14]*dt*cos(X[6])*tan(X[7]) + P[6][14]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][14]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6])))*cos(X[6])/cos(X[7]);
    P_pred[6][9] = -P[12][9]*dt - P[13][9]*dt*sin(X[6])*tan(X[7]) - P[14][9]*dt*cos(X[6])*tan(X[7]) + P[6][9]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][9]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]));
    P_pred[6][10] = -P[12][10]*dt - P[13][10]*dt*sin(X[6])*tan(X[7]) - P[14][10]*dt*cos(X[6])*tan(X[7]) + P[6][10]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][10]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]));
    P_pred[6][11] = -P[12][11]*dt - P[13][11]*dt*sin(X[6])*tan(X[7]) - P[14][11]*dt*cos(X[6])*tan(X[7]) + P[6][11]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][11]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]));
    P_pred[6][12] = -P[12][12]*dt - P[13][12]*dt*sin(X[6])*tan(X[7]) - P[14][12]*dt*cos(X[6])*tan(X[7]) + P[6][12]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][12]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]));
    P_pred[6][13] = -P[12][13]*dt - P[13][13]*dt*sin(X[6])*tan(X[7]) - P[14][13]*dt*cos(X[6])*tan(X[7]) + P[6][13]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][13]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]));
    P_pred[6][14] = -P[12][14]*dt - P[13][14]*dt*sin(X[6])*tan(X[7]) - P[14][14]*dt*cos(X[6])*tan(X[7]) + P[6][14]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[7][14]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]));
    P_pred[7][0] = -P[13][0]*dt*cos(X[6]) + P[14][0]*dt*sin(X[6]) + P[6][0]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][0] + dt*(-P[13][3]*dt*cos(X[6]) + P[14][3]*dt*sin(X[6]) + P[6][3]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][3]);
    P_pred[7][1] = -P[13][1]*dt*cos(X[6]) + P[14][1]*dt*sin(X[6]) + P[6][1]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][1] + dt*(-P[13][4]*dt*cos(X[6]) + P[14][4]*dt*sin(X[6]) + P[6][4]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][4]);
    P_pred[7][2] = -P[13][2]*dt*cos(X[6]) + P[14][2]*dt*sin(X[6]) + P[6][2]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][2] + dt*(-P[13][5]*dt*cos(X[6]) + P[14][5]*dt*sin(X[6]) + P[6][5]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][5]);
    P_pred[7][3] = -P[13][3]*dt*cos(X[6]) + P[14][3]*dt*sin(X[6]) + P[6][3]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][3] + dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])))*(-P[13][6]*dt*cos(X[6]) + P[14][6]*dt*sin(X[6]) + P[6][6]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][6]) + dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8]))*(-P[13][11]*dt*cos(X[6]) + P[14][11]*dt*sin(X[6]) + P[6][11]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][11]) + dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))*(-P[13][10]*dt*cos(X[6]) + P[14][10]*dt*sin(X[6]) + P[6][10]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][10]) + dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8]))*(-P[13][7]*dt*cos(X[6]) + P[14][7]*dt*sin(X[6]) + P[6][7]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][7]) + dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])))*(-P[13][8]*dt*cos(X[6]) + P[14][8]*dt*sin(X[6]) + P[6][8]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][8]) - dt*(-P[13][9]*dt*cos(X[6]) + P[14][9]*dt*sin(X[6]) + P[6][9]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][9])*cos(X[7])*cos(X[8]);
    P_pred[7][4] = -P[13][4]*dt*cos(X[6]) + P[14][4]*dt*sin(X[6]) + P[6][4]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][4] + dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])))*(-P[13][6]*dt*cos(X[6]) + P[14][6]*dt*sin(X[6]) + P[6][6]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][6]) + dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))*(-P[13][11]*dt*cos(X[6]) + P[14][11]*dt*sin(X[6]) + P[6][11]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][11]) + dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))*(-P[13][10]*dt*cos(X[6]) + P[14][10]*dt*sin(X[6]) + P[6][10]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][10]) + dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7]))*(-P[13][7]*dt*cos(X[6]) + P[14][7]*dt*sin(X[6]) + P[6][7]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][7]) + dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])))*(-P[13][8]*dt*cos(X[6]) + P[14][8]*dt*sin(X[6]) + P[6][8]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][8]) - dt*(-P[13][9]*dt*cos(X[6]) + P[14][9]*dt*sin(X[6]) + P[6][9]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][9])*sin(X[8])*cos(X[7]);
    P_pred[7][5] = -P[13][5]*dt*cos(X[6]) + P[14][5]*dt*sin(X[6]) + P[6][5]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][5] + dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7]))*(-P[13][6]*dt*cos(X[6]) + P[14][6]*dt*sin(X[6]) + P[6][6]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][6]) + dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6]))*(-P[13][7]*dt*cos(X[6]) + P[14][7]*dt*sin(X[6]) + P[6][7]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][7]) - dt*(-P[13][10]*dt*cos(X[6]) + P[14][10]*dt*sin(X[6]) + P[6][10]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][10])*sin(X[6])*cos(X[7]) - dt*(-P[13][11]*dt*cos(X[6]) + P[14][11]*dt*sin(X[6]) + P[6][11]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][11])*cos(X[6])*cos(X[7]) + dt*(-P[13][9]*dt*cos(X[6]) + P[14][9]*dt*sin(X[6]) + P[6][9]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][9])*sin(X[7]);
    P_pred[7][6] = Q_diag[4]*pow(dt, 2)*sin(X[6])*cos(X[6])*tan(X[7]) - Q_diag[5]*pow(dt, 2)*sin(X[6])*cos(X[6])*tan(X[7]) + dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))*(-P[13][7]*dt*cos(X[6]) + P[14][7]*dt*sin(X[6]) + P[6][7]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][7]) - dt*(-P[13][12]*dt*cos(X[6]) + P[14][12]*dt*sin(X[6]) + P[6][12]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][12]) - dt*(-P[13][13]*dt*cos(X[6]) + P[14][13]*dt*sin(X[6]) + P[6][13]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][13])*sin(X[6])*tan(X[7]) - dt*(-P[13][14]*dt*cos(X[6]) + P[14][14]*dt*sin(X[6]) + P[6][14]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][14])*cos(X[6])*tan(X[7]) + (dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1)*(-P[13][6]*dt*cos(X[6]) + P[14][6]*dt*sin(X[6]) + P[6][6]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][6]);
    P_pred[7][7] = -P[13][7]*dt*cos(X[6]) + P[14][7]*dt*sin(X[6]) + P[6][7]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][7] + Q_diag[4]*pow(dt, 2)*pow(cos(X[6]), 2) + Q_diag[5]*pow(dt, 2)*pow(sin(X[6]), 2) + dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6]))*(-P[13][6]*dt*cos(X[6]) + P[14][6]*dt*sin(X[6]) + P[6][6]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][6]) - dt*(-P[13][13]*dt*cos(X[6]) + P[14][13]*dt*sin(X[6]) + P[6][13]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][13])*cos(X[6]) + dt*(-P[13][14]*dt*cos(X[6]) + P[14][14]*dt*sin(X[6]) + P[6][14]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][14])*sin(X[6]);
    P_pred[7][8] = -P[13][8]*dt*cos(X[6]) + P[14][8]*dt*sin(X[6]) + P[6][8]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][8] + Q_diag[4]*pow(dt, 2)*sin(X[6])*cos(X[6])/cos(X[7]) - Q_diag[5]*pow(dt, 2)*sin(X[6])*cos(X[6])/cos(X[7]) + dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7]))*(-P[13][6]*dt*cos(X[6]) + P[14][6]*dt*sin(X[6]) + P[6][6]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][6]) + dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2))*(-P[13][7]*dt*cos(X[6]) + P[14][7]*dt*sin(X[6]) + P[6][7]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][7]) - dt*(-P[13][13]*dt*cos(X[6]) + P[14][13]*dt*sin(X[6]) + P[6][13]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][13])*sin(X[6])/cos(X[7]) - dt*(-P[13][14]*dt*cos(X[6]) + P[14][14]*dt*sin(X[6]) + P[6][14]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][14])*cos(X[6])/cos(X[7]);
    P_pred[7][9] = -P[13][9]*dt*cos(X[6]) + P[14][9]*dt*sin(X[6]) + P[6][9]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][9];
    P_pred[7][10] = -P[13][10]*dt*cos(X[6]) + P[14][10]*dt*sin(X[6]) + P[6][10]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][10];
    P_pred[7][11] = -P[13][11]*dt*cos(X[6]) + P[14][11]*dt*sin(X[6]) + P[6][11]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][11];
    P_pred[7][12] = -P[13][12]*dt*cos(X[6]) + P[14][12]*dt*sin(X[6]) + P[6][12]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][12];
    P_pred[7][13] = -P[13][13]*dt*cos(X[6]) + P[14][13]*dt*sin(X[6]) + P[6][13]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][13];
    P_pred[7][14] = -P[13][14]*dt*cos(X[6]) + P[14][14]*dt*sin(X[6]) + P[6][14]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[7][14];
    P_pred[8][0] = -P[13][0]*dt*sin(X[6])/cos(X[7]) - P[14][0]*dt*cos(X[6])/cos(X[7]) + P[6][0]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][0]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][0] + dt*(-P[13][3]*dt*sin(X[6])/cos(X[7]) - P[14][3]*dt*cos(X[6])/cos(X[7]) + P[6][3]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][3]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][3]);
    P_pred[8][1] = -P[13][1]*dt*sin(X[6])/cos(X[7]) - P[14][1]*dt*cos(X[6])/cos(X[7]) + P[6][1]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][1]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][1] + dt*(-P[13][4]*dt*sin(X[6])/cos(X[7]) - P[14][4]*dt*cos(X[6])/cos(X[7]) + P[6][4]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][4]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][4]);
    P_pred[8][2] = -P[13][2]*dt*sin(X[6])/cos(X[7]) - P[14][2]*dt*cos(X[6])/cos(X[7]) + P[6][2]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][2]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][2] + dt*(-P[13][5]*dt*sin(X[6])/cos(X[7]) - P[14][5]*dt*cos(X[6])/cos(X[7]) + P[6][5]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][5]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][5]);
    P_pred[8][3] = -P[13][3]*dt*sin(X[6])/cos(X[7]) - P[14][3]*dt*cos(X[6])/cos(X[7]) + P[6][3]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][3]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][3] + dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])))*(-P[13][6]*dt*sin(X[6])/cos(X[7]) - P[14][6]*dt*cos(X[6])/cos(X[7]) + P[6][6]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][6]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][6]) + dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8]))*(-P[13][11]*dt*sin(X[6])/cos(X[7]) - P[14][11]*dt*cos(X[6])/cos(X[7]) + P[6][11]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][11]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][11]) + dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))*(-P[13][10]*dt*sin(X[6])/cos(X[7]) - P[14][10]*dt*cos(X[6])/cos(X[7]) + P[6][10]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][10]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][10]) + dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8]))*(-P[13][7]*dt*sin(X[6])/cos(X[7]) - P[14][7]*dt*cos(X[6])/cos(X[7]) + P[6][7]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][7]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][7]) + dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])))*(-P[13][8]*dt*sin(X[6])/cos(X[7]) - P[14][8]*dt*cos(X[6])/cos(X[7]) + P[6][8]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][8]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][8]) - dt*(-P[13][9]*dt*sin(X[6])/cos(X[7]) - P[14][9]*dt*cos(X[6])/cos(X[7]) + P[6][9]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][9]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][9])*cos(X[7])*cos(X[8]);
    P_pred[8][4] = -P[13][4]*dt*sin(X[6])/cos(X[7]) - P[14][4]*dt*cos(X[6])/cos(X[7]) + P[6][4]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][4]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][4] + dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])))*(-P[13][6]*dt*sin(X[6])/cos(X[7]) - P[14][6]*dt*cos(X[6])/cos(X[7]) + P[6][6]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][6]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][6]) + dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))*(-P[13][11]*dt*sin(X[6])/cos(X[7]) - P[14][11]*dt*cos(X[6])/cos(X[7]) + P[6][11]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][11]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][11]) + dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))*(-P[13][10]*dt*sin(X[6])/cos(X[7]) - P[14][10]*dt*cos(X[6])/cos(X[7]) + P[6][10]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][10]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][10]) + dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7]))*(-P[13][7]*dt*sin(X[6])/cos(X[7]) - P[14][7]*dt*cos(X[6])/cos(X[7]) + P[6][7]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][7]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][7]) + dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])))*(-P[13][8]*dt*sin(X[6])/cos(X[7]) - P[14][8]*dt*cos(X[6])/cos(X[7]) + P[6][8]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][8]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][8]) - dt*(-P[13][9]*dt*sin(X[6])/cos(X[7]) - P[14][9]*dt*cos(X[6])/cos(X[7]) + P[6][9]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][9]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][9])*sin(X[8])*cos(X[7]);
    P_pred[8][5] = -P[13][5]*dt*sin(X[6])/cos(X[7]) - P[14][5]*dt*cos(X[6])/cos(X[7]) + P[6][5]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][5]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][5] + dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7]))*(-P[13][6]*dt*sin(X[6])/cos(X[7]) - P[14][6]*dt*cos(X[6])/cos(X[7]) + P[6][6]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][6]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][6]) + dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6]))*(-P[13][7]*dt*sin(X[6])/cos(X[7]) - P[14][7]*dt*cos(X[6])/cos(X[7]) + P[6][7]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][7]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][7]) - dt*(-P[13][10]*dt*sin(X[6])/cos(X[7]) - P[14][10]*dt*cos(X[6])/cos(X[7]) + P[6][10]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][10]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][10])*sin(X[6])*cos(X[7]) - dt*(-P[13][11]*dt*sin(X[6])/cos(X[7]) - P[14][11]*dt*cos(X[6])/cos(X[7]) + P[6][11]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][11]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][11])*cos(X[6])*cos(X[7]) + dt*(-P[13][9]*dt*sin(X[6])/cos(X[7]) - P[14][9]*dt*cos(X[6])/cos(X[7]) + P[6][9]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][9]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][9])*sin(X[7]);
    P_pred[8][6] = Q_diag[4]*pow(dt, 2)*pow(sin(X[6]), 2)*tan(X[7])/cos(X[7]) + Q_diag[5]*pow(dt, 2)*pow(cos(X[6]), 2)*tan(X[7])/cos(X[7]) + dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]))*(-P[13][7]*dt*sin(X[6])/cos(X[7]) - P[14][7]*dt*cos(X[6])/cos(X[7]) + P[6][7]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][7]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][7]) - dt*(-P[13][12]*dt*sin(X[6])/cos(X[7]) - P[14][12]*dt*cos(X[6])/cos(X[7]) + P[6][12]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][12]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][12]) - dt*(-P[13][13]*dt*sin(X[6])/cos(X[7]) - P[14][13]*dt*cos(X[6])/cos(X[7]) + P[6][13]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][13]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][13])*sin(X[6])*tan(X[7]) - dt*(-P[13][14]*dt*sin(X[6])/cos(X[7]) - P[14][14]*dt*cos(X[6])/cos(X[7]) + P[6][14]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][14]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][14])*cos(X[6])*tan(X[7]) + (dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1)*(-P[13][6]*dt*sin(X[6])/cos(X[7]) - P[14][6]*dt*cos(X[6])/cos(X[7]) + P[6][6]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][6]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][6]);
    P_pred[8][7] = -P[13][7]*dt*sin(X[6])/cos(X[7]) - P[14][7]*dt*cos(X[6])/cos(X[7]) + P[6][7]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][7]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][7] + Q_diag[4]*pow(dt, 2)*sin(X[6])*cos(X[6])/cos(X[7]) - Q_diag[5]*pow(dt, 2)*sin(X[6])*cos(X[6])/cos(X[7]) + dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6]))*(-P[13][6]*dt*sin(X[6])/cos(X[7]) - P[14][6]*dt*cos(X[6])/cos(X[7]) + P[6][6]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][6]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][6]) - dt*(-P[13][13]*dt*sin(X[6])/cos(X[7]) - P[14][13]*dt*cos(X[6])/cos(X[7]) + P[6][13]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][13]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][13])*cos(X[6]) + dt*(-P[13][14]*dt*sin(X[6])/cos(X[7]) - P[14][14]*dt*cos(X[6])/cos(X[7]) + P[6][14]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][14]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][14])*sin(X[6]);
    P_pred[8][8] = -P[13][8]*dt*sin(X[6])/cos(X[7]) - P[14][8]*dt*cos(X[6])/cos(X[7]) + P[6][8]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][8]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][8] + Q_diag[4]*pow(dt, 2)*pow(sin(X[6]), 2)/pow(cos(X[7]), 2) + Q_diag[5]*pow(dt, 2)*pow(cos(X[6]), 2)/pow(cos(X[7]), 2) + dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7]))*(-P[13][6]*dt*sin(X[6])/cos(X[7]) - P[14][6]*dt*cos(X[6])/cos(X[7]) + P[6][6]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][6]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][6]) + dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2))*(-P[13][7]*dt*sin(X[6])/cos(X[7]) - P[14][7]*dt*cos(X[6])/cos(X[7]) + P[6][7]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][7]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][7]) - dt*(-P[13][13]*dt*sin(X[6])/cos(X[7]) - P[14][13]*dt*cos(X[6])/cos(X[7]) + P[6][13]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][13]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][13])*sin(X[6])/cos(X[7]) - dt*(-P[13][14]*dt*sin(X[6])/cos(X[7]) - P[14][14]*dt*cos(X[6])/cos(X[7]) + P[6][14]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][14]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][14])*cos(X[6])/cos(X[7]);
    P_pred[8][9] = -P[13][9]*dt*sin(X[6])/cos(X[7]) - P[14][9]*dt*cos(X[6])/cos(X[7]) + P[6][9]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][9]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][9];
    P_pred[8][10] = -P[13][10]*dt*sin(X[6])/cos(X[7]) - P[14][10]*dt*cos(X[6])/cos(X[7]) + P[6][10]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][10]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][10];
    P_pred[8][11] = -P[13][11]*dt*sin(X[6])/cos(X[7]) - P[14][11]*dt*cos(X[6])/cos(X[7]) + P[6][11]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][11]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][11];
    P_pred[8][12] = -P[13][12]*dt*sin(X[6])/cos(X[7]) - P[14][12]*dt*cos(X[6])/cos(X[7]) + P[6][12]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][12]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][12];
    P_pred[8][13] = -P[13][13]*dt*sin(X[6])/cos(X[7]) - P[14][13]*dt*cos(X[6])/cos(X[7]) + P[6][13]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][13]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][13];
    P_pred[8][14] = -P[13][14]*dt*sin(X[6])/cos(X[7]) - P[14][14]*dt*cos(X[6])/cos(X[7]) + P[6][14]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[7][14]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[8][14];
    P_pred[9][0] = P[9][0] + P[9][3]*dt;
    P_pred[9][1] = P[9][1] + P[9][4]*dt;
    P_pred[9][2] = P[9][2] + P[9][5]*dt;
    P_pred[9][3] = P[9][10]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[9][11]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[9][3] + P[9][6]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[9][7]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[9][8]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[9][9]*dt*cos(X[7])*cos(X[8]);
    P_pred[9][4] = P[9][10]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[9][11]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[9][4] + P[9][6]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[9][7]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[9][8]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[9][9]*dt*sin(X[8])*cos(X[7]);
    P_pred[9][5] = -P[9][10]*dt*sin(X[6])*cos(X[7]) - P[9][11]*dt*cos(X[6])*cos(X[7]) + P[9][5] + P[9][6]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[9][7]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[9][9]*dt*sin(X[7]);
    P_pred[9][6] = -P[9][12]*dt - P[9][13]*dt*sin(X[6])*tan(X[7]) - P[9][14]*dt*cos(X[6])*tan(X[7]) + P[9][6]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[9][7]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]));
    P_pred[9][7] = -P[9][13]*dt*cos(X[6]) + P[9][14]*dt*sin(X[6]) + P[9][6]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[9][7];
    P_pred[9][8] = -P[9][13]*dt*sin(X[6])/cos(X[7]) - P[9][14]*dt*cos(X[6])/cos(X[7]) + P[9][6]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[9][7]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[9][8];
    P_pred[9][9] = P[9][9];
    P_pred[9][10] = P[9][10];
    P_pred[9][11] = P[9][11];
    P_pred[9][12] = P[9][12];
    P_pred[9][13] = P[9][13];
    P_pred[9][14] = P[9][14];
    P_pred[10][0] = P[10][0] + P[10][3]*dt;
    P_pred[10][1] = P[10][1] + P[10][4]*dt;
    P_pred[10][2] = P[10][2] + P[10][5]*dt;
    P_pred[10][3] = P[10][10]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[10][11]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[10][3] + P[10][6]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[10][7]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[10][8]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[10][9]*dt*cos(X[7])*cos(X[8]);
    P_pred[10][4] = P[10][10]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[10][11]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[10][4] + P[10][6]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[10][7]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[10][8]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[10][9]*dt*sin(X[8])*cos(X[7]);
    P_pred[10][5] = -P[10][10]*dt*sin(X[6])*cos(X[7]) - P[10][11]*dt*cos(X[6])*cos(X[7]) + P[10][5] + P[10][6]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[10][7]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[10][9]*dt*sin(X[7]);
    P_pred[10][6] = -P[10][12]*dt - P[10][13]*dt*sin(X[6])*tan(X[7]) - P[10][14]*dt*cos(X[6])*tan(X[7]) + P[10][6]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[10][7]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]));
    P_pred[10][7] = -P[10][13]*dt*cos(X[6]) + P[10][14]*dt*sin(X[6]) + P[10][6]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[10][7];
    P_pred[10][8] = -P[10][13]*dt*sin(X[6])/cos(X[7]) - P[10][14]*dt*cos(X[6])/cos(X[7]) + P[10][6]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[10][7]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[10][8];
    P_pred[10][9] = P[10][9];
    P_pred[10][10] = P[10][10];
    P_pred[10][11] = P[10][11];
    P_pred[10][12] = P[10][12];
    P_pred[10][13] = P[10][13];
    P_pred[10][14] = P[10][14];
    P_pred[11][0] = P[11][0] + P[11][3]*dt;
    P_pred[11][1] = P[11][1] + P[11][4]*dt;
    P_pred[11][2] = P[11][2] + P[11][5]*dt;
    P_pred[11][3] = P[11][10]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[11][11]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[11][3] + P[11][6]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[11][7]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[11][8]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[11][9]*dt*cos(X[7])*cos(X[8]);
    P_pred[11][4] = P[11][10]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[11][11]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[11][4] + P[11][6]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[11][7]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[11][8]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[11][9]*dt*sin(X[8])*cos(X[7]);
    P_pred[11][5] = -P[11][10]*dt*sin(X[6])*cos(X[7]) - P[11][11]*dt*cos(X[6])*cos(X[7]) + P[11][5] + P[11][6]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[11][7]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[11][9]*dt*sin(X[7]);
    P_pred[11][6] = -P[11][12]*dt - P[11][13]*dt*sin(X[6])*tan(X[7]) - P[11][14]*dt*cos(X[6])*tan(X[7]) + P[11][6]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[11][7]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]));
    P_pred[11][7] = -P[11][13]*dt*cos(X[6]) + P[11][14]*dt*sin(X[6]) + P[11][6]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[11][7];
    P_pred[11][8] = -P[11][13]*dt*sin(X[6])/cos(X[7]) - P[11][14]*dt*cos(X[6])/cos(X[7]) + P[11][6]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[11][7]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[11][8];
    P_pred[11][9] = P[11][9];
    P_pred[11][10] = P[11][10];
    P_pred[11][11] = P[11][11];
    P_pred[11][12] = P[11][12];
    P_pred[11][13] = P[11][13];
    P_pred[11][14] = P[11][14];
    P_pred[12][0] = P[12][0] + P[12][3]*dt;
    P_pred[12][1] = P[12][1] + P[12][4]*dt;
    P_pred[12][2] = P[12][2] + P[12][5]*dt;
    P_pred[12][3] = P[12][10]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[12][11]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[12][3] + P[12][6]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[12][7]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[12][8]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[12][9]*dt*cos(X[7])*cos(X[8]);
    P_pred[12][4] = P[12][10]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[12][11]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[12][4] + P[12][6]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[12][7]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[12][8]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[12][9]*dt*sin(X[8])*cos(X[7]);
    P_pred[12][5] = -P[12][10]*dt*sin(X[6])*cos(X[7]) - P[12][11]*dt*cos(X[6])*cos(X[7]) + P[12][5] + P[12][6]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[12][7]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[12][9]*dt*sin(X[7]);
    P_pred[12][6] = -P[12][12]*dt - P[12][13]*dt*sin(X[6])*tan(X[7]) - P[12][14]*dt*cos(X[6])*tan(X[7]) + P[12][6]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[12][7]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]));
    P_pred[12][7] = -P[12][13]*dt*cos(X[6]) + P[12][14]*dt*sin(X[6]) + P[12][6]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[12][7];
    P_pred[12][8] = -P[12][13]*dt*sin(X[6])/cos(X[7]) - P[12][14]*dt*cos(X[6])/cos(X[7]) + P[12][6]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[12][7]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[12][8];
    P_pred[12][9] = P[12][9];
    P_pred[12][10] = P[12][10];
    P_pred[12][11] = P[12][11];
    P_pred[12][12] = P[12][12];
    P_pred[12][13] = P[12][13];
    P_pred[12][14] = P[12][14];
    P_pred[13][0] = P[13][0] + P[13][3]*dt;
    P_pred[13][1] = P[13][1] + P[13][4]*dt;
    P_pred[13][2] = P[13][2] + P[13][5]*dt;
    P_pred[13][3] = P[13][10]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[13][11]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[13][3] + P[13][6]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[13][7]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[13][8]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[13][9]*dt*cos(X[7])*cos(X[8]);
    P_pred[13][4] = P[13][10]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[13][11]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[13][4] + P[13][6]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[13][7]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[13][8]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[13][9]*dt*sin(X[8])*cos(X[7]);
    P_pred[13][5] = -P[13][10]*dt*sin(X[6])*cos(X[7]) - P[13][11]*dt*cos(X[6])*cos(X[7]) + P[13][5] + P[13][6]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[13][7]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[13][9]*dt*sin(X[7]);
    P_pred[13][6] = -P[13][12]*dt - P[13][13]*dt*sin(X[6])*tan(X[7]) - P[13][14]*dt*cos(X[6])*tan(X[7]) + P[13][6]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[13][7]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]));
    P_pred[13][7] = -P[13][13]*dt*cos(X[6]) + P[13][14]*dt*sin(X[6]) + P[13][6]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[13][7];
    P_pred[13][8] = -P[13][13]*dt*sin(X[6])/cos(X[7]) - P[13][14]*dt*cos(X[6])/cos(X[7]) + P[13][6]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[13][7]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[13][8];
    P_pred[13][9] = P[13][9];
    P_pred[13][10] = P[13][10];
    P_pred[13][11] = P[13][11];
    P_pred[13][12] = P[13][12];
    P_pred[13][13] = P[13][13];
    P_pred[13][14] = P[13][14];
    P_pred[14][0] = P[14][0] + P[14][3]*dt;
    P_pred[14][1] = P[14][1] + P[14][4]*dt;
    P_pred[14][2] = P[14][2] + P[14][5]*dt;
    P_pred[14][3] = P[14][10]*dt*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6])) + P[14][11]*dt*(-sin(X[6])*sin(X[8]) - sin(X[7])*cos(X[6])*cos(X[8])) + P[14][3] + P[14][6]*dt*((U[1] - X[10])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*cos(X[8]) + sin(X[8])*cos(X[6]))) + P[14][7]*dt*(-(U[0] - X[9])*sin(X[7])*cos(X[8]) + (U[1] - X[10])*sin(X[6])*cos(X[7])*cos(X[8]) + (U[2] - X[11])*cos(X[6])*cos(X[7])*cos(X[8])) + P[14][8]*dt*(-(U[0] - X[9])*sin(X[8])*cos(X[7]) + (U[1] - X[10])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + (U[2] - X[11])*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6]))) - P[14][9]*dt*cos(X[7])*cos(X[8]);
    P_pred[14][4] = P[14][10]*dt*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8])) + P[14][11]*dt*(sin(X[6])*cos(X[8]) - sin(X[7])*sin(X[8])*cos(X[6])) + P[14][4] + P[14][6]*dt*((U[1] - X[10])*(-sin(X[6])*cos(X[8]) + sin(X[7])*sin(X[8])*cos(X[6])) + (U[2] - X[11])*(-sin(X[6])*sin(X[7])*sin(X[8]) - cos(X[6])*cos(X[8]))) + P[14][7]*dt*(-(U[0] - X[9])*sin(X[7])*sin(X[8]) + (U[1] - X[10])*sin(X[6])*sin(X[8])*cos(X[7]) + (U[2] - X[11])*sin(X[8])*cos(X[6])*cos(X[7])) + P[14][8]*dt*((U[0] - X[9])*cos(X[7])*cos(X[8]) + (U[1] - X[10])*(sin(X[6])*sin(X[7])*cos(X[8]) - sin(X[8])*cos(X[6])) + (U[2] - X[11])*(sin(X[6])*sin(X[8]) + sin(X[7])*cos(X[6])*cos(X[8]))) - P[14][9]*dt*sin(X[8])*cos(X[7]);
    P_pred[14][5] = -P[14][10]*dt*sin(X[6])*cos(X[7]) - P[14][11]*dt*cos(X[6])*cos(X[7]) + P[14][5] + P[14][6]*dt*((U[1] - X[10])*cos(X[6])*cos(X[7]) - (U[2] - X[11])*sin(X[6])*cos(X[7])) + P[14][7]*dt*(-(U[0] - X[9])*cos(X[7]) - (U[1] - X[10])*sin(X[6])*sin(X[7]) - (U[2] - X[11])*sin(X[7])*cos(X[6])) + P[14][9]*dt*sin(X[7]);
    P_pred[14][6] = -P[14][12]*dt - P[14][13]*dt*sin(X[6])*tan(X[7]) - P[14][14]*dt*cos(X[6])*tan(X[7]) + P[14][6]*(dt*((U[4] - X[13])*cos(X[6])*tan(X[7]) - (U[5] - X[14])*sin(X[6])*tan(X[7])) + 1) + P[14][7]*dt*((U[4] - X[13])*(pow(tan(X[7]), 2) + 1)*sin(X[6]) + (U[5] - X[14])*(pow(tan(X[7]), 2) + 1)*cos(X[6]));
    P_pred[14][7] = -P[14][13]*dt*cos(X[6]) + P[14][14]*dt*sin(X[6]) + P[14][6]*dt*(-(U[4] - X[13])*sin(X[6]) - (U[5] - X[14])*cos(X[6])) + P[14][7];
    P_pred[14][8] = -P[14][13]*dt*sin(X[6])/cos(X[7]) - P[14][14]*dt*cos(X[6])/cos(X[7]) + P[14][6]*dt*((U[4] - X[13])*cos(X[6])/cos(X[7]) - (U[5] - X[14])*sin(X[6])/cos(X[7])) + P[14][7]*dt*((U[4] - X[13])*sin(X[6])*sin(X[7])/pow(cos(X[7]), 2) + (U[5] - X[14])*sin(X[7])*cos(X[6])/pow(cos(X[7]), 2)) + P[14][8];
    P_pred[14][9] = P[14][9];
    P_pred[14][10] = P[14][10];
    P_pred[14][11] = P[14][11];
    P_pred[14][12] = P[14][12];
    P_pred[14][13] = P[14][13];
    P_pred[14][14] = P[14][14];

    // [3] overwrite state and covariance
    int i,j;
    for(i=0;i<N_STATES;i++) {
        X[i] = X_pred[i];
        for(j=0;j<N_STATES;j++) {
            P[i][j] = P_pred[i][j];
        }
    }
}

void ekf_update(float Z[N_MEASUREMENTS]) {
    // Residual covariance: S = H*P*H.T + R
    float S[N_MEASUREMENTS][N_MEASUREMENTS] = { 
        {P[0][0] + R_diag[0],P[0][1],P[0][2],P[0][6],P[0][7],P[0][8],},
        {P[1][0],P[1][1] + R_diag[1],P[1][2],P[1][6],P[1][7],P[1][8],},
        {P[2][0],P[2][1],P[2][2] + R_diag[2],P[2][6],P[2][7],P[2][8],},
        {P[6][0],P[6][1],P[6][2],P[6][6] + R_diag[3],P[6][7],P[6][8],},
        {P[7][0],P[7][1],P[7][2],P[7][6],P[7][7] + R_diag[4],P[7][8],},
        {P[8][0],P[8][1],P[8][2],P[8][6],P[8][7],P[8][8] + R_diag[5],}
    };
    // Inverse of S
    float S_inv[N_MEASUREMENTS][N_MEASUREMENTS];
    float_mat_invert(S_inv,S,N_MEASUREMENTS);
               
    // Kalman gain: K = P*H.T*S_inv 
    // [1] state update X_up = X + K*(Z - h(X)) 
    float X_up[N_STATES];
    X_up[0] = X[0] + (-X[0] + Z[0])*(P[0][0]*S_inv[0][0] + P[0][1]*S_inv[1][0] + P[0][2]*S_inv[2][0] + P[0][6]*S_inv[3][0] + P[0][7]*S_inv[4][0] + P[0][8]*S_inv[5][0]) + (-X[1] + Z[1])*(P[0][0]*S_inv[0][1] + P[0][1]*S_inv[1][1] + P[0][2]*S_inv[2][1] + P[0][6]*S_inv[3][1] + P[0][7]*S_inv[4][1] + P[0][8]*S_inv[5][1]) + (-X[2] + Z[2])*(P[0][0]*S_inv[0][2] + P[0][1]*S_inv[1][2] + P[0][2]*S_inv[2][2] + P[0][6]*S_inv[3][2] + P[0][7]*S_inv[4][2] + P[0][8]*S_inv[5][2]) + (-X[6] + Z[3])*(P[0][0]*S_inv[0][3] + P[0][1]*S_inv[1][3] + P[0][2]*S_inv[2][3] + P[0][6]*S_inv[3][3] + P[0][7]*S_inv[4][3] + P[0][8]*S_inv[5][3]) + (-X[7] + Z[4])*(P[0][0]*S_inv[0][4] + P[0][1]*S_inv[1][4] + P[0][2]*S_inv[2][4] + P[0][6]*S_inv[3][4] + P[0][7]*S_inv[4][4] + P[0][8]*S_inv[5][4]) + (-X[8] + Z[5])*(P[0][0]*S_inv[0][5] + P[0][1]*S_inv[1][5] + P[0][2]*S_inv[2][5] + P[0][6]*S_inv[3][5] + P[0][7]*S_inv[4][5] + P[0][8]*S_inv[5][5]);
    X_up[1] = X[1] + (-X[0] + Z[0])*(P[1][0]*S_inv[0][0] + P[1][1]*S_inv[1][0] + P[1][2]*S_inv[2][0] + P[1][6]*S_inv[3][0] + P[1][7]*S_inv[4][0] + P[1][8]*S_inv[5][0]) + (-X[1] + Z[1])*(P[1][0]*S_inv[0][1] + P[1][1]*S_inv[1][1] + P[1][2]*S_inv[2][1] + P[1][6]*S_inv[3][1] + P[1][7]*S_inv[4][1] + P[1][8]*S_inv[5][1]) + (-X[2] + Z[2])*(P[1][0]*S_inv[0][2] + P[1][1]*S_inv[1][2] + P[1][2]*S_inv[2][2] + P[1][6]*S_inv[3][2] + P[1][7]*S_inv[4][2] + P[1][8]*S_inv[5][2]) + (-X[6] + Z[3])*(P[1][0]*S_inv[0][3] + P[1][1]*S_inv[1][3] + P[1][2]*S_inv[2][3] + P[1][6]*S_inv[3][3] + P[1][7]*S_inv[4][3] + P[1][8]*S_inv[5][3]) + (-X[7] + Z[4])*(P[1][0]*S_inv[0][4] + P[1][1]*S_inv[1][4] + P[1][2]*S_inv[2][4] + P[1][6]*S_inv[3][4] + P[1][7]*S_inv[4][4] + P[1][8]*S_inv[5][4]) + (-X[8] + Z[5])*(P[1][0]*S_inv[0][5] + P[1][1]*S_inv[1][5] + P[1][2]*S_inv[2][5] + P[1][6]*S_inv[3][5] + P[1][7]*S_inv[4][5] + P[1][8]*S_inv[5][5]);
    X_up[2] = X[2] + (-X[0] + Z[0])*(P[2][0]*S_inv[0][0] + P[2][1]*S_inv[1][0] + P[2][2]*S_inv[2][0] + P[2][6]*S_inv[3][0] + P[2][7]*S_inv[4][0] + P[2][8]*S_inv[5][0]) + (-X[1] + Z[1])*(P[2][0]*S_inv[0][1] + P[2][1]*S_inv[1][1] + P[2][2]*S_inv[2][1] + P[2][6]*S_inv[3][1] + P[2][7]*S_inv[4][1] + P[2][8]*S_inv[5][1]) + (-X[2] + Z[2])*(P[2][0]*S_inv[0][2] + P[2][1]*S_inv[1][2] + P[2][2]*S_inv[2][2] + P[2][6]*S_inv[3][2] + P[2][7]*S_inv[4][2] + P[2][8]*S_inv[5][2]) + (-X[6] + Z[3])*(P[2][0]*S_inv[0][3] + P[2][1]*S_inv[1][3] + P[2][2]*S_inv[2][3] + P[2][6]*S_inv[3][3] + P[2][7]*S_inv[4][3] + P[2][8]*S_inv[5][3]) + (-X[7] + Z[4])*(P[2][0]*S_inv[0][4] + P[2][1]*S_inv[1][4] + P[2][2]*S_inv[2][4] + P[2][6]*S_inv[3][4] + P[2][7]*S_inv[4][4] + P[2][8]*S_inv[5][4]) + (-X[8] + Z[5])*(P[2][0]*S_inv[0][5] + P[2][1]*S_inv[1][5] + P[2][2]*S_inv[2][5] + P[2][6]*S_inv[3][5] + P[2][7]*S_inv[4][5] + P[2][8]*S_inv[5][5]);
    X_up[3] = X[3] + (-X[0] + Z[0])*(P[3][0]*S_inv[0][0] + P[3][1]*S_inv[1][0] + P[3][2]*S_inv[2][0] + P[3][6]*S_inv[3][0] + P[3][7]*S_inv[4][0] + P[3][8]*S_inv[5][0]) + (-X[1] + Z[1])*(P[3][0]*S_inv[0][1] + P[3][1]*S_inv[1][1] + P[3][2]*S_inv[2][1] + P[3][6]*S_inv[3][1] + P[3][7]*S_inv[4][1] + P[3][8]*S_inv[5][1]) + (-X[2] + Z[2])*(P[3][0]*S_inv[0][2] + P[3][1]*S_inv[1][2] + P[3][2]*S_inv[2][2] + P[3][6]*S_inv[3][2] + P[3][7]*S_inv[4][2] + P[3][8]*S_inv[5][2]) + (-X[6] + Z[3])*(P[3][0]*S_inv[0][3] + P[3][1]*S_inv[1][3] + P[3][2]*S_inv[2][3] + P[3][6]*S_inv[3][3] + P[3][7]*S_inv[4][3] + P[3][8]*S_inv[5][3]) + (-X[7] + Z[4])*(P[3][0]*S_inv[0][4] + P[3][1]*S_inv[1][4] + P[3][2]*S_inv[2][4] + P[3][6]*S_inv[3][4] + P[3][7]*S_inv[4][4] + P[3][8]*S_inv[5][4]) + (-X[8] + Z[5])*(P[3][0]*S_inv[0][5] + P[3][1]*S_inv[1][5] + P[3][2]*S_inv[2][5] + P[3][6]*S_inv[3][5] + P[3][7]*S_inv[4][5] + P[3][8]*S_inv[5][5]);
    X_up[4] = X[4] + (-X[0] + Z[0])*(P[4][0]*S_inv[0][0] + P[4][1]*S_inv[1][0] + P[4][2]*S_inv[2][0] + P[4][6]*S_inv[3][0] + P[4][7]*S_inv[4][0] + P[4][8]*S_inv[5][0]) + (-X[1] + Z[1])*(P[4][0]*S_inv[0][1] + P[4][1]*S_inv[1][1] + P[4][2]*S_inv[2][1] + P[4][6]*S_inv[3][1] + P[4][7]*S_inv[4][1] + P[4][8]*S_inv[5][1]) + (-X[2] + Z[2])*(P[4][0]*S_inv[0][2] + P[4][1]*S_inv[1][2] + P[4][2]*S_inv[2][2] + P[4][6]*S_inv[3][2] + P[4][7]*S_inv[4][2] + P[4][8]*S_inv[5][2]) + (-X[6] + Z[3])*(P[4][0]*S_inv[0][3] + P[4][1]*S_inv[1][3] + P[4][2]*S_inv[2][3] + P[4][6]*S_inv[3][3] + P[4][7]*S_inv[4][3] + P[4][8]*S_inv[5][3]) + (-X[7] + Z[4])*(P[4][0]*S_inv[0][4] + P[4][1]*S_inv[1][4] + P[4][2]*S_inv[2][4] + P[4][6]*S_inv[3][4] + P[4][7]*S_inv[4][4] + P[4][8]*S_inv[5][4]) + (-X[8] + Z[5])*(P[4][0]*S_inv[0][5] + P[4][1]*S_inv[1][5] + P[4][2]*S_inv[2][5] + P[4][6]*S_inv[3][5] + P[4][7]*S_inv[4][5] + P[4][8]*S_inv[5][5]);
    X_up[5] = X[5] + (-X[0] + Z[0])*(P[5][0]*S_inv[0][0] + P[5][1]*S_inv[1][0] + P[5][2]*S_inv[2][0] + P[5][6]*S_inv[3][0] + P[5][7]*S_inv[4][0] + P[5][8]*S_inv[5][0]) + (-X[1] + Z[1])*(P[5][0]*S_inv[0][1] + P[5][1]*S_inv[1][1] + P[5][2]*S_inv[2][1] + P[5][6]*S_inv[3][1] + P[5][7]*S_inv[4][1] + P[5][8]*S_inv[5][1]) + (-X[2] + Z[2])*(P[5][0]*S_inv[0][2] + P[5][1]*S_inv[1][2] + P[5][2]*S_inv[2][2] + P[5][6]*S_inv[3][2] + P[5][7]*S_inv[4][2] + P[5][8]*S_inv[5][2]) + (-X[6] + Z[3])*(P[5][0]*S_inv[0][3] + P[5][1]*S_inv[1][3] + P[5][2]*S_inv[2][3] + P[5][6]*S_inv[3][3] + P[5][7]*S_inv[4][3] + P[5][8]*S_inv[5][3]) + (-X[7] + Z[4])*(P[5][0]*S_inv[0][4] + P[5][1]*S_inv[1][4] + P[5][2]*S_inv[2][4] + P[5][6]*S_inv[3][4] + P[5][7]*S_inv[4][4] + P[5][8]*S_inv[5][4]) + (-X[8] + Z[5])*(P[5][0]*S_inv[0][5] + P[5][1]*S_inv[1][5] + P[5][2]*S_inv[2][5] + P[5][6]*S_inv[3][5] + P[5][7]*S_inv[4][5] + P[5][8]*S_inv[5][5]);
    X_up[6] = X[6] + (-X[0] + Z[0])*(P[6][0]*S_inv[0][0] + P[6][1]*S_inv[1][0] + P[6][2]*S_inv[2][0] + P[6][6]*S_inv[3][0] + P[6][7]*S_inv[4][0] + P[6][8]*S_inv[5][0]) + (-X[1] + Z[1])*(P[6][0]*S_inv[0][1] + P[6][1]*S_inv[1][1] + P[6][2]*S_inv[2][1] + P[6][6]*S_inv[3][1] + P[6][7]*S_inv[4][1] + P[6][8]*S_inv[5][1]) + (-X[2] + Z[2])*(P[6][0]*S_inv[0][2] + P[6][1]*S_inv[1][2] + P[6][2]*S_inv[2][2] + P[6][6]*S_inv[3][2] + P[6][7]*S_inv[4][2] + P[6][8]*S_inv[5][2]) + (-X[6] + Z[3])*(P[6][0]*S_inv[0][3] + P[6][1]*S_inv[1][3] + P[6][2]*S_inv[2][3] + P[6][6]*S_inv[3][3] + P[6][7]*S_inv[4][3] + P[6][8]*S_inv[5][3]) + (-X[7] + Z[4])*(P[6][0]*S_inv[0][4] + P[6][1]*S_inv[1][4] + P[6][2]*S_inv[2][4] + P[6][6]*S_inv[3][4] + P[6][7]*S_inv[4][4] + P[6][8]*S_inv[5][4]) + (-X[8] + Z[5])*(P[6][0]*S_inv[0][5] + P[6][1]*S_inv[1][5] + P[6][2]*S_inv[2][5] + P[6][6]*S_inv[3][5] + P[6][7]*S_inv[4][5] + P[6][8]*S_inv[5][5]);
    X_up[7] = X[7] + (-X[0] + Z[0])*(P[7][0]*S_inv[0][0] + P[7][1]*S_inv[1][0] + P[7][2]*S_inv[2][0] + P[7][6]*S_inv[3][0] + P[7][7]*S_inv[4][0] + P[7][8]*S_inv[5][0]) + (-X[1] + Z[1])*(P[7][0]*S_inv[0][1] + P[7][1]*S_inv[1][1] + P[7][2]*S_inv[2][1] + P[7][6]*S_inv[3][1] + P[7][7]*S_inv[4][1] + P[7][8]*S_inv[5][1]) + (-X[2] + Z[2])*(P[7][0]*S_inv[0][2] + P[7][1]*S_inv[1][2] + P[7][2]*S_inv[2][2] + P[7][6]*S_inv[3][2] + P[7][7]*S_inv[4][2] + P[7][8]*S_inv[5][2]) + (-X[6] + Z[3])*(P[7][0]*S_inv[0][3] + P[7][1]*S_inv[1][3] + P[7][2]*S_inv[2][3] + P[7][6]*S_inv[3][3] + P[7][7]*S_inv[4][3] + P[7][8]*S_inv[5][3]) + (-X[7] + Z[4])*(P[7][0]*S_inv[0][4] + P[7][1]*S_inv[1][4] + P[7][2]*S_inv[2][4] + P[7][6]*S_inv[3][4] + P[7][7]*S_inv[4][4] + P[7][8]*S_inv[5][4]) + (-X[8] + Z[5])*(P[7][0]*S_inv[0][5] + P[7][1]*S_inv[1][5] + P[7][2]*S_inv[2][5] + P[7][6]*S_inv[3][5] + P[7][7]*S_inv[4][5] + P[7][8]*S_inv[5][5]);
    X_up[8] = X[8] + (-X[0] + Z[0])*(P[8][0]*S_inv[0][0] + P[8][1]*S_inv[1][0] + P[8][2]*S_inv[2][0] + P[8][6]*S_inv[3][0] + P[8][7]*S_inv[4][0] + P[8][8]*S_inv[5][0]) + (-X[1] + Z[1])*(P[8][0]*S_inv[0][1] + P[8][1]*S_inv[1][1] + P[8][2]*S_inv[2][1] + P[8][6]*S_inv[3][1] + P[8][7]*S_inv[4][1] + P[8][8]*S_inv[5][1]) + (-X[2] + Z[2])*(P[8][0]*S_inv[0][2] + P[8][1]*S_inv[1][2] + P[8][2]*S_inv[2][2] + P[8][6]*S_inv[3][2] + P[8][7]*S_inv[4][2] + P[8][8]*S_inv[5][2]) + (-X[6] + Z[3])*(P[8][0]*S_inv[0][3] + P[8][1]*S_inv[1][3] + P[8][2]*S_inv[2][3] + P[8][6]*S_inv[3][3] + P[8][7]*S_inv[4][3] + P[8][8]*S_inv[5][3]) + (-X[7] + Z[4])*(P[8][0]*S_inv[0][4] + P[8][1]*S_inv[1][4] + P[8][2]*S_inv[2][4] + P[8][6]*S_inv[3][4] + P[8][7]*S_inv[4][4] + P[8][8]*S_inv[5][4]) + (-X[8] + Z[5])*(P[8][0]*S_inv[0][5] + P[8][1]*S_inv[1][5] + P[8][2]*S_inv[2][5] + P[8][6]*S_inv[3][5] + P[8][7]*S_inv[4][5] + P[8][8]*S_inv[5][5]);
    X_up[9] = X[9] + (-X[0] + Z[0])*(P[9][0]*S_inv[0][0] + P[9][1]*S_inv[1][0] + P[9][2]*S_inv[2][0] + P[9][6]*S_inv[3][0] + P[9][7]*S_inv[4][0] + P[9][8]*S_inv[5][0]) + (-X[1] + Z[1])*(P[9][0]*S_inv[0][1] + P[9][1]*S_inv[1][1] + P[9][2]*S_inv[2][1] + P[9][6]*S_inv[3][1] + P[9][7]*S_inv[4][1] + P[9][8]*S_inv[5][1]) + (-X[2] + Z[2])*(P[9][0]*S_inv[0][2] + P[9][1]*S_inv[1][2] + P[9][2]*S_inv[2][2] + P[9][6]*S_inv[3][2] + P[9][7]*S_inv[4][2] + P[9][8]*S_inv[5][2]) + (-X[6] + Z[3])*(P[9][0]*S_inv[0][3] + P[9][1]*S_inv[1][3] + P[9][2]*S_inv[2][3] + P[9][6]*S_inv[3][3] + P[9][7]*S_inv[4][3] + P[9][8]*S_inv[5][3]) + (-X[7] + Z[4])*(P[9][0]*S_inv[0][4] + P[9][1]*S_inv[1][4] + P[9][2]*S_inv[2][4] + P[9][6]*S_inv[3][4] + P[9][7]*S_inv[4][4] + P[9][8]*S_inv[5][4]) + (-X[8] + Z[5])*(P[9][0]*S_inv[0][5] + P[9][1]*S_inv[1][5] + P[9][2]*S_inv[2][5] + P[9][6]*S_inv[3][5] + P[9][7]*S_inv[4][5] + P[9][8]*S_inv[5][5]);
    X_up[10] = X[10] + (-X[0] + Z[0])*(P[10][0]*S_inv[0][0] + P[10][1]*S_inv[1][0] + P[10][2]*S_inv[2][0] + P[10][6]*S_inv[3][0] + P[10][7]*S_inv[4][0] + P[10][8]*S_inv[5][0]) + (-X[1] + Z[1])*(P[10][0]*S_inv[0][1] + P[10][1]*S_inv[1][1] + P[10][2]*S_inv[2][1] + P[10][6]*S_inv[3][1] + P[10][7]*S_inv[4][1] + P[10][8]*S_inv[5][1]) + (-X[2] + Z[2])*(P[10][0]*S_inv[0][2] + P[10][1]*S_inv[1][2] + P[10][2]*S_inv[2][2] + P[10][6]*S_inv[3][2] + P[10][7]*S_inv[4][2] + P[10][8]*S_inv[5][2]) + (-X[6] + Z[3])*(P[10][0]*S_inv[0][3] + P[10][1]*S_inv[1][3] + P[10][2]*S_inv[2][3] + P[10][6]*S_inv[3][3] + P[10][7]*S_inv[4][3] + P[10][8]*S_inv[5][3]) + (-X[7] + Z[4])*(P[10][0]*S_inv[0][4] + P[10][1]*S_inv[1][4] + P[10][2]*S_inv[2][4] + P[10][6]*S_inv[3][4] + P[10][7]*S_inv[4][4] + P[10][8]*S_inv[5][4]) + (-X[8] + Z[5])*(P[10][0]*S_inv[0][5] + P[10][1]*S_inv[1][5] + P[10][2]*S_inv[2][5] + P[10][6]*S_inv[3][5] + P[10][7]*S_inv[4][5] + P[10][8]*S_inv[5][5]);
    X_up[11] = X[11] + (-X[0] + Z[0])*(P[11][0]*S_inv[0][0] + P[11][1]*S_inv[1][0] + P[11][2]*S_inv[2][0] + P[11][6]*S_inv[3][0] + P[11][7]*S_inv[4][0] + P[11][8]*S_inv[5][0]) + (-X[1] + Z[1])*(P[11][0]*S_inv[0][1] + P[11][1]*S_inv[1][1] + P[11][2]*S_inv[2][1] + P[11][6]*S_inv[3][1] + P[11][7]*S_inv[4][1] + P[11][8]*S_inv[5][1]) + (-X[2] + Z[2])*(P[11][0]*S_inv[0][2] + P[11][1]*S_inv[1][2] + P[11][2]*S_inv[2][2] + P[11][6]*S_inv[3][2] + P[11][7]*S_inv[4][2] + P[11][8]*S_inv[5][2]) + (-X[6] + Z[3])*(P[11][0]*S_inv[0][3] + P[11][1]*S_inv[1][3] + P[11][2]*S_inv[2][3] + P[11][6]*S_inv[3][3] + P[11][7]*S_inv[4][3] + P[11][8]*S_inv[5][3]) + (-X[7] + Z[4])*(P[11][0]*S_inv[0][4] + P[11][1]*S_inv[1][4] + P[11][2]*S_inv[2][4] + P[11][6]*S_inv[3][4] + P[11][7]*S_inv[4][4] + P[11][8]*S_inv[5][4]) + (-X[8] + Z[5])*(P[11][0]*S_inv[0][5] + P[11][1]*S_inv[1][5] + P[11][2]*S_inv[2][5] + P[11][6]*S_inv[3][5] + P[11][7]*S_inv[4][5] + P[11][8]*S_inv[5][5]);
    X_up[12] = X[12] + (-X[0] + Z[0])*(P[12][0]*S_inv[0][0] + P[12][1]*S_inv[1][0] + P[12][2]*S_inv[2][0] + P[12][6]*S_inv[3][0] + P[12][7]*S_inv[4][0] + P[12][8]*S_inv[5][0]) + (-X[1] + Z[1])*(P[12][0]*S_inv[0][1] + P[12][1]*S_inv[1][1] + P[12][2]*S_inv[2][1] + P[12][6]*S_inv[3][1] + P[12][7]*S_inv[4][1] + P[12][8]*S_inv[5][1]) + (-X[2] + Z[2])*(P[12][0]*S_inv[0][2] + P[12][1]*S_inv[1][2] + P[12][2]*S_inv[2][2] + P[12][6]*S_inv[3][2] + P[12][7]*S_inv[4][2] + P[12][8]*S_inv[5][2]) + (-X[6] + Z[3])*(P[12][0]*S_inv[0][3] + P[12][1]*S_inv[1][3] + P[12][2]*S_inv[2][3] + P[12][6]*S_inv[3][3] + P[12][7]*S_inv[4][3] + P[12][8]*S_inv[5][3]) + (-X[7] + Z[4])*(P[12][0]*S_inv[0][4] + P[12][1]*S_inv[1][4] + P[12][2]*S_inv[2][4] + P[12][6]*S_inv[3][4] + P[12][7]*S_inv[4][4] + P[12][8]*S_inv[5][4]) + (-X[8] + Z[5])*(P[12][0]*S_inv[0][5] + P[12][1]*S_inv[1][5] + P[12][2]*S_inv[2][5] + P[12][6]*S_inv[3][5] + P[12][7]*S_inv[4][5] + P[12][8]*S_inv[5][5]);
    X_up[13] = X[13] + (-X[0] + Z[0])*(P[13][0]*S_inv[0][0] + P[13][1]*S_inv[1][0] + P[13][2]*S_inv[2][0] + P[13][6]*S_inv[3][0] + P[13][7]*S_inv[4][0] + P[13][8]*S_inv[5][0]) + (-X[1] + Z[1])*(P[13][0]*S_inv[0][1] + P[13][1]*S_inv[1][1] + P[13][2]*S_inv[2][1] + P[13][6]*S_inv[3][1] + P[13][7]*S_inv[4][1] + P[13][8]*S_inv[5][1]) + (-X[2] + Z[2])*(P[13][0]*S_inv[0][2] + P[13][1]*S_inv[1][2] + P[13][2]*S_inv[2][2] + P[13][6]*S_inv[3][2] + P[13][7]*S_inv[4][2] + P[13][8]*S_inv[5][2]) + (-X[6] + Z[3])*(P[13][0]*S_inv[0][3] + P[13][1]*S_inv[1][3] + P[13][2]*S_inv[2][3] + P[13][6]*S_inv[3][3] + P[13][7]*S_inv[4][3] + P[13][8]*S_inv[5][3]) + (-X[7] + Z[4])*(P[13][0]*S_inv[0][4] + P[13][1]*S_inv[1][4] + P[13][2]*S_inv[2][4] + P[13][6]*S_inv[3][4] + P[13][7]*S_inv[4][4] + P[13][8]*S_inv[5][4]) + (-X[8] + Z[5])*(P[13][0]*S_inv[0][5] + P[13][1]*S_inv[1][5] + P[13][2]*S_inv[2][5] + P[13][6]*S_inv[3][5] + P[13][7]*S_inv[4][5] + P[13][8]*S_inv[5][5]);
    X_up[14] = X[14] + (-X[0] + Z[0])*(P[14][0]*S_inv[0][0] + P[14][1]*S_inv[1][0] + P[14][2]*S_inv[2][0] + P[14][6]*S_inv[3][0] + P[14][7]*S_inv[4][0] + P[14][8]*S_inv[5][0]) + (-X[1] + Z[1])*(P[14][0]*S_inv[0][1] + P[14][1]*S_inv[1][1] + P[14][2]*S_inv[2][1] + P[14][6]*S_inv[3][1] + P[14][7]*S_inv[4][1] + P[14][8]*S_inv[5][1]) + (-X[2] + Z[2])*(P[14][0]*S_inv[0][2] + P[14][1]*S_inv[1][2] + P[14][2]*S_inv[2][2] + P[14][6]*S_inv[3][2] + P[14][7]*S_inv[4][2] + P[14][8]*S_inv[5][2]) + (-X[6] + Z[3])*(P[14][0]*S_inv[0][3] + P[14][1]*S_inv[1][3] + P[14][2]*S_inv[2][3] + P[14][6]*S_inv[3][3] + P[14][7]*S_inv[4][3] + P[14][8]*S_inv[5][3]) + (-X[7] + Z[4])*(P[14][0]*S_inv[0][4] + P[14][1]*S_inv[1][4] + P[14][2]*S_inv[2][4] + P[14][6]*S_inv[3][4] + P[14][7]*S_inv[4][4] + P[14][8]*S_inv[5][4]) + (-X[8] + Z[5])*(P[14][0]*S_inv[0][5] + P[14][1]*S_inv[1][5] + P[14][2]*S_inv[2][5] + P[14][6]*S_inv[3][5] + P[14][7]*S_inv[4][5] + P[14][8]*S_inv[5][5]);

    // [2] covariance update P_up = (I - K*H)*P 
    float P_up[N_STATES][N_STATES];
    P_up[0][0] = P[0][0]*(-P[0][0]*S_inv[0][0] - P[0][1]*S_inv[1][0] - P[0][2]*S_inv[2][0] - P[0][6]*S_inv[3][0] - P[0][7]*S_inv[4][0] - P[0][8]*S_inv[5][0] + 1) + P[1][0]*(-P[0][0]*S_inv[0][1] - P[0][1]*S_inv[1][1] - P[0][2]*S_inv[2][1] - P[0][6]*S_inv[3][1] - P[0][7]*S_inv[4][1] - P[0][8]*S_inv[5][1]) + P[2][0]*(-P[0][0]*S_inv[0][2] - P[0][1]*S_inv[1][2] - P[0][2]*S_inv[2][2] - P[0][6]*S_inv[3][2] - P[0][7]*S_inv[4][2] - P[0][8]*S_inv[5][2]) + P[6][0]*(-P[0][0]*S_inv[0][3] - P[0][1]*S_inv[1][3] - P[0][2]*S_inv[2][3] - P[0][6]*S_inv[3][3] - P[0][7]*S_inv[4][3] - P[0][8]*S_inv[5][3]) + P[7][0]*(-P[0][0]*S_inv[0][4] - P[0][1]*S_inv[1][4] - P[0][2]*S_inv[2][4] - P[0][6]*S_inv[3][4] - P[0][7]*S_inv[4][4] - P[0][8]*S_inv[5][4]) + P[8][0]*(-P[0][0]*S_inv[0][5] - P[0][1]*S_inv[1][5] - P[0][2]*S_inv[2][5] - P[0][6]*S_inv[3][5] - P[0][7]*S_inv[4][5] - P[0][8]*S_inv[5][5]);
    P_up[0][1] = P[0][1]*(-P[0][0]*S_inv[0][0] - P[0][1]*S_inv[1][0] - P[0][2]*S_inv[2][0] - P[0][6]*S_inv[3][0] - P[0][7]*S_inv[4][0] - P[0][8]*S_inv[5][0] + 1) + P[1][1]*(-P[0][0]*S_inv[0][1] - P[0][1]*S_inv[1][1] - P[0][2]*S_inv[2][1] - P[0][6]*S_inv[3][1] - P[0][7]*S_inv[4][1] - P[0][8]*S_inv[5][1]) + P[2][1]*(-P[0][0]*S_inv[0][2] - P[0][1]*S_inv[1][2] - P[0][2]*S_inv[2][2] - P[0][6]*S_inv[3][2] - P[0][7]*S_inv[4][2] - P[0][8]*S_inv[5][2]) + P[6][1]*(-P[0][0]*S_inv[0][3] - P[0][1]*S_inv[1][3] - P[0][2]*S_inv[2][3] - P[0][6]*S_inv[3][3] - P[0][7]*S_inv[4][3] - P[0][8]*S_inv[5][3]) + P[7][1]*(-P[0][0]*S_inv[0][4] - P[0][1]*S_inv[1][4] - P[0][2]*S_inv[2][4] - P[0][6]*S_inv[3][4] - P[0][7]*S_inv[4][4] - P[0][8]*S_inv[5][4]) + P[8][1]*(-P[0][0]*S_inv[0][5] - P[0][1]*S_inv[1][5] - P[0][2]*S_inv[2][5] - P[0][6]*S_inv[3][5] - P[0][7]*S_inv[4][5] - P[0][8]*S_inv[5][5]);
    P_up[0][2] = P[0][2]*(-P[0][0]*S_inv[0][0] - P[0][1]*S_inv[1][0] - P[0][2]*S_inv[2][0] - P[0][6]*S_inv[3][0] - P[0][7]*S_inv[4][0] - P[0][8]*S_inv[5][0] + 1) + P[1][2]*(-P[0][0]*S_inv[0][1] - P[0][1]*S_inv[1][1] - P[0][2]*S_inv[2][1] - P[0][6]*S_inv[3][1] - P[0][7]*S_inv[4][1] - P[0][8]*S_inv[5][1]) + P[2][2]*(-P[0][0]*S_inv[0][2] - P[0][1]*S_inv[1][2] - P[0][2]*S_inv[2][2] - P[0][6]*S_inv[3][2] - P[0][7]*S_inv[4][2] - P[0][8]*S_inv[5][2]) + P[6][2]*(-P[0][0]*S_inv[0][3] - P[0][1]*S_inv[1][3] - P[0][2]*S_inv[2][3] - P[0][6]*S_inv[3][3] - P[0][7]*S_inv[4][3] - P[0][8]*S_inv[5][3]) + P[7][2]*(-P[0][0]*S_inv[0][4] - P[0][1]*S_inv[1][4] - P[0][2]*S_inv[2][4] - P[0][6]*S_inv[3][4] - P[0][7]*S_inv[4][4] - P[0][8]*S_inv[5][4]) + P[8][2]*(-P[0][0]*S_inv[0][5] - P[0][1]*S_inv[1][5] - P[0][2]*S_inv[2][5] - P[0][6]*S_inv[3][5] - P[0][7]*S_inv[4][5] - P[0][8]*S_inv[5][5]);
    P_up[0][3] = P[0][3]*(-P[0][0]*S_inv[0][0] - P[0][1]*S_inv[1][0] - P[0][2]*S_inv[2][0] - P[0][6]*S_inv[3][0] - P[0][7]*S_inv[4][0] - P[0][8]*S_inv[5][0] + 1) + P[1][3]*(-P[0][0]*S_inv[0][1] - P[0][1]*S_inv[1][1] - P[0][2]*S_inv[2][1] - P[0][6]*S_inv[3][1] - P[0][7]*S_inv[4][1] - P[0][8]*S_inv[5][1]) + P[2][3]*(-P[0][0]*S_inv[0][2] - P[0][1]*S_inv[1][2] - P[0][2]*S_inv[2][2] - P[0][6]*S_inv[3][2] - P[0][7]*S_inv[4][2] - P[0][8]*S_inv[5][2]) + P[6][3]*(-P[0][0]*S_inv[0][3] - P[0][1]*S_inv[1][3] - P[0][2]*S_inv[2][3] - P[0][6]*S_inv[3][3] - P[0][7]*S_inv[4][3] - P[0][8]*S_inv[5][3]) + P[7][3]*(-P[0][0]*S_inv[0][4] - P[0][1]*S_inv[1][4] - P[0][2]*S_inv[2][4] - P[0][6]*S_inv[3][4] - P[0][7]*S_inv[4][4] - P[0][8]*S_inv[5][4]) + P[8][3]*(-P[0][0]*S_inv[0][5] - P[0][1]*S_inv[1][5] - P[0][2]*S_inv[2][5] - P[0][6]*S_inv[3][5] - P[0][7]*S_inv[4][5] - P[0][8]*S_inv[5][5]);
    P_up[0][4] = P[0][4]*(-P[0][0]*S_inv[0][0] - P[0][1]*S_inv[1][0] - P[0][2]*S_inv[2][0] - P[0][6]*S_inv[3][0] - P[0][7]*S_inv[4][0] - P[0][8]*S_inv[5][0] + 1) + P[1][4]*(-P[0][0]*S_inv[0][1] - P[0][1]*S_inv[1][1] - P[0][2]*S_inv[2][1] - P[0][6]*S_inv[3][1] - P[0][7]*S_inv[4][1] - P[0][8]*S_inv[5][1]) + P[2][4]*(-P[0][0]*S_inv[0][2] - P[0][1]*S_inv[1][2] - P[0][2]*S_inv[2][2] - P[0][6]*S_inv[3][2] - P[0][7]*S_inv[4][2] - P[0][8]*S_inv[5][2]) + P[6][4]*(-P[0][0]*S_inv[0][3] - P[0][1]*S_inv[1][3] - P[0][2]*S_inv[2][3] - P[0][6]*S_inv[3][3] - P[0][7]*S_inv[4][3] - P[0][8]*S_inv[5][3]) + P[7][4]*(-P[0][0]*S_inv[0][4] - P[0][1]*S_inv[1][4] - P[0][2]*S_inv[2][4] - P[0][6]*S_inv[3][4] - P[0][7]*S_inv[4][4] - P[0][8]*S_inv[5][4]) + P[8][4]*(-P[0][0]*S_inv[0][5] - P[0][1]*S_inv[1][5] - P[0][2]*S_inv[2][5] - P[0][6]*S_inv[3][5] - P[0][7]*S_inv[4][5] - P[0][8]*S_inv[5][5]);
    P_up[0][5] = P[0][5]*(-P[0][0]*S_inv[0][0] - P[0][1]*S_inv[1][0] - P[0][2]*S_inv[2][0] - P[0][6]*S_inv[3][0] - P[0][7]*S_inv[4][0] - P[0][8]*S_inv[5][0] + 1) + P[1][5]*(-P[0][0]*S_inv[0][1] - P[0][1]*S_inv[1][1] - P[0][2]*S_inv[2][1] - P[0][6]*S_inv[3][1] - P[0][7]*S_inv[4][1] - P[0][8]*S_inv[5][1]) + P[2][5]*(-P[0][0]*S_inv[0][2] - P[0][1]*S_inv[1][2] - P[0][2]*S_inv[2][2] - P[0][6]*S_inv[3][2] - P[0][7]*S_inv[4][2] - P[0][8]*S_inv[5][2]) + P[6][5]*(-P[0][0]*S_inv[0][3] - P[0][1]*S_inv[1][3] - P[0][2]*S_inv[2][3] - P[0][6]*S_inv[3][3] - P[0][7]*S_inv[4][3] - P[0][8]*S_inv[5][3]) + P[7][5]*(-P[0][0]*S_inv[0][4] - P[0][1]*S_inv[1][4] - P[0][2]*S_inv[2][4] - P[0][6]*S_inv[3][4] - P[0][7]*S_inv[4][4] - P[0][8]*S_inv[5][4]) + P[8][5]*(-P[0][0]*S_inv[0][5] - P[0][1]*S_inv[1][5] - P[0][2]*S_inv[2][5] - P[0][6]*S_inv[3][5] - P[0][7]*S_inv[4][5] - P[0][8]*S_inv[5][5]);
    P_up[0][6] = P[0][6]*(-P[0][0]*S_inv[0][0] - P[0][1]*S_inv[1][0] - P[0][2]*S_inv[2][0] - P[0][6]*S_inv[3][0] - P[0][7]*S_inv[4][0] - P[0][8]*S_inv[5][0] + 1) + P[1][6]*(-P[0][0]*S_inv[0][1] - P[0][1]*S_inv[1][1] - P[0][2]*S_inv[2][1] - P[0][6]*S_inv[3][1] - P[0][7]*S_inv[4][1] - P[0][8]*S_inv[5][1]) + P[2][6]*(-P[0][0]*S_inv[0][2] - P[0][1]*S_inv[1][2] - P[0][2]*S_inv[2][2] - P[0][6]*S_inv[3][2] - P[0][7]*S_inv[4][2] - P[0][8]*S_inv[5][2]) + P[6][6]*(-P[0][0]*S_inv[0][3] - P[0][1]*S_inv[1][3] - P[0][2]*S_inv[2][3] - P[0][6]*S_inv[3][3] - P[0][7]*S_inv[4][3] - P[0][8]*S_inv[5][3]) + P[7][6]*(-P[0][0]*S_inv[0][4] - P[0][1]*S_inv[1][4] - P[0][2]*S_inv[2][4] - P[0][6]*S_inv[3][4] - P[0][7]*S_inv[4][4] - P[0][8]*S_inv[5][4]) + P[8][6]*(-P[0][0]*S_inv[0][5] - P[0][1]*S_inv[1][5] - P[0][2]*S_inv[2][5] - P[0][6]*S_inv[3][5] - P[0][7]*S_inv[4][5] - P[0][8]*S_inv[5][5]);
    P_up[0][7] = P[0][7]*(-P[0][0]*S_inv[0][0] - P[0][1]*S_inv[1][0] - P[0][2]*S_inv[2][0] - P[0][6]*S_inv[3][0] - P[0][7]*S_inv[4][0] - P[0][8]*S_inv[5][0] + 1) + P[1][7]*(-P[0][0]*S_inv[0][1] - P[0][1]*S_inv[1][1] - P[0][2]*S_inv[2][1] - P[0][6]*S_inv[3][1] - P[0][7]*S_inv[4][1] - P[0][8]*S_inv[5][1]) + P[2][7]*(-P[0][0]*S_inv[0][2] - P[0][1]*S_inv[1][2] - P[0][2]*S_inv[2][2] - P[0][6]*S_inv[3][2] - P[0][7]*S_inv[4][2] - P[0][8]*S_inv[5][2]) + P[6][7]*(-P[0][0]*S_inv[0][3] - P[0][1]*S_inv[1][3] - P[0][2]*S_inv[2][3] - P[0][6]*S_inv[3][3] - P[0][7]*S_inv[4][3] - P[0][8]*S_inv[5][3]) + P[7][7]*(-P[0][0]*S_inv[0][4] - P[0][1]*S_inv[1][4] - P[0][2]*S_inv[2][4] - P[0][6]*S_inv[3][4] - P[0][7]*S_inv[4][4] - P[0][8]*S_inv[5][4]) + P[8][7]*(-P[0][0]*S_inv[0][5] - P[0][1]*S_inv[1][5] - P[0][2]*S_inv[2][5] - P[0][6]*S_inv[3][5] - P[0][7]*S_inv[4][5] - P[0][8]*S_inv[5][5]);
    P_up[0][8] = P[0][8]*(-P[0][0]*S_inv[0][0] - P[0][1]*S_inv[1][0] - P[0][2]*S_inv[2][0] - P[0][6]*S_inv[3][0] - P[0][7]*S_inv[4][0] - P[0][8]*S_inv[5][0] + 1) + P[1][8]*(-P[0][0]*S_inv[0][1] - P[0][1]*S_inv[1][1] - P[0][2]*S_inv[2][1] - P[0][6]*S_inv[3][1] - P[0][7]*S_inv[4][1] - P[0][8]*S_inv[5][1]) + P[2][8]*(-P[0][0]*S_inv[0][2] - P[0][1]*S_inv[1][2] - P[0][2]*S_inv[2][2] - P[0][6]*S_inv[3][2] - P[0][7]*S_inv[4][2] - P[0][8]*S_inv[5][2]) + P[6][8]*(-P[0][0]*S_inv[0][3] - P[0][1]*S_inv[1][3] - P[0][2]*S_inv[2][3] - P[0][6]*S_inv[3][3] - P[0][7]*S_inv[4][3] - P[0][8]*S_inv[5][3]) + P[7][8]*(-P[0][0]*S_inv[0][4] - P[0][1]*S_inv[1][4] - P[0][2]*S_inv[2][4] - P[0][6]*S_inv[3][4] - P[0][7]*S_inv[4][4] - P[0][8]*S_inv[5][4]) + P[8][8]*(-P[0][0]*S_inv[0][5] - P[0][1]*S_inv[1][5] - P[0][2]*S_inv[2][5] - P[0][6]*S_inv[3][5] - P[0][7]*S_inv[4][5] - P[0][8]*S_inv[5][5]);
    P_up[0][9] = P[0][9]*(-P[0][0]*S_inv[0][0] - P[0][1]*S_inv[1][0] - P[0][2]*S_inv[2][0] - P[0][6]*S_inv[3][0] - P[0][7]*S_inv[4][0] - P[0][8]*S_inv[5][0] + 1) + P[1][9]*(-P[0][0]*S_inv[0][1] - P[0][1]*S_inv[1][1] - P[0][2]*S_inv[2][1] - P[0][6]*S_inv[3][1] - P[0][7]*S_inv[4][1] - P[0][8]*S_inv[5][1]) + P[2][9]*(-P[0][0]*S_inv[0][2] - P[0][1]*S_inv[1][2] - P[0][2]*S_inv[2][2] - P[0][6]*S_inv[3][2] - P[0][7]*S_inv[4][2] - P[0][8]*S_inv[5][2]) + P[6][9]*(-P[0][0]*S_inv[0][3] - P[0][1]*S_inv[1][3] - P[0][2]*S_inv[2][3] - P[0][6]*S_inv[3][3] - P[0][7]*S_inv[4][3] - P[0][8]*S_inv[5][3]) + P[7][9]*(-P[0][0]*S_inv[0][4] - P[0][1]*S_inv[1][4] - P[0][2]*S_inv[2][4] - P[0][6]*S_inv[3][4] - P[0][7]*S_inv[4][4] - P[0][8]*S_inv[5][4]) + P[8][9]*(-P[0][0]*S_inv[0][5] - P[0][1]*S_inv[1][5] - P[0][2]*S_inv[2][5] - P[0][6]*S_inv[3][5] - P[0][7]*S_inv[4][5] - P[0][8]*S_inv[5][5]);
    P_up[0][10] = P[0][10]*(-P[0][0]*S_inv[0][0] - P[0][1]*S_inv[1][0] - P[0][2]*S_inv[2][0] - P[0][6]*S_inv[3][0] - P[0][7]*S_inv[4][0] - P[0][8]*S_inv[5][0] + 1) + P[1][10]*(-P[0][0]*S_inv[0][1] - P[0][1]*S_inv[1][1] - P[0][2]*S_inv[2][1] - P[0][6]*S_inv[3][1] - P[0][7]*S_inv[4][1] - P[0][8]*S_inv[5][1]) + P[2][10]*(-P[0][0]*S_inv[0][2] - P[0][1]*S_inv[1][2] - P[0][2]*S_inv[2][2] - P[0][6]*S_inv[3][2] - P[0][7]*S_inv[4][2] - P[0][8]*S_inv[5][2]) + P[6][10]*(-P[0][0]*S_inv[0][3] - P[0][1]*S_inv[1][3] - P[0][2]*S_inv[2][3] - P[0][6]*S_inv[3][3] - P[0][7]*S_inv[4][3] - P[0][8]*S_inv[5][3]) + P[7][10]*(-P[0][0]*S_inv[0][4] - P[0][1]*S_inv[1][4] - P[0][2]*S_inv[2][4] - P[0][6]*S_inv[3][4] - P[0][7]*S_inv[4][4] - P[0][8]*S_inv[5][4]) + P[8][10]*(-P[0][0]*S_inv[0][5] - P[0][1]*S_inv[1][5] - P[0][2]*S_inv[2][5] - P[0][6]*S_inv[3][5] - P[0][7]*S_inv[4][5] - P[0][8]*S_inv[5][5]);
    P_up[0][11] = P[0][11]*(-P[0][0]*S_inv[0][0] - P[0][1]*S_inv[1][0] - P[0][2]*S_inv[2][0] - P[0][6]*S_inv[3][0] - P[0][7]*S_inv[4][0] - P[0][8]*S_inv[5][0] + 1) + P[1][11]*(-P[0][0]*S_inv[0][1] - P[0][1]*S_inv[1][1] - P[0][2]*S_inv[2][1] - P[0][6]*S_inv[3][1] - P[0][7]*S_inv[4][1] - P[0][8]*S_inv[5][1]) + P[2][11]*(-P[0][0]*S_inv[0][2] - P[0][1]*S_inv[1][2] - P[0][2]*S_inv[2][2] - P[0][6]*S_inv[3][2] - P[0][7]*S_inv[4][2] - P[0][8]*S_inv[5][2]) + P[6][11]*(-P[0][0]*S_inv[0][3] - P[0][1]*S_inv[1][3] - P[0][2]*S_inv[2][3] - P[0][6]*S_inv[3][3] - P[0][7]*S_inv[4][3] - P[0][8]*S_inv[5][3]) + P[7][11]*(-P[0][0]*S_inv[0][4] - P[0][1]*S_inv[1][4] - P[0][2]*S_inv[2][4] - P[0][6]*S_inv[3][4] - P[0][7]*S_inv[4][4] - P[0][8]*S_inv[5][4]) + P[8][11]*(-P[0][0]*S_inv[0][5] - P[0][1]*S_inv[1][5] - P[0][2]*S_inv[2][5] - P[0][6]*S_inv[3][5] - P[0][7]*S_inv[4][5] - P[0][8]*S_inv[5][5]);
    P_up[0][12] = P[0][12]*(-P[0][0]*S_inv[0][0] - P[0][1]*S_inv[1][0] - P[0][2]*S_inv[2][0] - P[0][6]*S_inv[3][0] - P[0][7]*S_inv[4][0] - P[0][8]*S_inv[5][0] + 1) + P[1][12]*(-P[0][0]*S_inv[0][1] - P[0][1]*S_inv[1][1] - P[0][2]*S_inv[2][1] - P[0][6]*S_inv[3][1] - P[0][7]*S_inv[4][1] - P[0][8]*S_inv[5][1]) + P[2][12]*(-P[0][0]*S_inv[0][2] - P[0][1]*S_inv[1][2] - P[0][2]*S_inv[2][2] - P[0][6]*S_inv[3][2] - P[0][7]*S_inv[4][2] - P[0][8]*S_inv[5][2]) + P[6][12]*(-P[0][0]*S_inv[0][3] - P[0][1]*S_inv[1][3] - P[0][2]*S_inv[2][3] - P[0][6]*S_inv[3][3] - P[0][7]*S_inv[4][3] - P[0][8]*S_inv[5][3]) + P[7][12]*(-P[0][0]*S_inv[0][4] - P[0][1]*S_inv[1][4] - P[0][2]*S_inv[2][4] - P[0][6]*S_inv[3][4] - P[0][7]*S_inv[4][4] - P[0][8]*S_inv[5][4]) + P[8][12]*(-P[0][0]*S_inv[0][5] - P[0][1]*S_inv[1][5] - P[0][2]*S_inv[2][5] - P[0][6]*S_inv[3][5] - P[0][7]*S_inv[4][5] - P[0][8]*S_inv[5][5]);
    P_up[0][13] = P[0][13]*(-P[0][0]*S_inv[0][0] - P[0][1]*S_inv[1][0] - P[0][2]*S_inv[2][0] - P[0][6]*S_inv[3][0] - P[0][7]*S_inv[4][0] - P[0][8]*S_inv[5][0] + 1) + P[1][13]*(-P[0][0]*S_inv[0][1] - P[0][1]*S_inv[1][1] - P[0][2]*S_inv[2][1] - P[0][6]*S_inv[3][1] - P[0][7]*S_inv[4][1] - P[0][8]*S_inv[5][1]) + P[2][13]*(-P[0][0]*S_inv[0][2] - P[0][1]*S_inv[1][2] - P[0][2]*S_inv[2][2] - P[0][6]*S_inv[3][2] - P[0][7]*S_inv[4][2] - P[0][8]*S_inv[5][2]) + P[6][13]*(-P[0][0]*S_inv[0][3] - P[0][1]*S_inv[1][3] - P[0][2]*S_inv[2][3] - P[0][6]*S_inv[3][3] - P[0][7]*S_inv[4][3] - P[0][8]*S_inv[5][3]) + P[7][13]*(-P[0][0]*S_inv[0][4] - P[0][1]*S_inv[1][4] - P[0][2]*S_inv[2][4] - P[0][6]*S_inv[3][4] - P[0][7]*S_inv[4][4] - P[0][8]*S_inv[5][4]) + P[8][13]*(-P[0][0]*S_inv[0][5] - P[0][1]*S_inv[1][5] - P[0][2]*S_inv[2][5] - P[0][6]*S_inv[3][5] - P[0][7]*S_inv[4][5] - P[0][8]*S_inv[5][5]);
    P_up[0][14] = P[0][14]*(-P[0][0]*S_inv[0][0] - P[0][1]*S_inv[1][0] - P[0][2]*S_inv[2][0] - P[0][6]*S_inv[3][0] - P[0][7]*S_inv[4][0] - P[0][8]*S_inv[5][0] + 1) + P[1][14]*(-P[0][0]*S_inv[0][1] - P[0][1]*S_inv[1][1] - P[0][2]*S_inv[2][1] - P[0][6]*S_inv[3][1] - P[0][7]*S_inv[4][1] - P[0][8]*S_inv[5][1]) + P[2][14]*(-P[0][0]*S_inv[0][2] - P[0][1]*S_inv[1][2] - P[0][2]*S_inv[2][2] - P[0][6]*S_inv[3][2] - P[0][7]*S_inv[4][2] - P[0][8]*S_inv[5][2]) + P[6][14]*(-P[0][0]*S_inv[0][3] - P[0][1]*S_inv[1][3] - P[0][2]*S_inv[2][3] - P[0][6]*S_inv[3][3] - P[0][7]*S_inv[4][3] - P[0][8]*S_inv[5][3]) + P[7][14]*(-P[0][0]*S_inv[0][4] - P[0][1]*S_inv[1][4] - P[0][2]*S_inv[2][4] - P[0][6]*S_inv[3][4] - P[0][7]*S_inv[4][4] - P[0][8]*S_inv[5][4]) + P[8][14]*(-P[0][0]*S_inv[0][5] - P[0][1]*S_inv[1][5] - P[0][2]*S_inv[2][5] - P[0][6]*S_inv[3][5] - P[0][7]*S_inv[4][5] - P[0][8]*S_inv[5][5]);
    P_up[1][0] = P[0][0]*(-P[1][0]*S_inv[0][0] - P[1][1]*S_inv[1][0] - P[1][2]*S_inv[2][0] - P[1][6]*S_inv[3][0] - P[1][7]*S_inv[4][0] - P[1][8]*S_inv[5][0]) + P[1][0]*(-P[1][0]*S_inv[0][1] - P[1][1]*S_inv[1][1] - P[1][2]*S_inv[2][1] - P[1][6]*S_inv[3][1] - P[1][7]*S_inv[4][1] - P[1][8]*S_inv[5][1] + 1) + P[2][0]*(-P[1][0]*S_inv[0][2] - P[1][1]*S_inv[1][2] - P[1][2]*S_inv[2][2] - P[1][6]*S_inv[3][2] - P[1][7]*S_inv[4][2] - P[1][8]*S_inv[5][2]) + P[6][0]*(-P[1][0]*S_inv[0][3] - P[1][1]*S_inv[1][3] - P[1][2]*S_inv[2][3] - P[1][6]*S_inv[3][3] - P[1][7]*S_inv[4][3] - P[1][8]*S_inv[5][3]) + P[7][0]*(-P[1][0]*S_inv[0][4] - P[1][1]*S_inv[1][4] - P[1][2]*S_inv[2][4] - P[1][6]*S_inv[3][4] - P[1][7]*S_inv[4][4] - P[1][8]*S_inv[5][4]) + P[8][0]*(-P[1][0]*S_inv[0][5] - P[1][1]*S_inv[1][5] - P[1][2]*S_inv[2][5] - P[1][6]*S_inv[3][5] - P[1][7]*S_inv[4][5] - P[1][8]*S_inv[5][5]);
    P_up[1][1] = P[0][1]*(-P[1][0]*S_inv[0][0] - P[1][1]*S_inv[1][0] - P[1][2]*S_inv[2][0] - P[1][6]*S_inv[3][0] - P[1][7]*S_inv[4][0] - P[1][8]*S_inv[5][0]) + P[1][1]*(-P[1][0]*S_inv[0][1] - P[1][1]*S_inv[1][1] - P[1][2]*S_inv[2][1] - P[1][6]*S_inv[3][1] - P[1][7]*S_inv[4][1] - P[1][8]*S_inv[5][1] + 1) + P[2][1]*(-P[1][0]*S_inv[0][2] - P[1][1]*S_inv[1][2] - P[1][2]*S_inv[2][2] - P[1][6]*S_inv[3][2] - P[1][7]*S_inv[4][2] - P[1][8]*S_inv[5][2]) + P[6][1]*(-P[1][0]*S_inv[0][3] - P[1][1]*S_inv[1][3] - P[1][2]*S_inv[2][3] - P[1][6]*S_inv[3][3] - P[1][7]*S_inv[4][3] - P[1][8]*S_inv[5][3]) + P[7][1]*(-P[1][0]*S_inv[0][4] - P[1][1]*S_inv[1][4] - P[1][2]*S_inv[2][4] - P[1][6]*S_inv[3][4] - P[1][7]*S_inv[4][4] - P[1][8]*S_inv[5][4]) + P[8][1]*(-P[1][0]*S_inv[0][5] - P[1][1]*S_inv[1][5] - P[1][2]*S_inv[2][5] - P[1][6]*S_inv[3][5] - P[1][7]*S_inv[4][5] - P[1][8]*S_inv[5][5]);
    P_up[1][2] = P[0][2]*(-P[1][0]*S_inv[0][0] - P[1][1]*S_inv[1][0] - P[1][2]*S_inv[2][0] - P[1][6]*S_inv[3][0] - P[1][7]*S_inv[4][0] - P[1][8]*S_inv[5][0]) + P[1][2]*(-P[1][0]*S_inv[0][1] - P[1][1]*S_inv[1][1] - P[1][2]*S_inv[2][1] - P[1][6]*S_inv[3][1] - P[1][7]*S_inv[4][1] - P[1][8]*S_inv[5][1] + 1) + P[2][2]*(-P[1][0]*S_inv[0][2] - P[1][1]*S_inv[1][2] - P[1][2]*S_inv[2][2] - P[1][6]*S_inv[3][2] - P[1][7]*S_inv[4][2] - P[1][8]*S_inv[5][2]) + P[6][2]*(-P[1][0]*S_inv[0][3] - P[1][1]*S_inv[1][3] - P[1][2]*S_inv[2][3] - P[1][6]*S_inv[3][3] - P[1][7]*S_inv[4][3] - P[1][8]*S_inv[5][3]) + P[7][2]*(-P[1][0]*S_inv[0][4] - P[1][1]*S_inv[1][4] - P[1][2]*S_inv[2][4] - P[1][6]*S_inv[3][4] - P[1][7]*S_inv[4][4] - P[1][8]*S_inv[5][4]) + P[8][2]*(-P[1][0]*S_inv[0][5] - P[1][1]*S_inv[1][5] - P[1][2]*S_inv[2][5] - P[1][6]*S_inv[3][5] - P[1][7]*S_inv[4][5] - P[1][8]*S_inv[5][5]);
    P_up[1][3] = P[0][3]*(-P[1][0]*S_inv[0][0] - P[1][1]*S_inv[1][0] - P[1][2]*S_inv[2][0] - P[1][6]*S_inv[3][0] - P[1][7]*S_inv[4][0] - P[1][8]*S_inv[5][0]) + P[1][3]*(-P[1][0]*S_inv[0][1] - P[1][1]*S_inv[1][1] - P[1][2]*S_inv[2][1] - P[1][6]*S_inv[3][1] - P[1][7]*S_inv[4][1] - P[1][8]*S_inv[5][1] + 1) + P[2][3]*(-P[1][0]*S_inv[0][2] - P[1][1]*S_inv[1][2] - P[1][2]*S_inv[2][2] - P[1][6]*S_inv[3][2] - P[1][7]*S_inv[4][2] - P[1][8]*S_inv[5][2]) + P[6][3]*(-P[1][0]*S_inv[0][3] - P[1][1]*S_inv[1][3] - P[1][2]*S_inv[2][3] - P[1][6]*S_inv[3][3] - P[1][7]*S_inv[4][3] - P[1][8]*S_inv[5][3]) + P[7][3]*(-P[1][0]*S_inv[0][4] - P[1][1]*S_inv[1][4] - P[1][2]*S_inv[2][4] - P[1][6]*S_inv[3][4] - P[1][7]*S_inv[4][4] - P[1][8]*S_inv[5][4]) + P[8][3]*(-P[1][0]*S_inv[0][5] - P[1][1]*S_inv[1][5] - P[1][2]*S_inv[2][5] - P[1][6]*S_inv[3][5] - P[1][7]*S_inv[4][5] - P[1][8]*S_inv[5][5]);
    P_up[1][4] = P[0][4]*(-P[1][0]*S_inv[0][0] - P[1][1]*S_inv[1][0] - P[1][2]*S_inv[2][0] - P[1][6]*S_inv[3][0] - P[1][7]*S_inv[4][0] - P[1][8]*S_inv[5][0]) + P[1][4]*(-P[1][0]*S_inv[0][1] - P[1][1]*S_inv[1][1] - P[1][2]*S_inv[2][1] - P[1][6]*S_inv[3][1] - P[1][7]*S_inv[4][1] - P[1][8]*S_inv[5][1] + 1) + P[2][4]*(-P[1][0]*S_inv[0][2] - P[1][1]*S_inv[1][2] - P[1][2]*S_inv[2][2] - P[1][6]*S_inv[3][2] - P[1][7]*S_inv[4][2] - P[1][8]*S_inv[5][2]) + P[6][4]*(-P[1][0]*S_inv[0][3] - P[1][1]*S_inv[1][3] - P[1][2]*S_inv[2][3] - P[1][6]*S_inv[3][3] - P[1][7]*S_inv[4][3] - P[1][8]*S_inv[5][3]) + P[7][4]*(-P[1][0]*S_inv[0][4] - P[1][1]*S_inv[1][4] - P[1][2]*S_inv[2][4] - P[1][6]*S_inv[3][4] - P[1][7]*S_inv[4][4] - P[1][8]*S_inv[5][4]) + P[8][4]*(-P[1][0]*S_inv[0][5] - P[1][1]*S_inv[1][5] - P[1][2]*S_inv[2][5] - P[1][6]*S_inv[3][5] - P[1][7]*S_inv[4][5] - P[1][8]*S_inv[5][5]);
    P_up[1][5] = P[0][5]*(-P[1][0]*S_inv[0][0] - P[1][1]*S_inv[1][0] - P[1][2]*S_inv[2][0] - P[1][6]*S_inv[3][0] - P[1][7]*S_inv[4][0] - P[1][8]*S_inv[5][0]) + P[1][5]*(-P[1][0]*S_inv[0][1] - P[1][1]*S_inv[1][1] - P[1][2]*S_inv[2][1] - P[1][6]*S_inv[3][1] - P[1][7]*S_inv[4][1] - P[1][8]*S_inv[5][1] + 1) + P[2][5]*(-P[1][0]*S_inv[0][2] - P[1][1]*S_inv[1][2] - P[1][2]*S_inv[2][2] - P[1][6]*S_inv[3][2] - P[1][7]*S_inv[4][2] - P[1][8]*S_inv[5][2]) + P[6][5]*(-P[1][0]*S_inv[0][3] - P[1][1]*S_inv[1][3] - P[1][2]*S_inv[2][3] - P[1][6]*S_inv[3][3] - P[1][7]*S_inv[4][3] - P[1][8]*S_inv[5][3]) + P[7][5]*(-P[1][0]*S_inv[0][4] - P[1][1]*S_inv[1][4] - P[1][2]*S_inv[2][4] - P[1][6]*S_inv[3][4] - P[1][7]*S_inv[4][4] - P[1][8]*S_inv[5][4]) + P[8][5]*(-P[1][0]*S_inv[0][5] - P[1][1]*S_inv[1][5] - P[1][2]*S_inv[2][5] - P[1][6]*S_inv[3][5] - P[1][7]*S_inv[4][5] - P[1][8]*S_inv[5][5]);
    P_up[1][6] = P[0][6]*(-P[1][0]*S_inv[0][0] - P[1][1]*S_inv[1][0] - P[1][2]*S_inv[2][0] - P[1][6]*S_inv[3][0] - P[1][7]*S_inv[4][0] - P[1][8]*S_inv[5][0]) + P[1][6]*(-P[1][0]*S_inv[0][1] - P[1][1]*S_inv[1][1] - P[1][2]*S_inv[2][1] - P[1][6]*S_inv[3][1] - P[1][7]*S_inv[4][1] - P[1][8]*S_inv[5][1] + 1) + P[2][6]*(-P[1][0]*S_inv[0][2] - P[1][1]*S_inv[1][2] - P[1][2]*S_inv[2][2] - P[1][6]*S_inv[3][2] - P[1][7]*S_inv[4][2] - P[1][8]*S_inv[5][2]) + P[6][6]*(-P[1][0]*S_inv[0][3] - P[1][1]*S_inv[1][3] - P[1][2]*S_inv[2][3] - P[1][6]*S_inv[3][3] - P[1][7]*S_inv[4][3] - P[1][8]*S_inv[5][3]) + P[7][6]*(-P[1][0]*S_inv[0][4] - P[1][1]*S_inv[1][4] - P[1][2]*S_inv[2][4] - P[1][6]*S_inv[3][4] - P[1][7]*S_inv[4][4] - P[1][8]*S_inv[5][4]) + P[8][6]*(-P[1][0]*S_inv[0][5] - P[1][1]*S_inv[1][5] - P[1][2]*S_inv[2][5] - P[1][6]*S_inv[3][5] - P[1][7]*S_inv[4][5] - P[1][8]*S_inv[5][5]);
    P_up[1][7] = P[0][7]*(-P[1][0]*S_inv[0][0] - P[1][1]*S_inv[1][0] - P[1][2]*S_inv[2][0] - P[1][6]*S_inv[3][0] - P[1][7]*S_inv[4][0] - P[1][8]*S_inv[5][0]) + P[1][7]*(-P[1][0]*S_inv[0][1] - P[1][1]*S_inv[1][1] - P[1][2]*S_inv[2][1] - P[1][6]*S_inv[3][1] - P[1][7]*S_inv[4][1] - P[1][8]*S_inv[5][1] + 1) + P[2][7]*(-P[1][0]*S_inv[0][2] - P[1][1]*S_inv[1][2] - P[1][2]*S_inv[2][2] - P[1][6]*S_inv[3][2] - P[1][7]*S_inv[4][2] - P[1][8]*S_inv[5][2]) + P[6][7]*(-P[1][0]*S_inv[0][3] - P[1][1]*S_inv[1][3] - P[1][2]*S_inv[2][3] - P[1][6]*S_inv[3][3] - P[1][7]*S_inv[4][3] - P[1][8]*S_inv[5][3]) + P[7][7]*(-P[1][0]*S_inv[0][4] - P[1][1]*S_inv[1][4] - P[1][2]*S_inv[2][4] - P[1][6]*S_inv[3][4] - P[1][7]*S_inv[4][4] - P[1][8]*S_inv[5][4]) + P[8][7]*(-P[1][0]*S_inv[0][5] - P[1][1]*S_inv[1][5] - P[1][2]*S_inv[2][5] - P[1][6]*S_inv[3][5] - P[1][7]*S_inv[4][5] - P[1][8]*S_inv[5][5]);
    P_up[1][8] = P[0][8]*(-P[1][0]*S_inv[0][0] - P[1][1]*S_inv[1][0] - P[1][2]*S_inv[2][0] - P[1][6]*S_inv[3][0] - P[1][7]*S_inv[4][0] - P[1][8]*S_inv[5][0]) + P[1][8]*(-P[1][0]*S_inv[0][1] - P[1][1]*S_inv[1][1] - P[1][2]*S_inv[2][1] - P[1][6]*S_inv[3][1] - P[1][7]*S_inv[4][1] - P[1][8]*S_inv[5][1] + 1) + P[2][8]*(-P[1][0]*S_inv[0][2] - P[1][1]*S_inv[1][2] - P[1][2]*S_inv[2][2] - P[1][6]*S_inv[3][2] - P[1][7]*S_inv[4][2] - P[1][8]*S_inv[5][2]) + P[6][8]*(-P[1][0]*S_inv[0][3] - P[1][1]*S_inv[1][3] - P[1][2]*S_inv[2][3] - P[1][6]*S_inv[3][3] - P[1][7]*S_inv[4][3] - P[1][8]*S_inv[5][3]) + P[7][8]*(-P[1][0]*S_inv[0][4] - P[1][1]*S_inv[1][4] - P[1][2]*S_inv[2][4] - P[1][6]*S_inv[3][4] - P[1][7]*S_inv[4][4] - P[1][8]*S_inv[5][4]) + P[8][8]*(-P[1][0]*S_inv[0][5] - P[1][1]*S_inv[1][5] - P[1][2]*S_inv[2][5] - P[1][6]*S_inv[3][5] - P[1][7]*S_inv[4][5] - P[1][8]*S_inv[5][5]);
    P_up[1][9] = P[0][9]*(-P[1][0]*S_inv[0][0] - P[1][1]*S_inv[1][0] - P[1][2]*S_inv[2][0] - P[1][6]*S_inv[3][0] - P[1][7]*S_inv[4][0] - P[1][8]*S_inv[5][0]) + P[1][9]*(-P[1][0]*S_inv[0][1] - P[1][1]*S_inv[1][1] - P[1][2]*S_inv[2][1] - P[1][6]*S_inv[3][1] - P[1][7]*S_inv[4][1] - P[1][8]*S_inv[5][1] + 1) + P[2][9]*(-P[1][0]*S_inv[0][2] - P[1][1]*S_inv[1][2] - P[1][2]*S_inv[2][2] - P[1][6]*S_inv[3][2] - P[1][7]*S_inv[4][2] - P[1][8]*S_inv[5][2]) + P[6][9]*(-P[1][0]*S_inv[0][3] - P[1][1]*S_inv[1][3] - P[1][2]*S_inv[2][3] - P[1][6]*S_inv[3][3] - P[1][7]*S_inv[4][3] - P[1][8]*S_inv[5][3]) + P[7][9]*(-P[1][0]*S_inv[0][4] - P[1][1]*S_inv[1][4] - P[1][2]*S_inv[2][4] - P[1][6]*S_inv[3][4] - P[1][7]*S_inv[4][4] - P[1][8]*S_inv[5][4]) + P[8][9]*(-P[1][0]*S_inv[0][5] - P[1][1]*S_inv[1][5] - P[1][2]*S_inv[2][5] - P[1][6]*S_inv[3][5] - P[1][7]*S_inv[4][5] - P[1][8]*S_inv[5][5]);
    P_up[1][10] = P[0][10]*(-P[1][0]*S_inv[0][0] - P[1][1]*S_inv[1][0] - P[1][2]*S_inv[2][0] - P[1][6]*S_inv[3][0] - P[1][7]*S_inv[4][0] - P[1][8]*S_inv[5][0]) + P[1][10]*(-P[1][0]*S_inv[0][1] - P[1][1]*S_inv[1][1] - P[1][2]*S_inv[2][1] - P[1][6]*S_inv[3][1] - P[1][7]*S_inv[4][1] - P[1][8]*S_inv[5][1] + 1) + P[2][10]*(-P[1][0]*S_inv[0][2] - P[1][1]*S_inv[1][2] - P[1][2]*S_inv[2][2] - P[1][6]*S_inv[3][2] - P[1][7]*S_inv[4][2] - P[1][8]*S_inv[5][2]) + P[6][10]*(-P[1][0]*S_inv[0][3] - P[1][1]*S_inv[1][3] - P[1][2]*S_inv[2][3] - P[1][6]*S_inv[3][3] - P[1][7]*S_inv[4][3] - P[1][8]*S_inv[5][3]) + P[7][10]*(-P[1][0]*S_inv[0][4] - P[1][1]*S_inv[1][4] - P[1][2]*S_inv[2][4] - P[1][6]*S_inv[3][4] - P[1][7]*S_inv[4][4] - P[1][8]*S_inv[5][4]) + P[8][10]*(-P[1][0]*S_inv[0][5] - P[1][1]*S_inv[1][5] - P[1][2]*S_inv[2][5] - P[1][6]*S_inv[3][5] - P[1][7]*S_inv[4][5] - P[1][8]*S_inv[5][5]);
    P_up[1][11] = P[0][11]*(-P[1][0]*S_inv[0][0] - P[1][1]*S_inv[1][0] - P[1][2]*S_inv[2][0] - P[1][6]*S_inv[3][0] - P[1][7]*S_inv[4][0] - P[1][8]*S_inv[5][0]) + P[1][11]*(-P[1][0]*S_inv[0][1] - P[1][1]*S_inv[1][1] - P[1][2]*S_inv[2][1] - P[1][6]*S_inv[3][1] - P[1][7]*S_inv[4][1] - P[1][8]*S_inv[5][1] + 1) + P[2][11]*(-P[1][0]*S_inv[0][2] - P[1][1]*S_inv[1][2] - P[1][2]*S_inv[2][2] - P[1][6]*S_inv[3][2] - P[1][7]*S_inv[4][2] - P[1][8]*S_inv[5][2]) + P[6][11]*(-P[1][0]*S_inv[0][3] - P[1][1]*S_inv[1][3] - P[1][2]*S_inv[2][3] - P[1][6]*S_inv[3][3] - P[1][7]*S_inv[4][3] - P[1][8]*S_inv[5][3]) + P[7][11]*(-P[1][0]*S_inv[0][4] - P[1][1]*S_inv[1][4] - P[1][2]*S_inv[2][4] - P[1][6]*S_inv[3][4] - P[1][7]*S_inv[4][4] - P[1][8]*S_inv[5][4]) + P[8][11]*(-P[1][0]*S_inv[0][5] - P[1][1]*S_inv[1][5] - P[1][2]*S_inv[2][5] - P[1][6]*S_inv[3][5] - P[1][7]*S_inv[4][5] - P[1][8]*S_inv[5][5]);
    P_up[1][12] = P[0][12]*(-P[1][0]*S_inv[0][0] - P[1][1]*S_inv[1][0] - P[1][2]*S_inv[2][0] - P[1][6]*S_inv[3][0] - P[1][7]*S_inv[4][0] - P[1][8]*S_inv[5][0]) + P[1][12]*(-P[1][0]*S_inv[0][1] - P[1][1]*S_inv[1][1] - P[1][2]*S_inv[2][1] - P[1][6]*S_inv[3][1] - P[1][7]*S_inv[4][1] - P[1][8]*S_inv[5][1] + 1) + P[2][12]*(-P[1][0]*S_inv[0][2] - P[1][1]*S_inv[1][2] - P[1][2]*S_inv[2][2] - P[1][6]*S_inv[3][2] - P[1][7]*S_inv[4][2] - P[1][8]*S_inv[5][2]) + P[6][12]*(-P[1][0]*S_inv[0][3] - P[1][1]*S_inv[1][3] - P[1][2]*S_inv[2][3] - P[1][6]*S_inv[3][3] - P[1][7]*S_inv[4][3] - P[1][8]*S_inv[5][3]) + P[7][12]*(-P[1][0]*S_inv[0][4] - P[1][1]*S_inv[1][4] - P[1][2]*S_inv[2][4] - P[1][6]*S_inv[3][4] - P[1][7]*S_inv[4][4] - P[1][8]*S_inv[5][4]) + P[8][12]*(-P[1][0]*S_inv[0][5] - P[1][1]*S_inv[1][5] - P[1][2]*S_inv[2][5] - P[1][6]*S_inv[3][5] - P[1][7]*S_inv[4][5] - P[1][8]*S_inv[5][5]);
    P_up[1][13] = P[0][13]*(-P[1][0]*S_inv[0][0] - P[1][1]*S_inv[1][0] - P[1][2]*S_inv[2][0] - P[1][6]*S_inv[3][0] - P[1][7]*S_inv[4][0] - P[1][8]*S_inv[5][0]) + P[1][13]*(-P[1][0]*S_inv[0][1] - P[1][1]*S_inv[1][1] - P[1][2]*S_inv[2][1] - P[1][6]*S_inv[3][1] - P[1][7]*S_inv[4][1] - P[1][8]*S_inv[5][1] + 1) + P[2][13]*(-P[1][0]*S_inv[0][2] - P[1][1]*S_inv[1][2] - P[1][2]*S_inv[2][2] - P[1][6]*S_inv[3][2] - P[1][7]*S_inv[4][2] - P[1][8]*S_inv[5][2]) + P[6][13]*(-P[1][0]*S_inv[0][3] - P[1][1]*S_inv[1][3] - P[1][2]*S_inv[2][3] - P[1][6]*S_inv[3][3] - P[1][7]*S_inv[4][3] - P[1][8]*S_inv[5][3]) + P[7][13]*(-P[1][0]*S_inv[0][4] - P[1][1]*S_inv[1][4] - P[1][2]*S_inv[2][4] - P[1][6]*S_inv[3][4] - P[1][7]*S_inv[4][4] - P[1][8]*S_inv[5][4]) + P[8][13]*(-P[1][0]*S_inv[0][5] - P[1][1]*S_inv[1][5] - P[1][2]*S_inv[2][5] - P[1][6]*S_inv[3][5] - P[1][7]*S_inv[4][5] - P[1][8]*S_inv[5][5]);
    P_up[1][14] = P[0][14]*(-P[1][0]*S_inv[0][0] - P[1][1]*S_inv[1][0] - P[1][2]*S_inv[2][0] - P[1][6]*S_inv[3][0] - P[1][7]*S_inv[4][0] - P[1][8]*S_inv[5][0]) + P[1][14]*(-P[1][0]*S_inv[0][1] - P[1][1]*S_inv[1][1] - P[1][2]*S_inv[2][1] - P[1][6]*S_inv[3][1] - P[1][7]*S_inv[4][1] - P[1][8]*S_inv[5][1] + 1) + P[2][14]*(-P[1][0]*S_inv[0][2] - P[1][1]*S_inv[1][2] - P[1][2]*S_inv[2][2] - P[1][6]*S_inv[3][2] - P[1][7]*S_inv[4][2] - P[1][8]*S_inv[5][2]) + P[6][14]*(-P[1][0]*S_inv[0][3] - P[1][1]*S_inv[1][3] - P[1][2]*S_inv[2][3] - P[1][6]*S_inv[3][3] - P[1][7]*S_inv[4][3] - P[1][8]*S_inv[5][3]) + P[7][14]*(-P[1][0]*S_inv[0][4] - P[1][1]*S_inv[1][4] - P[1][2]*S_inv[2][4] - P[1][6]*S_inv[3][4] - P[1][7]*S_inv[4][4] - P[1][8]*S_inv[5][4]) + P[8][14]*(-P[1][0]*S_inv[0][5] - P[1][1]*S_inv[1][5] - P[1][2]*S_inv[2][5] - P[1][6]*S_inv[3][5] - P[1][7]*S_inv[4][5] - P[1][8]*S_inv[5][5]);
    P_up[2][0] = P[0][0]*(-P[2][0]*S_inv[0][0] - P[2][1]*S_inv[1][0] - P[2][2]*S_inv[2][0] - P[2][6]*S_inv[3][0] - P[2][7]*S_inv[4][0] - P[2][8]*S_inv[5][0]) + P[1][0]*(-P[2][0]*S_inv[0][1] - P[2][1]*S_inv[1][1] - P[2][2]*S_inv[2][1] - P[2][6]*S_inv[3][1] - P[2][7]*S_inv[4][1] - P[2][8]*S_inv[5][1]) + P[2][0]*(-P[2][0]*S_inv[0][2] - P[2][1]*S_inv[1][2] - P[2][2]*S_inv[2][2] - P[2][6]*S_inv[3][2] - P[2][7]*S_inv[4][2] - P[2][8]*S_inv[5][2] + 1) + P[6][0]*(-P[2][0]*S_inv[0][3] - P[2][1]*S_inv[1][3] - P[2][2]*S_inv[2][3] - P[2][6]*S_inv[3][3] - P[2][7]*S_inv[4][3] - P[2][8]*S_inv[5][3]) + P[7][0]*(-P[2][0]*S_inv[0][4] - P[2][1]*S_inv[1][4] - P[2][2]*S_inv[2][4] - P[2][6]*S_inv[3][4] - P[2][7]*S_inv[4][4] - P[2][8]*S_inv[5][4]) + P[8][0]*(-P[2][0]*S_inv[0][5] - P[2][1]*S_inv[1][5] - P[2][2]*S_inv[2][5] - P[2][6]*S_inv[3][5] - P[2][7]*S_inv[4][5] - P[2][8]*S_inv[5][5]);
    P_up[2][1] = P[0][1]*(-P[2][0]*S_inv[0][0] - P[2][1]*S_inv[1][0] - P[2][2]*S_inv[2][0] - P[2][6]*S_inv[3][0] - P[2][7]*S_inv[4][0] - P[2][8]*S_inv[5][0]) + P[1][1]*(-P[2][0]*S_inv[0][1] - P[2][1]*S_inv[1][1] - P[2][2]*S_inv[2][1] - P[2][6]*S_inv[3][1] - P[2][7]*S_inv[4][1] - P[2][8]*S_inv[5][1]) + P[2][1]*(-P[2][0]*S_inv[0][2] - P[2][1]*S_inv[1][2] - P[2][2]*S_inv[2][2] - P[2][6]*S_inv[3][2] - P[2][7]*S_inv[4][2] - P[2][8]*S_inv[5][2] + 1) + P[6][1]*(-P[2][0]*S_inv[0][3] - P[2][1]*S_inv[1][3] - P[2][2]*S_inv[2][3] - P[2][6]*S_inv[3][3] - P[2][7]*S_inv[4][3] - P[2][8]*S_inv[5][3]) + P[7][1]*(-P[2][0]*S_inv[0][4] - P[2][1]*S_inv[1][4] - P[2][2]*S_inv[2][4] - P[2][6]*S_inv[3][4] - P[2][7]*S_inv[4][4] - P[2][8]*S_inv[5][4]) + P[8][1]*(-P[2][0]*S_inv[0][5] - P[2][1]*S_inv[1][5] - P[2][2]*S_inv[2][5] - P[2][6]*S_inv[3][5] - P[2][7]*S_inv[4][5] - P[2][8]*S_inv[5][5]);
    P_up[2][2] = P[0][2]*(-P[2][0]*S_inv[0][0] - P[2][1]*S_inv[1][0] - P[2][2]*S_inv[2][0] - P[2][6]*S_inv[3][0] - P[2][7]*S_inv[4][0] - P[2][8]*S_inv[5][0]) + P[1][2]*(-P[2][0]*S_inv[0][1] - P[2][1]*S_inv[1][1] - P[2][2]*S_inv[2][1] - P[2][6]*S_inv[3][1] - P[2][7]*S_inv[4][1] - P[2][8]*S_inv[5][1]) + P[2][2]*(-P[2][0]*S_inv[0][2] - P[2][1]*S_inv[1][2] - P[2][2]*S_inv[2][2] - P[2][6]*S_inv[3][2] - P[2][7]*S_inv[4][2] - P[2][8]*S_inv[5][2] + 1) + P[6][2]*(-P[2][0]*S_inv[0][3] - P[2][1]*S_inv[1][3] - P[2][2]*S_inv[2][3] - P[2][6]*S_inv[3][3] - P[2][7]*S_inv[4][3] - P[2][8]*S_inv[5][3]) + P[7][2]*(-P[2][0]*S_inv[0][4] - P[2][1]*S_inv[1][4] - P[2][2]*S_inv[2][4] - P[2][6]*S_inv[3][4] - P[2][7]*S_inv[4][4] - P[2][8]*S_inv[5][4]) + P[8][2]*(-P[2][0]*S_inv[0][5] - P[2][1]*S_inv[1][5] - P[2][2]*S_inv[2][5] - P[2][6]*S_inv[3][5] - P[2][7]*S_inv[4][5] - P[2][8]*S_inv[5][5]);
    P_up[2][3] = P[0][3]*(-P[2][0]*S_inv[0][0] - P[2][1]*S_inv[1][0] - P[2][2]*S_inv[2][0] - P[2][6]*S_inv[3][0] - P[2][7]*S_inv[4][0] - P[2][8]*S_inv[5][0]) + P[1][3]*(-P[2][0]*S_inv[0][1] - P[2][1]*S_inv[1][1] - P[2][2]*S_inv[2][1] - P[2][6]*S_inv[3][1] - P[2][7]*S_inv[4][1] - P[2][8]*S_inv[5][1]) + P[2][3]*(-P[2][0]*S_inv[0][2] - P[2][1]*S_inv[1][2] - P[2][2]*S_inv[2][2] - P[2][6]*S_inv[3][2] - P[2][7]*S_inv[4][2] - P[2][8]*S_inv[5][2] + 1) + P[6][3]*(-P[2][0]*S_inv[0][3] - P[2][1]*S_inv[1][3] - P[2][2]*S_inv[2][3] - P[2][6]*S_inv[3][3] - P[2][7]*S_inv[4][3] - P[2][8]*S_inv[5][3]) + P[7][3]*(-P[2][0]*S_inv[0][4] - P[2][1]*S_inv[1][4] - P[2][2]*S_inv[2][4] - P[2][6]*S_inv[3][4] - P[2][7]*S_inv[4][4] - P[2][8]*S_inv[5][4]) + P[8][3]*(-P[2][0]*S_inv[0][5] - P[2][1]*S_inv[1][5] - P[2][2]*S_inv[2][5] - P[2][6]*S_inv[3][5] - P[2][7]*S_inv[4][5] - P[2][8]*S_inv[5][5]);
    P_up[2][4] = P[0][4]*(-P[2][0]*S_inv[0][0] - P[2][1]*S_inv[1][0] - P[2][2]*S_inv[2][0] - P[2][6]*S_inv[3][0] - P[2][7]*S_inv[4][0] - P[2][8]*S_inv[5][0]) + P[1][4]*(-P[2][0]*S_inv[0][1] - P[2][1]*S_inv[1][1] - P[2][2]*S_inv[2][1] - P[2][6]*S_inv[3][1] - P[2][7]*S_inv[4][1] - P[2][8]*S_inv[5][1]) + P[2][4]*(-P[2][0]*S_inv[0][2] - P[2][1]*S_inv[1][2] - P[2][2]*S_inv[2][2] - P[2][6]*S_inv[3][2] - P[2][7]*S_inv[4][2] - P[2][8]*S_inv[5][2] + 1) + P[6][4]*(-P[2][0]*S_inv[0][3] - P[2][1]*S_inv[1][3] - P[2][2]*S_inv[2][3] - P[2][6]*S_inv[3][3] - P[2][7]*S_inv[4][3] - P[2][8]*S_inv[5][3]) + P[7][4]*(-P[2][0]*S_inv[0][4] - P[2][1]*S_inv[1][4] - P[2][2]*S_inv[2][4] - P[2][6]*S_inv[3][4] - P[2][7]*S_inv[4][4] - P[2][8]*S_inv[5][4]) + P[8][4]*(-P[2][0]*S_inv[0][5] - P[2][1]*S_inv[1][5] - P[2][2]*S_inv[2][5] - P[2][6]*S_inv[3][5] - P[2][7]*S_inv[4][5] - P[2][8]*S_inv[5][5]);
    P_up[2][5] = P[0][5]*(-P[2][0]*S_inv[0][0] - P[2][1]*S_inv[1][0] - P[2][2]*S_inv[2][0] - P[2][6]*S_inv[3][0] - P[2][7]*S_inv[4][0] - P[2][8]*S_inv[5][0]) + P[1][5]*(-P[2][0]*S_inv[0][1] - P[2][1]*S_inv[1][1] - P[2][2]*S_inv[2][1] - P[2][6]*S_inv[3][1] - P[2][7]*S_inv[4][1] - P[2][8]*S_inv[5][1]) + P[2][5]*(-P[2][0]*S_inv[0][2] - P[2][1]*S_inv[1][2] - P[2][2]*S_inv[2][2] - P[2][6]*S_inv[3][2] - P[2][7]*S_inv[4][2] - P[2][8]*S_inv[5][2] + 1) + P[6][5]*(-P[2][0]*S_inv[0][3] - P[2][1]*S_inv[1][3] - P[2][2]*S_inv[2][3] - P[2][6]*S_inv[3][3] - P[2][7]*S_inv[4][3] - P[2][8]*S_inv[5][3]) + P[7][5]*(-P[2][0]*S_inv[0][4] - P[2][1]*S_inv[1][4] - P[2][2]*S_inv[2][4] - P[2][6]*S_inv[3][4] - P[2][7]*S_inv[4][4] - P[2][8]*S_inv[5][4]) + P[8][5]*(-P[2][0]*S_inv[0][5] - P[2][1]*S_inv[1][5] - P[2][2]*S_inv[2][5] - P[2][6]*S_inv[3][5] - P[2][7]*S_inv[4][5] - P[2][8]*S_inv[5][5]);
    P_up[2][6] = P[0][6]*(-P[2][0]*S_inv[0][0] - P[2][1]*S_inv[1][0] - P[2][2]*S_inv[2][0] - P[2][6]*S_inv[3][0] - P[2][7]*S_inv[4][0] - P[2][8]*S_inv[5][0]) + P[1][6]*(-P[2][0]*S_inv[0][1] - P[2][1]*S_inv[1][1] - P[2][2]*S_inv[2][1] - P[2][6]*S_inv[3][1] - P[2][7]*S_inv[4][1] - P[2][8]*S_inv[5][1]) + P[2][6]*(-P[2][0]*S_inv[0][2] - P[2][1]*S_inv[1][2] - P[2][2]*S_inv[2][2] - P[2][6]*S_inv[3][2] - P[2][7]*S_inv[4][2] - P[2][8]*S_inv[5][2] + 1) + P[6][6]*(-P[2][0]*S_inv[0][3] - P[2][1]*S_inv[1][3] - P[2][2]*S_inv[2][3] - P[2][6]*S_inv[3][3] - P[2][7]*S_inv[4][3] - P[2][8]*S_inv[5][3]) + P[7][6]*(-P[2][0]*S_inv[0][4] - P[2][1]*S_inv[1][4] - P[2][2]*S_inv[2][4] - P[2][6]*S_inv[3][4] - P[2][7]*S_inv[4][4] - P[2][8]*S_inv[5][4]) + P[8][6]*(-P[2][0]*S_inv[0][5] - P[2][1]*S_inv[1][5] - P[2][2]*S_inv[2][5] - P[2][6]*S_inv[3][5] - P[2][7]*S_inv[4][5] - P[2][8]*S_inv[5][5]);
    P_up[2][7] = P[0][7]*(-P[2][0]*S_inv[0][0] - P[2][1]*S_inv[1][0] - P[2][2]*S_inv[2][0] - P[2][6]*S_inv[3][0] - P[2][7]*S_inv[4][0] - P[2][8]*S_inv[5][0]) + P[1][7]*(-P[2][0]*S_inv[0][1] - P[2][1]*S_inv[1][1] - P[2][2]*S_inv[2][1] - P[2][6]*S_inv[3][1] - P[2][7]*S_inv[4][1] - P[2][8]*S_inv[5][1]) + P[2][7]*(-P[2][0]*S_inv[0][2] - P[2][1]*S_inv[1][2] - P[2][2]*S_inv[2][2] - P[2][6]*S_inv[3][2] - P[2][7]*S_inv[4][2] - P[2][8]*S_inv[5][2] + 1) + P[6][7]*(-P[2][0]*S_inv[0][3] - P[2][1]*S_inv[1][3] - P[2][2]*S_inv[2][3] - P[2][6]*S_inv[3][3] - P[2][7]*S_inv[4][3] - P[2][8]*S_inv[5][3]) + P[7][7]*(-P[2][0]*S_inv[0][4] - P[2][1]*S_inv[1][4] - P[2][2]*S_inv[2][4] - P[2][6]*S_inv[3][4] - P[2][7]*S_inv[4][4] - P[2][8]*S_inv[5][4]) + P[8][7]*(-P[2][0]*S_inv[0][5] - P[2][1]*S_inv[1][5] - P[2][2]*S_inv[2][5] - P[2][6]*S_inv[3][5] - P[2][7]*S_inv[4][5] - P[2][8]*S_inv[5][5]);
    P_up[2][8] = P[0][8]*(-P[2][0]*S_inv[0][0] - P[2][1]*S_inv[1][0] - P[2][2]*S_inv[2][0] - P[2][6]*S_inv[3][0] - P[2][7]*S_inv[4][0] - P[2][8]*S_inv[5][0]) + P[1][8]*(-P[2][0]*S_inv[0][1] - P[2][1]*S_inv[1][1] - P[2][2]*S_inv[2][1] - P[2][6]*S_inv[3][1] - P[2][7]*S_inv[4][1] - P[2][8]*S_inv[5][1]) + P[2][8]*(-P[2][0]*S_inv[0][2] - P[2][1]*S_inv[1][2] - P[2][2]*S_inv[2][2] - P[2][6]*S_inv[3][2] - P[2][7]*S_inv[4][2] - P[2][8]*S_inv[5][2] + 1) + P[6][8]*(-P[2][0]*S_inv[0][3] - P[2][1]*S_inv[1][3] - P[2][2]*S_inv[2][3] - P[2][6]*S_inv[3][3] - P[2][7]*S_inv[4][3] - P[2][8]*S_inv[5][3]) + P[7][8]*(-P[2][0]*S_inv[0][4] - P[2][1]*S_inv[1][4] - P[2][2]*S_inv[2][4] - P[2][6]*S_inv[3][4] - P[2][7]*S_inv[4][4] - P[2][8]*S_inv[5][4]) + P[8][8]*(-P[2][0]*S_inv[0][5] - P[2][1]*S_inv[1][5] - P[2][2]*S_inv[2][5] - P[2][6]*S_inv[3][5] - P[2][7]*S_inv[4][5] - P[2][8]*S_inv[5][5]);
    P_up[2][9] = P[0][9]*(-P[2][0]*S_inv[0][0] - P[2][1]*S_inv[1][0] - P[2][2]*S_inv[2][0] - P[2][6]*S_inv[3][0] - P[2][7]*S_inv[4][0] - P[2][8]*S_inv[5][0]) + P[1][9]*(-P[2][0]*S_inv[0][1] - P[2][1]*S_inv[1][1] - P[2][2]*S_inv[2][1] - P[2][6]*S_inv[3][1] - P[2][7]*S_inv[4][1] - P[2][8]*S_inv[5][1]) + P[2][9]*(-P[2][0]*S_inv[0][2] - P[2][1]*S_inv[1][2] - P[2][2]*S_inv[2][2] - P[2][6]*S_inv[3][2] - P[2][7]*S_inv[4][2] - P[2][8]*S_inv[5][2] + 1) + P[6][9]*(-P[2][0]*S_inv[0][3] - P[2][1]*S_inv[1][3] - P[2][2]*S_inv[2][3] - P[2][6]*S_inv[3][3] - P[2][7]*S_inv[4][3] - P[2][8]*S_inv[5][3]) + P[7][9]*(-P[2][0]*S_inv[0][4] - P[2][1]*S_inv[1][4] - P[2][2]*S_inv[2][4] - P[2][6]*S_inv[3][4] - P[2][7]*S_inv[4][4] - P[2][8]*S_inv[5][4]) + P[8][9]*(-P[2][0]*S_inv[0][5] - P[2][1]*S_inv[1][5] - P[2][2]*S_inv[2][5] - P[2][6]*S_inv[3][5] - P[2][7]*S_inv[4][5] - P[2][8]*S_inv[5][5]);
    P_up[2][10] = P[0][10]*(-P[2][0]*S_inv[0][0] - P[2][1]*S_inv[1][0] - P[2][2]*S_inv[2][0] - P[2][6]*S_inv[3][0] - P[2][7]*S_inv[4][0] - P[2][8]*S_inv[5][0]) + P[1][10]*(-P[2][0]*S_inv[0][1] - P[2][1]*S_inv[1][1] - P[2][2]*S_inv[2][1] - P[2][6]*S_inv[3][1] - P[2][7]*S_inv[4][1] - P[2][8]*S_inv[5][1]) + P[2][10]*(-P[2][0]*S_inv[0][2] - P[2][1]*S_inv[1][2] - P[2][2]*S_inv[2][2] - P[2][6]*S_inv[3][2] - P[2][7]*S_inv[4][2] - P[2][8]*S_inv[5][2] + 1) + P[6][10]*(-P[2][0]*S_inv[0][3] - P[2][1]*S_inv[1][3] - P[2][2]*S_inv[2][3] - P[2][6]*S_inv[3][3] - P[2][7]*S_inv[4][3] - P[2][8]*S_inv[5][3]) + P[7][10]*(-P[2][0]*S_inv[0][4] - P[2][1]*S_inv[1][4] - P[2][2]*S_inv[2][4] - P[2][6]*S_inv[3][4] - P[2][7]*S_inv[4][4] - P[2][8]*S_inv[5][4]) + P[8][10]*(-P[2][0]*S_inv[0][5] - P[2][1]*S_inv[1][5] - P[2][2]*S_inv[2][5] - P[2][6]*S_inv[3][5] - P[2][7]*S_inv[4][5] - P[2][8]*S_inv[5][5]);
    P_up[2][11] = P[0][11]*(-P[2][0]*S_inv[0][0] - P[2][1]*S_inv[1][0] - P[2][2]*S_inv[2][0] - P[2][6]*S_inv[3][0] - P[2][7]*S_inv[4][0] - P[2][8]*S_inv[5][0]) + P[1][11]*(-P[2][0]*S_inv[0][1] - P[2][1]*S_inv[1][1] - P[2][2]*S_inv[2][1] - P[2][6]*S_inv[3][1] - P[2][7]*S_inv[4][1] - P[2][8]*S_inv[5][1]) + P[2][11]*(-P[2][0]*S_inv[0][2] - P[2][1]*S_inv[1][2] - P[2][2]*S_inv[2][2] - P[2][6]*S_inv[3][2] - P[2][7]*S_inv[4][2] - P[2][8]*S_inv[5][2] + 1) + P[6][11]*(-P[2][0]*S_inv[0][3] - P[2][1]*S_inv[1][3] - P[2][2]*S_inv[2][3] - P[2][6]*S_inv[3][3] - P[2][7]*S_inv[4][3] - P[2][8]*S_inv[5][3]) + P[7][11]*(-P[2][0]*S_inv[0][4] - P[2][1]*S_inv[1][4] - P[2][2]*S_inv[2][4] - P[2][6]*S_inv[3][4] - P[2][7]*S_inv[4][4] - P[2][8]*S_inv[5][4]) + P[8][11]*(-P[2][0]*S_inv[0][5] - P[2][1]*S_inv[1][5] - P[2][2]*S_inv[2][5] - P[2][6]*S_inv[3][5] - P[2][7]*S_inv[4][5] - P[2][8]*S_inv[5][5]);
    P_up[2][12] = P[0][12]*(-P[2][0]*S_inv[0][0] - P[2][1]*S_inv[1][0] - P[2][2]*S_inv[2][0] - P[2][6]*S_inv[3][0] - P[2][7]*S_inv[4][0] - P[2][8]*S_inv[5][0]) + P[1][12]*(-P[2][0]*S_inv[0][1] - P[2][1]*S_inv[1][1] - P[2][2]*S_inv[2][1] - P[2][6]*S_inv[3][1] - P[2][7]*S_inv[4][1] - P[2][8]*S_inv[5][1]) + P[2][12]*(-P[2][0]*S_inv[0][2] - P[2][1]*S_inv[1][2] - P[2][2]*S_inv[2][2] - P[2][6]*S_inv[3][2] - P[2][7]*S_inv[4][2] - P[2][8]*S_inv[5][2] + 1) + P[6][12]*(-P[2][0]*S_inv[0][3] - P[2][1]*S_inv[1][3] - P[2][2]*S_inv[2][3] - P[2][6]*S_inv[3][3] - P[2][7]*S_inv[4][3] - P[2][8]*S_inv[5][3]) + P[7][12]*(-P[2][0]*S_inv[0][4] - P[2][1]*S_inv[1][4] - P[2][2]*S_inv[2][4] - P[2][6]*S_inv[3][4] - P[2][7]*S_inv[4][4] - P[2][8]*S_inv[5][4]) + P[8][12]*(-P[2][0]*S_inv[0][5] - P[2][1]*S_inv[1][5] - P[2][2]*S_inv[2][5] - P[2][6]*S_inv[3][5] - P[2][7]*S_inv[4][5] - P[2][8]*S_inv[5][5]);
    P_up[2][13] = P[0][13]*(-P[2][0]*S_inv[0][0] - P[2][1]*S_inv[1][0] - P[2][2]*S_inv[2][0] - P[2][6]*S_inv[3][0] - P[2][7]*S_inv[4][0] - P[2][8]*S_inv[5][0]) + P[1][13]*(-P[2][0]*S_inv[0][1] - P[2][1]*S_inv[1][1] - P[2][2]*S_inv[2][1] - P[2][6]*S_inv[3][1] - P[2][7]*S_inv[4][1] - P[2][8]*S_inv[5][1]) + P[2][13]*(-P[2][0]*S_inv[0][2] - P[2][1]*S_inv[1][2] - P[2][2]*S_inv[2][2] - P[2][6]*S_inv[3][2] - P[2][7]*S_inv[4][2] - P[2][8]*S_inv[5][2] + 1) + P[6][13]*(-P[2][0]*S_inv[0][3] - P[2][1]*S_inv[1][3] - P[2][2]*S_inv[2][3] - P[2][6]*S_inv[3][3] - P[2][7]*S_inv[4][3] - P[2][8]*S_inv[5][3]) + P[7][13]*(-P[2][0]*S_inv[0][4] - P[2][1]*S_inv[1][4] - P[2][2]*S_inv[2][4] - P[2][6]*S_inv[3][4] - P[2][7]*S_inv[4][4] - P[2][8]*S_inv[5][4]) + P[8][13]*(-P[2][0]*S_inv[0][5] - P[2][1]*S_inv[1][5] - P[2][2]*S_inv[2][5] - P[2][6]*S_inv[3][5] - P[2][7]*S_inv[4][5] - P[2][8]*S_inv[5][5]);
    P_up[2][14] = P[0][14]*(-P[2][0]*S_inv[0][0] - P[2][1]*S_inv[1][0] - P[2][2]*S_inv[2][0] - P[2][6]*S_inv[3][0] - P[2][7]*S_inv[4][0] - P[2][8]*S_inv[5][0]) + P[1][14]*(-P[2][0]*S_inv[0][1] - P[2][1]*S_inv[1][1] - P[2][2]*S_inv[2][1] - P[2][6]*S_inv[3][1] - P[2][7]*S_inv[4][1] - P[2][8]*S_inv[5][1]) + P[2][14]*(-P[2][0]*S_inv[0][2] - P[2][1]*S_inv[1][2] - P[2][2]*S_inv[2][2] - P[2][6]*S_inv[3][2] - P[2][7]*S_inv[4][2] - P[2][8]*S_inv[5][2] + 1) + P[6][14]*(-P[2][0]*S_inv[0][3] - P[2][1]*S_inv[1][3] - P[2][2]*S_inv[2][3] - P[2][6]*S_inv[3][3] - P[2][7]*S_inv[4][3] - P[2][8]*S_inv[5][3]) + P[7][14]*(-P[2][0]*S_inv[0][4] - P[2][1]*S_inv[1][4] - P[2][2]*S_inv[2][4] - P[2][6]*S_inv[3][4] - P[2][7]*S_inv[4][4] - P[2][8]*S_inv[5][4]) + P[8][14]*(-P[2][0]*S_inv[0][5] - P[2][1]*S_inv[1][5] - P[2][2]*S_inv[2][5] - P[2][6]*S_inv[3][5] - P[2][7]*S_inv[4][5] - P[2][8]*S_inv[5][5]);
    P_up[3][0] = P[0][0]*(-P[3][0]*S_inv[0][0] - P[3][1]*S_inv[1][0] - P[3][2]*S_inv[2][0] - P[3][6]*S_inv[3][0] - P[3][7]*S_inv[4][0] - P[3][8]*S_inv[5][0]) + P[1][0]*(-P[3][0]*S_inv[0][1] - P[3][1]*S_inv[1][1] - P[3][2]*S_inv[2][1] - P[3][6]*S_inv[3][1] - P[3][7]*S_inv[4][1] - P[3][8]*S_inv[5][1]) + P[2][0]*(-P[3][0]*S_inv[0][2] - P[3][1]*S_inv[1][2] - P[3][2]*S_inv[2][2] - P[3][6]*S_inv[3][2] - P[3][7]*S_inv[4][2] - P[3][8]*S_inv[5][2]) + P[3][0] + P[6][0]*(-P[3][0]*S_inv[0][3] - P[3][1]*S_inv[1][3] - P[3][2]*S_inv[2][3] - P[3][6]*S_inv[3][3] - P[3][7]*S_inv[4][3] - P[3][8]*S_inv[5][3]) + P[7][0]*(-P[3][0]*S_inv[0][4] - P[3][1]*S_inv[1][4] - P[3][2]*S_inv[2][4] - P[3][6]*S_inv[3][4] - P[3][7]*S_inv[4][4] - P[3][8]*S_inv[5][4]) + P[8][0]*(-P[3][0]*S_inv[0][5] - P[3][1]*S_inv[1][5] - P[3][2]*S_inv[2][5] - P[3][6]*S_inv[3][5] - P[3][7]*S_inv[4][5] - P[3][8]*S_inv[5][5]);
    P_up[3][1] = P[0][1]*(-P[3][0]*S_inv[0][0] - P[3][1]*S_inv[1][0] - P[3][2]*S_inv[2][0] - P[3][6]*S_inv[3][0] - P[3][7]*S_inv[4][0] - P[3][8]*S_inv[5][0]) + P[1][1]*(-P[3][0]*S_inv[0][1] - P[3][1]*S_inv[1][1] - P[3][2]*S_inv[2][1] - P[3][6]*S_inv[3][1] - P[3][7]*S_inv[4][1] - P[3][8]*S_inv[5][1]) + P[2][1]*(-P[3][0]*S_inv[0][2] - P[3][1]*S_inv[1][2] - P[3][2]*S_inv[2][2] - P[3][6]*S_inv[3][2] - P[3][7]*S_inv[4][2] - P[3][8]*S_inv[5][2]) + P[3][1] + P[6][1]*(-P[3][0]*S_inv[0][3] - P[3][1]*S_inv[1][3] - P[3][2]*S_inv[2][3] - P[3][6]*S_inv[3][3] - P[3][7]*S_inv[4][3] - P[3][8]*S_inv[5][3]) + P[7][1]*(-P[3][0]*S_inv[0][4] - P[3][1]*S_inv[1][4] - P[3][2]*S_inv[2][4] - P[3][6]*S_inv[3][4] - P[3][7]*S_inv[4][4] - P[3][8]*S_inv[5][4]) + P[8][1]*(-P[3][0]*S_inv[0][5] - P[3][1]*S_inv[1][5] - P[3][2]*S_inv[2][5] - P[3][6]*S_inv[3][5] - P[3][7]*S_inv[4][5] - P[3][8]*S_inv[5][5]);
    P_up[3][2] = P[0][2]*(-P[3][0]*S_inv[0][0] - P[3][1]*S_inv[1][0] - P[3][2]*S_inv[2][0] - P[3][6]*S_inv[3][0] - P[3][7]*S_inv[4][0] - P[3][8]*S_inv[5][0]) + P[1][2]*(-P[3][0]*S_inv[0][1] - P[3][1]*S_inv[1][1] - P[3][2]*S_inv[2][1] - P[3][6]*S_inv[3][1] - P[3][7]*S_inv[4][1] - P[3][8]*S_inv[5][1]) + P[2][2]*(-P[3][0]*S_inv[0][2] - P[3][1]*S_inv[1][2] - P[3][2]*S_inv[2][2] - P[3][6]*S_inv[3][2] - P[3][7]*S_inv[4][2] - P[3][8]*S_inv[5][2]) + P[3][2] + P[6][2]*(-P[3][0]*S_inv[0][3] - P[3][1]*S_inv[1][3] - P[3][2]*S_inv[2][3] - P[3][6]*S_inv[3][3] - P[3][7]*S_inv[4][3] - P[3][8]*S_inv[5][3]) + P[7][2]*(-P[3][0]*S_inv[0][4] - P[3][1]*S_inv[1][4] - P[3][2]*S_inv[2][4] - P[3][6]*S_inv[3][4] - P[3][7]*S_inv[4][4] - P[3][8]*S_inv[5][4]) + P[8][2]*(-P[3][0]*S_inv[0][5] - P[3][1]*S_inv[1][5] - P[3][2]*S_inv[2][5] - P[3][6]*S_inv[3][5] - P[3][7]*S_inv[4][5] - P[3][8]*S_inv[5][5]);
    P_up[3][3] = P[0][3]*(-P[3][0]*S_inv[0][0] - P[3][1]*S_inv[1][0] - P[3][2]*S_inv[2][0] - P[3][6]*S_inv[3][0] - P[3][7]*S_inv[4][0] - P[3][8]*S_inv[5][0]) + P[1][3]*(-P[3][0]*S_inv[0][1] - P[3][1]*S_inv[1][1] - P[3][2]*S_inv[2][1] - P[3][6]*S_inv[3][1] - P[3][7]*S_inv[4][1] - P[3][8]*S_inv[5][1]) + P[2][3]*(-P[3][0]*S_inv[0][2] - P[3][1]*S_inv[1][2] - P[3][2]*S_inv[2][2] - P[3][6]*S_inv[3][2] - P[3][7]*S_inv[4][2] - P[3][8]*S_inv[5][2]) + P[3][3] + P[6][3]*(-P[3][0]*S_inv[0][3] - P[3][1]*S_inv[1][3] - P[3][2]*S_inv[2][3] - P[3][6]*S_inv[3][3] - P[3][7]*S_inv[4][3] - P[3][8]*S_inv[5][3]) + P[7][3]*(-P[3][0]*S_inv[0][4] - P[3][1]*S_inv[1][4] - P[3][2]*S_inv[2][4] - P[3][6]*S_inv[3][4] - P[3][7]*S_inv[4][4] - P[3][8]*S_inv[5][4]) + P[8][3]*(-P[3][0]*S_inv[0][5] - P[3][1]*S_inv[1][5] - P[3][2]*S_inv[2][5] - P[3][6]*S_inv[3][5] - P[3][7]*S_inv[4][5] - P[3][8]*S_inv[5][5]);
    P_up[3][4] = P[0][4]*(-P[3][0]*S_inv[0][0] - P[3][1]*S_inv[1][0] - P[3][2]*S_inv[2][0] - P[3][6]*S_inv[3][0] - P[3][7]*S_inv[4][0] - P[3][8]*S_inv[5][0]) + P[1][4]*(-P[3][0]*S_inv[0][1] - P[3][1]*S_inv[1][1] - P[3][2]*S_inv[2][1] - P[3][6]*S_inv[3][1] - P[3][7]*S_inv[4][1] - P[3][8]*S_inv[5][1]) + P[2][4]*(-P[3][0]*S_inv[0][2] - P[3][1]*S_inv[1][2] - P[3][2]*S_inv[2][2] - P[3][6]*S_inv[3][2] - P[3][7]*S_inv[4][2] - P[3][8]*S_inv[5][2]) + P[3][4] + P[6][4]*(-P[3][0]*S_inv[0][3] - P[3][1]*S_inv[1][3] - P[3][2]*S_inv[2][3] - P[3][6]*S_inv[3][3] - P[3][7]*S_inv[4][3] - P[3][8]*S_inv[5][3]) + P[7][4]*(-P[3][0]*S_inv[0][4] - P[3][1]*S_inv[1][4] - P[3][2]*S_inv[2][4] - P[3][6]*S_inv[3][4] - P[3][7]*S_inv[4][4] - P[3][8]*S_inv[5][4]) + P[8][4]*(-P[3][0]*S_inv[0][5] - P[3][1]*S_inv[1][5] - P[3][2]*S_inv[2][5] - P[3][6]*S_inv[3][5] - P[3][7]*S_inv[4][5] - P[3][8]*S_inv[5][5]);
    P_up[3][5] = P[0][5]*(-P[3][0]*S_inv[0][0] - P[3][1]*S_inv[1][0] - P[3][2]*S_inv[2][0] - P[3][6]*S_inv[3][0] - P[3][7]*S_inv[4][0] - P[3][8]*S_inv[5][0]) + P[1][5]*(-P[3][0]*S_inv[0][1] - P[3][1]*S_inv[1][1] - P[3][2]*S_inv[2][1] - P[3][6]*S_inv[3][1] - P[3][7]*S_inv[4][1] - P[3][8]*S_inv[5][1]) + P[2][5]*(-P[3][0]*S_inv[0][2] - P[3][1]*S_inv[1][2] - P[3][2]*S_inv[2][2] - P[3][6]*S_inv[3][2] - P[3][7]*S_inv[4][2] - P[3][8]*S_inv[5][2]) + P[3][5] + P[6][5]*(-P[3][0]*S_inv[0][3] - P[3][1]*S_inv[1][3] - P[3][2]*S_inv[2][3] - P[3][6]*S_inv[3][3] - P[3][7]*S_inv[4][3] - P[3][8]*S_inv[5][3]) + P[7][5]*(-P[3][0]*S_inv[0][4] - P[3][1]*S_inv[1][4] - P[3][2]*S_inv[2][4] - P[3][6]*S_inv[3][4] - P[3][7]*S_inv[4][4] - P[3][8]*S_inv[5][4]) + P[8][5]*(-P[3][0]*S_inv[0][5] - P[3][1]*S_inv[1][5] - P[3][2]*S_inv[2][5] - P[3][6]*S_inv[3][5] - P[3][7]*S_inv[4][5] - P[3][8]*S_inv[5][5]);
    P_up[3][6] = P[0][6]*(-P[3][0]*S_inv[0][0] - P[3][1]*S_inv[1][0] - P[3][2]*S_inv[2][0] - P[3][6]*S_inv[3][0] - P[3][7]*S_inv[4][0] - P[3][8]*S_inv[5][0]) + P[1][6]*(-P[3][0]*S_inv[0][1] - P[3][1]*S_inv[1][1] - P[3][2]*S_inv[2][1] - P[3][6]*S_inv[3][1] - P[3][7]*S_inv[4][1] - P[3][8]*S_inv[5][1]) + P[2][6]*(-P[3][0]*S_inv[0][2] - P[3][1]*S_inv[1][2] - P[3][2]*S_inv[2][2] - P[3][6]*S_inv[3][2] - P[3][7]*S_inv[4][2] - P[3][8]*S_inv[5][2]) + P[3][6] + P[6][6]*(-P[3][0]*S_inv[0][3] - P[3][1]*S_inv[1][3] - P[3][2]*S_inv[2][3] - P[3][6]*S_inv[3][3] - P[3][7]*S_inv[4][3] - P[3][8]*S_inv[5][3]) + P[7][6]*(-P[3][0]*S_inv[0][4] - P[3][1]*S_inv[1][4] - P[3][2]*S_inv[2][4] - P[3][6]*S_inv[3][4] - P[3][7]*S_inv[4][4] - P[3][8]*S_inv[5][4]) + P[8][6]*(-P[3][0]*S_inv[0][5] - P[3][1]*S_inv[1][5] - P[3][2]*S_inv[2][5] - P[3][6]*S_inv[3][5] - P[3][7]*S_inv[4][5] - P[3][8]*S_inv[5][5]);
    P_up[3][7] = P[0][7]*(-P[3][0]*S_inv[0][0] - P[3][1]*S_inv[1][0] - P[3][2]*S_inv[2][0] - P[3][6]*S_inv[3][0] - P[3][7]*S_inv[4][0] - P[3][8]*S_inv[5][0]) + P[1][7]*(-P[3][0]*S_inv[0][1] - P[3][1]*S_inv[1][1] - P[3][2]*S_inv[2][1] - P[3][6]*S_inv[3][1] - P[3][7]*S_inv[4][1] - P[3][8]*S_inv[5][1]) + P[2][7]*(-P[3][0]*S_inv[0][2] - P[3][1]*S_inv[1][2] - P[3][2]*S_inv[2][2] - P[3][6]*S_inv[3][2] - P[3][7]*S_inv[4][2] - P[3][8]*S_inv[5][2]) + P[3][7] + P[6][7]*(-P[3][0]*S_inv[0][3] - P[3][1]*S_inv[1][3] - P[3][2]*S_inv[2][3] - P[3][6]*S_inv[3][3] - P[3][7]*S_inv[4][3] - P[3][8]*S_inv[5][3]) + P[7][7]*(-P[3][0]*S_inv[0][4] - P[3][1]*S_inv[1][4] - P[3][2]*S_inv[2][4] - P[3][6]*S_inv[3][4] - P[3][7]*S_inv[4][4] - P[3][8]*S_inv[5][4]) + P[8][7]*(-P[3][0]*S_inv[0][5] - P[3][1]*S_inv[1][5] - P[3][2]*S_inv[2][5] - P[3][6]*S_inv[3][5] - P[3][7]*S_inv[4][5] - P[3][8]*S_inv[5][5]);
    P_up[3][8] = P[0][8]*(-P[3][0]*S_inv[0][0] - P[3][1]*S_inv[1][0] - P[3][2]*S_inv[2][0] - P[3][6]*S_inv[3][0] - P[3][7]*S_inv[4][0] - P[3][8]*S_inv[5][0]) + P[1][8]*(-P[3][0]*S_inv[0][1] - P[3][1]*S_inv[1][1] - P[3][2]*S_inv[2][1] - P[3][6]*S_inv[3][1] - P[3][7]*S_inv[4][1] - P[3][8]*S_inv[5][1]) + P[2][8]*(-P[3][0]*S_inv[0][2] - P[3][1]*S_inv[1][2] - P[3][2]*S_inv[2][2] - P[3][6]*S_inv[3][2] - P[3][7]*S_inv[4][2] - P[3][8]*S_inv[5][2]) + P[3][8] + P[6][8]*(-P[3][0]*S_inv[0][3] - P[3][1]*S_inv[1][3] - P[3][2]*S_inv[2][3] - P[3][6]*S_inv[3][3] - P[3][7]*S_inv[4][3] - P[3][8]*S_inv[5][3]) + P[7][8]*(-P[3][0]*S_inv[0][4] - P[3][1]*S_inv[1][4] - P[3][2]*S_inv[2][4] - P[3][6]*S_inv[3][4] - P[3][7]*S_inv[4][4] - P[3][8]*S_inv[5][4]) + P[8][8]*(-P[3][0]*S_inv[0][5] - P[3][1]*S_inv[1][5] - P[3][2]*S_inv[2][5] - P[3][6]*S_inv[3][5] - P[3][7]*S_inv[4][5] - P[3][8]*S_inv[5][5]);
    P_up[3][9] = P[0][9]*(-P[3][0]*S_inv[0][0] - P[3][1]*S_inv[1][0] - P[3][2]*S_inv[2][0] - P[3][6]*S_inv[3][0] - P[3][7]*S_inv[4][0] - P[3][8]*S_inv[5][0]) + P[1][9]*(-P[3][0]*S_inv[0][1] - P[3][1]*S_inv[1][1] - P[3][2]*S_inv[2][1] - P[3][6]*S_inv[3][1] - P[3][7]*S_inv[4][1] - P[3][8]*S_inv[5][1]) + P[2][9]*(-P[3][0]*S_inv[0][2] - P[3][1]*S_inv[1][2] - P[3][2]*S_inv[2][2] - P[3][6]*S_inv[3][2] - P[3][7]*S_inv[4][2] - P[3][8]*S_inv[5][2]) + P[3][9] + P[6][9]*(-P[3][0]*S_inv[0][3] - P[3][1]*S_inv[1][3] - P[3][2]*S_inv[2][3] - P[3][6]*S_inv[3][3] - P[3][7]*S_inv[4][3] - P[3][8]*S_inv[5][3]) + P[7][9]*(-P[3][0]*S_inv[0][4] - P[3][1]*S_inv[1][4] - P[3][2]*S_inv[2][4] - P[3][6]*S_inv[3][4] - P[3][7]*S_inv[4][4] - P[3][8]*S_inv[5][4]) + P[8][9]*(-P[3][0]*S_inv[0][5] - P[3][1]*S_inv[1][5] - P[3][2]*S_inv[2][5] - P[3][6]*S_inv[3][5] - P[3][7]*S_inv[4][5] - P[3][8]*S_inv[5][5]);
    P_up[3][10] = P[0][10]*(-P[3][0]*S_inv[0][0] - P[3][1]*S_inv[1][0] - P[3][2]*S_inv[2][0] - P[3][6]*S_inv[3][0] - P[3][7]*S_inv[4][0] - P[3][8]*S_inv[5][0]) + P[1][10]*(-P[3][0]*S_inv[0][1] - P[3][1]*S_inv[1][1] - P[3][2]*S_inv[2][1] - P[3][6]*S_inv[3][1] - P[3][7]*S_inv[4][1] - P[3][8]*S_inv[5][1]) + P[2][10]*(-P[3][0]*S_inv[0][2] - P[3][1]*S_inv[1][2] - P[3][2]*S_inv[2][2] - P[3][6]*S_inv[3][2] - P[3][7]*S_inv[4][2] - P[3][8]*S_inv[5][2]) + P[3][10] + P[6][10]*(-P[3][0]*S_inv[0][3] - P[3][1]*S_inv[1][3] - P[3][2]*S_inv[2][3] - P[3][6]*S_inv[3][3] - P[3][7]*S_inv[4][3] - P[3][8]*S_inv[5][3]) + P[7][10]*(-P[3][0]*S_inv[0][4] - P[3][1]*S_inv[1][4] - P[3][2]*S_inv[2][4] - P[3][6]*S_inv[3][4] - P[3][7]*S_inv[4][4] - P[3][8]*S_inv[5][4]) + P[8][10]*(-P[3][0]*S_inv[0][5] - P[3][1]*S_inv[1][5] - P[3][2]*S_inv[2][5] - P[3][6]*S_inv[3][5] - P[3][7]*S_inv[4][5] - P[3][8]*S_inv[5][5]);
    P_up[3][11] = P[0][11]*(-P[3][0]*S_inv[0][0] - P[3][1]*S_inv[1][0] - P[3][2]*S_inv[2][0] - P[3][6]*S_inv[3][0] - P[3][7]*S_inv[4][0] - P[3][8]*S_inv[5][0]) + P[1][11]*(-P[3][0]*S_inv[0][1] - P[3][1]*S_inv[1][1] - P[3][2]*S_inv[2][1] - P[3][6]*S_inv[3][1] - P[3][7]*S_inv[4][1] - P[3][8]*S_inv[5][1]) + P[2][11]*(-P[3][0]*S_inv[0][2] - P[3][1]*S_inv[1][2] - P[3][2]*S_inv[2][2] - P[3][6]*S_inv[3][2] - P[3][7]*S_inv[4][2] - P[3][8]*S_inv[5][2]) + P[3][11] + P[6][11]*(-P[3][0]*S_inv[0][3] - P[3][1]*S_inv[1][3] - P[3][2]*S_inv[2][3] - P[3][6]*S_inv[3][3] - P[3][7]*S_inv[4][3] - P[3][8]*S_inv[5][3]) + P[7][11]*(-P[3][0]*S_inv[0][4] - P[3][1]*S_inv[1][4] - P[3][2]*S_inv[2][4] - P[3][6]*S_inv[3][4] - P[3][7]*S_inv[4][4] - P[3][8]*S_inv[5][4]) + P[8][11]*(-P[3][0]*S_inv[0][5] - P[3][1]*S_inv[1][5] - P[3][2]*S_inv[2][5] - P[3][6]*S_inv[3][5] - P[3][7]*S_inv[4][5] - P[3][8]*S_inv[5][5]);
    P_up[3][12] = P[0][12]*(-P[3][0]*S_inv[0][0] - P[3][1]*S_inv[1][0] - P[3][2]*S_inv[2][0] - P[3][6]*S_inv[3][0] - P[3][7]*S_inv[4][0] - P[3][8]*S_inv[5][0]) + P[1][12]*(-P[3][0]*S_inv[0][1] - P[3][1]*S_inv[1][1] - P[3][2]*S_inv[2][1] - P[3][6]*S_inv[3][1] - P[3][7]*S_inv[4][1] - P[3][8]*S_inv[5][1]) + P[2][12]*(-P[3][0]*S_inv[0][2] - P[3][1]*S_inv[1][2] - P[3][2]*S_inv[2][2] - P[3][6]*S_inv[3][2] - P[3][7]*S_inv[4][2] - P[3][8]*S_inv[5][2]) + P[3][12] + P[6][12]*(-P[3][0]*S_inv[0][3] - P[3][1]*S_inv[1][3] - P[3][2]*S_inv[2][3] - P[3][6]*S_inv[3][3] - P[3][7]*S_inv[4][3] - P[3][8]*S_inv[5][3]) + P[7][12]*(-P[3][0]*S_inv[0][4] - P[3][1]*S_inv[1][4] - P[3][2]*S_inv[2][4] - P[3][6]*S_inv[3][4] - P[3][7]*S_inv[4][4] - P[3][8]*S_inv[5][4]) + P[8][12]*(-P[3][0]*S_inv[0][5] - P[3][1]*S_inv[1][5] - P[3][2]*S_inv[2][5] - P[3][6]*S_inv[3][5] - P[3][7]*S_inv[4][5] - P[3][8]*S_inv[5][5]);
    P_up[3][13] = P[0][13]*(-P[3][0]*S_inv[0][0] - P[3][1]*S_inv[1][0] - P[3][2]*S_inv[2][0] - P[3][6]*S_inv[3][0] - P[3][7]*S_inv[4][0] - P[3][8]*S_inv[5][0]) + P[1][13]*(-P[3][0]*S_inv[0][1] - P[3][1]*S_inv[1][1] - P[3][2]*S_inv[2][1] - P[3][6]*S_inv[3][1] - P[3][7]*S_inv[4][1] - P[3][8]*S_inv[5][1]) + P[2][13]*(-P[3][0]*S_inv[0][2] - P[3][1]*S_inv[1][2] - P[3][2]*S_inv[2][2] - P[3][6]*S_inv[3][2] - P[3][7]*S_inv[4][2] - P[3][8]*S_inv[5][2]) + P[3][13] + P[6][13]*(-P[3][0]*S_inv[0][3] - P[3][1]*S_inv[1][3] - P[3][2]*S_inv[2][3] - P[3][6]*S_inv[3][3] - P[3][7]*S_inv[4][3] - P[3][8]*S_inv[5][3]) + P[7][13]*(-P[3][0]*S_inv[0][4] - P[3][1]*S_inv[1][4] - P[3][2]*S_inv[2][4] - P[3][6]*S_inv[3][4] - P[3][7]*S_inv[4][4] - P[3][8]*S_inv[5][4]) + P[8][13]*(-P[3][0]*S_inv[0][5] - P[3][1]*S_inv[1][5] - P[3][2]*S_inv[2][5] - P[3][6]*S_inv[3][5] - P[3][7]*S_inv[4][5] - P[3][8]*S_inv[5][5]);
    P_up[3][14] = P[0][14]*(-P[3][0]*S_inv[0][0] - P[3][1]*S_inv[1][0] - P[3][2]*S_inv[2][0] - P[3][6]*S_inv[3][0] - P[3][7]*S_inv[4][0] - P[3][8]*S_inv[5][0]) + P[1][14]*(-P[3][0]*S_inv[0][1] - P[3][1]*S_inv[1][1] - P[3][2]*S_inv[2][1] - P[3][6]*S_inv[3][1] - P[3][7]*S_inv[4][1] - P[3][8]*S_inv[5][1]) + P[2][14]*(-P[3][0]*S_inv[0][2] - P[3][1]*S_inv[1][2] - P[3][2]*S_inv[2][2] - P[3][6]*S_inv[3][2] - P[3][7]*S_inv[4][2] - P[3][8]*S_inv[5][2]) + P[3][14] + P[6][14]*(-P[3][0]*S_inv[0][3] - P[3][1]*S_inv[1][3] - P[3][2]*S_inv[2][3] - P[3][6]*S_inv[3][3] - P[3][7]*S_inv[4][3] - P[3][8]*S_inv[5][3]) + P[7][14]*(-P[3][0]*S_inv[0][4] - P[3][1]*S_inv[1][4] - P[3][2]*S_inv[2][4] - P[3][6]*S_inv[3][4] - P[3][7]*S_inv[4][4] - P[3][8]*S_inv[5][4]) + P[8][14]*(-P[3][0]*S_inv[0][5] - P[3][1]*S_inv[1][5] - P[3][2]*S_inv[2][5] - P[3][6]*S_inv[3][5] - P[3][7]*S_inv[4][5] - P[3][8]*S_inv[5][5]);
    P_up[4][0] = P[0][0]*(-P[4][0]*S_inv[0][0] - P[4][1]*S_inv[1][0] - P[4][2]*S_inv[2][0] - P[4][6]*S_inv[3][0] - P[4][7]*S_inv[4][0] - P[4][8]*S_inv[5][0]) + P[1][0]*(-P[4][0]*S_inv[0][1] - P[4][1]*S_inv[1][1] - P[4][2]*S_inv[2][1] - P[4][6]*S_inv[3][1] - P[4][7]*S_inv[4][1] - P[4][8]*S_inv[5][1]) + P[2][0]*(-P[4][0]*S_inv[0][2] - P[4][1]*S_inv[1][2] - P[4][2]*S_inv[2][2] - P[4][6]*S_inv[3][2] - P[4][7]*S_inv[4][2] - P[4][8]*S_inv[5][2]) + P[4][0] + P[6][0]*(-P[4][0]*S_inv[0][3] - P[4][1]*S_inv[1][3] - P[4][2]*S_inv[2][3] - P[4][6]*S_inv[3][3] - P[4][7]*S_inv[4][3] - P[4][8]*S_inv[5][3]) + P[7][0]*(-P[4][0]*S_inv[0][4] - P[4][1]*S_inv[1][4] - P[4][2]*S_inv[2][4] - P[4][6]*S_inv[3][4] - P[4][7]*S_inv[4][4] - P[4][8]*S_inv[5][4]) + P[8][0]*(-P[4][0]*S_inv[0][5] - P[4][1]*S_inv[1][5] - P[4][2]*S_inv[2][5] - P[4][6]*S_inv[3][5] - P[4][7]*S_inv[4][5] - P[4][8]*S_inv[5][5]);
    P_up[4][1] = P[0][1]*(-P[4][0]*S_inv[0][0] - P[4][1]*S_inv[1][0] - P[4][2]*S_inv[2][0] - P[4][6]*S_inv[3][0] - P[4][7]*S_inv[4][0] - P[4][8]*S_inv[5][0]) + P[1][1]*(-P[4][0]*S_inv[0][1] - P[4][1]*S_inv[1][1] - P[4][2]*S_inv[2][1] - P[4][6]*S_inv[3][1] - P[4][7]*S_inv[4][1] - P[4][8]*S_inv[5][1]) + P[2][1]*(-P[4][0]*S_inv[0][2] - P[4][1]*S_inv[1][2] - P[4][2]*S_inv[2][2] - P[4][6]*S_inv[3][2] - P[4][7]*S_inv[4][2] - P[4][8]*S_inv[5][2]) + P[4][1] + P[6][1]*(-P[4][0]*S_inv[0][3] - P[4][1]*S_inv[1][3] - P[4][2]*S_inv[2][3] - P[4][6]*S_inv[3][3] - P[4][7]*S_inv[4][3] - P[4][8]*S_inv[5][3]) + P[7][1]*(-P[4][0]*S_inv[0][4] - P[4][1]*S_inv[1][4] - P[4][2]*S_inv[2][4] - P[4][6]*S_inv[3][4] - P[4][7]*S_inv[4][4] - P[4][8]*S_inv[5][4]) + P[8][1]*(-P[4][0]*S_inv[0][5] - P[4][1]*S_inv[1][5] - P[4][2]*S_inv[2][5] - P[4][6]*S_inv[3][5] - P[4][7]*S_inv[4][5] - P[4][8]*S_inv[5][5]);
    P_up[4][2] = P[0][2]*(-P[4][0]*S_inv[0][0] - P[4][1]*S_inv[1][0] - P[4][2]*S_inv[2][0] - P[4][6]*S_inv[3][0] - P[4][7]*S_inv[4][0] - P[4][8]*S_inv[5][0]) + P[1][2]*(-P[4][0]*S_inv[0][1] - P[4][1]*S_inv[1][1] - P[4][2]*S_inv[2][1] - P[4][6]*S_inv[3][1] - P[4][7]*S_inv[4][1] - P[4][8]*S_inv[5][1]) + P[2][2]*(-P[4][0]*S_inv[0][2] - P[4][1]*S_inv[1][2] - P[4][2]*S_inv[2][2] - P[4][6]*S_inv[3][2] - P[4][7]*S_inv[4][2] - P[4][8]*S_inv[5][2]) + P[4][2] + P[6][2]*(-P[4][0]*S_inv[0][3] - P[4][1]*S_inv[1][3] - P[4][2]*S_inv[2][3] - P[4][6]*S_inv[3][3] - P[4][7]*S_inv[4][3] - P[4][8]*S_inv[5][3]) + P[7][2]*(-P[4][0]*S_inv[0][4] - P[4][1]*S_inv[1][4] - P[4][2]*S_inv[2][4] - P[4][6]*S_inv[3][4] - P[4][7]*S_inv[4][4] - P[4][8]*S_inv[5][4]) + P[8][2]*(-P[4][0]*S_inv[0][5] - P[4][1]*S_inv[1][5] - P[4][2]*S_inv[2][5] - P[4][6]*S_inv[3][5] - P[4][7]*S_inv[4][5] - P[4][8]*S_inv[5][5]);
    P_up[4][3] = P[0][3]*(-P[4][0]*S_inv[0][0] - P[4][1]*S_inv[1][0] - P[4][2]*S_inv[2][0] - P[4][6]*S_inv[3][0] - P[4][7]*S_inv[4][0] - P[4][8]*S_inv[5][0]) + P[1][3]*(-P[4][0]*S_inv[0][1] - P[4][1]*S_inv[1][1] - P[4][2]*S_inv[2][1] - P[4][6]*S_inv[3][1] - P[4][7]*S_inv[4][1] - P[4][8]*S_inv[5][1]) + P[2][3]*(-P[4][0]*S_inv[0][2] - P[4][1]*S_inv[1][2] - P[4][2]*S_inv[2][2] - P[4][6]*S_inv[3][2] - P[4][7]*S_inv[4][2] - P[4][8]*S_inv[5][2]) + P[4][3] + P[6][3]*(-P[4][0]*S_inv[0][3] - P[4][1]*S_inv[1][3] - P[4][2]*S_inv[2][3] - P[4][6]*S_inv[3][3] - P[4][7]*S_inv[4][3] - P[4][8]*S_inv[5][3]) + P[7][3]*(-P[4][0]*S_inv[0][4] - P[4][1]*S_inv[1][4] - P[4][2]*S_inv[2][4] - P[4][6]*S_inv[3][4] - P[4][7]*S_inv[4][4] - P[4][8]*S_inv[5][4]) + P[8][3]*(-P[4][0]*S_inv[0][5] - P[4][1]*S_inv[1][5] - P[4][2]*S_inv[2][5] - P[4][6]*S_inv[3][5] - P[4][7]*S_inv[4][5] - P[4][8]*S_inv[5][5]);
    P_up[4][4] = P[0][4]*(-P[4][0]*S_inv[0][0] - P[4][1]*S_inv[1][0] - P[4][2]*S_inv[2][0] - P[4][6]*S_inv[3][0] - P[4][7]*S_inv[4][0] - P[4][8]*S_inv[5][0]) + P[1][4]*(-P[4][0]*S_inv[0][1] - P[4][1]*S_inv[1][1] - P[4][2]*S_inv[2][1] - P[4][6]*S_inv[3][1] - P[4][7]*S_inv[4][1] - P[4][8]*S_inv[5][1]) + P[2][4]*(-P[4][0]*S_inv[0][2] - P[4][1]*S_inv[1][2] - P[4][2]*S_inv[2][2] - P[4][6]*S_inv[3][2] - P[4][7]*S_inv[4][2] - P[4][8]*S_inv[5][2]) + P[4][4] + P[6][4]*(-P[4][0]*S_inv[0][3] - P[4][1]*S_inv[1][3] - P[4][2]*S_inv[2][3] - P[4][6]*S_inv[3][3] - P[4][7]*S_inv[4][3] - P[4][8]*S_inv[5][3]) + P[7][4]*(-P[4][0]*S_inv[0][4] - P[4][1]*S_inv[1][4] - P[4][2]*S_inv[2][4] - P[4][6]*S_inv[3][4] - P[4][7]*S_inv[4][4] - P[4][8]*S_inv[5][4]) + P[8][4]*(-P[4][0]*S_inv[0][5] - P[4][1]*S_inv[1][5] - P[4][2]*S_inv[2][5] - P[4][6]*S_inv[3][5] - P[4][7]*S_inv[4][5] - P[4][8]*S_inv[5][5]);
    P_up[4][5] = P[0][5]*(-P[4][0]*S_inv[0][0] - P[4][1]*S_inv[1][0] - P[4][2]*S_inv[2][0] - P[4][6]*S_inv[3][0] - P[4][7]*S_inv[4][0] - P[4][8]*S_inv[5][0]) + P[1][5]*(-P[4][0]*S_inv[0][1] - P[4][1]*S_inv[1][1] - P[4][2]*S_inv[2][1] - P[4][6]*S_inv[3][1] - P[4][7]*S_inv[4][1] - P[4][8]*S_inv[5][1]) + P[2][5]*(-P[4][0]*S_inv[0][2] - P[4][1]*S_inv[1][2] - P[4][2]*S_inv[2][2] - P[4][6]*S_inv[3][2] - P[4][7]*S_inv[4][2] - P[4][8]*S_inv[5][2]) + P[4][5] + P[6][5]*(-P[4][0]*S_inv[0][3] - P[4][1]*S_inv[1][3] - P[4][2]*S_inv[2][3] - P[4][6]*S_inv[3][3] - P[4][7]*S_inv[4][3] - P[4][8]*S_inv[5][3]) + P[7][5]*(-P[4][0]*S_inv[0][4] - P[4][1]*S_inv[1][4] - P[4][2]*S_inv[2][4] - P[4][6]*S_inv[3][4] - P[4][7]*S_inv[4][4] - P[4][8]*S_inv[5][4]) + P[8][5]*(-P[4][0]*S_inv[0][5] - P[4][1]*S_inv[1][5] - P[4][2]*S_inv[2][5] - P[4][6]*S_inv[3][5] - P[4][7]*S_inv[4][5] - P[4][8]*S_inv[5][5]);
    P_up[4][6] = P[0][6]*(-P[4][0]*S_inv[0][0] - P[4][1]*S_inv[1][0] - P[4][2]*S_inv[2][0] - P[4][6]*S_inv[3][0] - P[4][7]*S_inv[4][0] - P[4][8]*S_inv[5][0]) + P[1][6]*(-P[4][0]*S_inv[0][1] - P[4][1]*S_inv[1][1] - P[4][2]*S_inv[2][1] - P[4][6]*S_inv[3][1] - P[4][7]*S_inv[4][1] - P[4][8]*S_inv[5][1]) + P[2][6]*(-P[4][0]*S_inv[0][2] - P[4][1]*S_inv[1][2] - P[4][2]*S_inv[2][2] - P[4][6]*S_inv[3][2] - P[4][7]*S_inv[4][2] - P[4][8]*S_inv[5][2]) + P[4][6] + P[6][6]*(-P[4][0]*S_inv[0][3] - P[4][1]*S_inv[1][3] - P[4][2]*S_inv[2][3] - P[4][6]*S_inv[3][3] - P[4][7]*S_inv[4][3] - P[4][8]*S_inv[5][3]) + P[7][6]*(-P[4][0]*S_inv[0][4] - P[4][1]*S_inv[1][4] - P[4][2]*S_inv[2][4] - P[4][6]*S_inv[3][4] - P[4][7]*S_inv[4][4] - P[4][8]*S_inv[5][4]) + P[8][6]*(-P[4][0]*S_inv[0][5] - P[4][1]*S_inv[1][5] - P[4][2]*S_inv[2][5] - P[4][6]*S_inv[3][5] - P[4][7]*S_inv[4][5] - P[4][8]*S_inv[5][5]);
    P_up[4][7] = P[0][7]*(-P[4][0]*S_inv[0][0] - P[4][1]*S_inv[1][0] - P[4][2]*S_inv[2][0] - P[4][6]*S_inv[3][0] - P[4][7]*S_inv[4][0] - P[4][8]*S_inv[5][0]) + P[1][7]*(-P[4][0]*S_inv[0][1] - P[4][1]*S_inv[1][1] - P[4][2]*S_inv[2][1] - P[4][6]*S_inv[3][1] - P[4][7]*S_inv[4][1] - P[4][8]*S_inv[5][1]) + P[2][7]*(-P[4][0]*S_inv[0][2] - P[4][1]*S_inv[1][2] - P[4][2]*S_inv[2][2] - P[4][6]*S_inv[3][2] - P[4][7]*S_inv[4][2] - P[4][8]*S_inv[5][2]) + P[4][7] + P[6][7]*(-P[4][0]*S_inv[0][3] - P[4][1]*S_inv[1][3] - P[4][2]*S_inv[2][3] - P[4][6]*S_inv[3][3] - P[4][7]*S_inv[4][3] - P[4][8]*S_inv[5][3]) + P[7][7]*(-P[4][0]*S_inv[0][4] - P[4][1]*S_inv[1][4] - P[4][2]*S_inv[2][4] - P[4][6]*S_inv[3][4] - P[4][7]*S_inv[4][4] - P[4][8]*S_inv[5][4]) + P[8][7]*(-P[4][0]*S_inv[0][5] - P[4][1]*S_inv[1][5] - P[4][2]*S_inv[2][5] - P[4][6]*S_inv[3][5] - P[4][7]*S_inv[4][5] - P[4][8]*S_inv[5][5]);
    P_up[4][8] = P[0][8]*(-P[4][0]*S_inv[0][0] - P[4][1]*S_inv[1][0] - P[4][2]*S_inv[2][0] - P[4][6]*S_inv[3][0] - P[4][7]*S_inv[4][0] - P[4][8]*S_inv[5][0]) + P[1][8]*(-P[4][0]*S_inv[0][1] - P[4][1]*S_inv[1][1] - P[4][2]*S_inv[2][1] - P[4][6]*S_inv[3][1] - P[4][7]*S_inv[4][1] - P[4][8]*S_inv[5][1]) + P[2][8]*(-P[4][0]*S_inv[0][2] - P[4][1]*S_inv[1][2] - P[4][2]*S_inv[2][2] - P[4][6]*S_inv[3][2] - P[4][7]*S_inv[4][2] - P[4][8]*S_inv[5][2]) + P[4][8] + P[6][8]*(-P[4][0]*S_inv[0][3] - P[4][1]*S_inv[1][3] - P[4][2]*S_inv[2][3] - P[4][6]*S_inv[3][3] - P[4][7]*S_inv[4][3] - P[4][8]*S_inv[5][3]) + P[7][8]*(-P[4][0]*S_inv[0][4] - P[4][1]*S_inv[1][4] - P[4][2]*S_inv[2][4] - P[4][6]*S_inv[3][4] - P[4][7]*S_inv[4][4] - P[4][8]*S_inv[5][4]) + P[8][8]*(-P[4][0]*S_inv[0][5] - P[4][1]*S_inv[1][5] - P[4][2]*S_inv[2][5] - P[4][6]*S_inv[3][5] - P[4][7]*S_inv[4][5] - P[4][8]*S_inv[5][5]);
    P_up[4][9] = P[0][9]*(-P[4][0]*S_inv[0][0] - P[4][1]*S_inv[1][0] - P[4][2]*S_inv[2][0] - P[4][6]*S_inv[3][0] - P[4][7]*S_inv[4][0] - P[4][8]*S_inv[5][0]) + P[1][9]*(-P[4][0]*S_inv[0][1] - P[4][1]*S_inv[1][1] - P[4][2]*S_inv[2][1] - P[4][6]*S_inv[3][1] - P[4][7]*S_inv[4][1] - P[4][8]*S_inv[5][1]) + P[2][9]*(-P[4][0]*S_inv[0][2] - P[4][1]*S_inv[1][2] - P[4][2]*S_inv[2][2] - P[4][6]*S_inv[3][2] - P[4][7]*S_inv[4][2] - P[4][8]*S_inv[5][2]) + P[4][9] + P[6][9]*(-P[4][0]*S_inv[0][3] - P[4][1]*S_inv[1][3] - P[4][2]*S_inv[2][3] - P[4][6]*S_inv[3][3] - P[4][7]*S_inv[4][3] - P[4][8]*S_inv[5][3]) + P[7][9]*(-P[4][0]*S_inv[0][4] - P[4][1]*S_inv[1][4] - P[4][2]*S_inv[2][4] - P[4][6]*S_inv[3][4] - P[4][7]*S_inv[4][4] - P[4][8]*S_inv[5][4]) + P[8][9]*(-P[4][0]*S_inv[0][5] - P[4][1]*S_inv[1][5] - P[4][2]*S_inv[2][5] - P[4][6]*S_inv[3][5] - P[4][7]*S_inv[4][5] - P[4][8]*S_inv[5][5]);
    P_up[4][10] = P[0][10]*(-P[4][0]*S_inv[0][0] - P[4][1]*S_inv[1][0] - P[4][2]*S_inv[2][0] - P[4][6]*S_inv[3][0] - P[4][7]*S_inv[4][0] - P[4][8]*S_inv[5][0]) + P[1][10]*(-P[4][0]*S_inv[0][1] - P[4][1]*S_inv[1][1] - P[4][2]*S_inv[2][1] - P[4][6]*S_inv[3][1] - P[4][7]*S_inv[4][1] - P[4][8]*S_inv[5][1]) + P[2][10]*(-P[4][0]*S_inv[0][2] - P[4][1]*S_inv[1][2] - P[4][2]*S_inv[2][2] - P[4][6]*S_inv[3][2] - P[4][7]*S_inv[4][2] - P[4][8]*S_inv[5][2]) + P[4][10] + P[6][10]*(-P[4][0]*S_inv[0][3] - P[4][1]*S_inv[1][3] - P[4][2]*S_inv[2][3] - P[4][6]*S_inv[3][3] - P[4][7]*S_inv[4][3] - P[4][8]*S_inv[5][3]) + P[7][10]*(-P[4][0]*S_inv[0][4] - P[4][1]*S_inv[1][4] - P[4][2]*S_inv[2][4] - P[4][6]*S_inv[3][4] - P[4][7]*S_inv[4][4] - P[4][8]*S_inv[5][4]) + P[8][10]*(-P[4][0]*S_inv[0][5] - P[4][1]*S_inv[1][5] - P[4][2]*S_inv[2][5] - P[4][6]*S_inv[3][5] - P[4][7]*S_inv[4][5] - P[4][8]*S_inv[5][5]);
    P_up[4][11] = P[0][11]*(-P[4][0]*S_inv[0][0] - P[4][1]*S_inv[1][0] - P[4][2]*S_inv[2][0] - P[4][6]*S_inv[3][0] - P[4][7]*S_inv[4][0] - P[4][8]*S_inv[5][0]) + P[1][11]*(-P[4][0]*S_inv[0][1] - P[4][1]*S_inv[1][1] - P[4][2]*S_inv[2][1] - P[4][6]*S_inv[3][1] - P[4][7]*S_inv[4][1] - P[4][8]*S_inv[5][1]) + P[2][11]*(-P[4][0]*S_inv[0][2] - P[4][1]*S_inv[1][2] - P[4][2]*S_inv[2][2] - P[4][6]*S_inv[3][2] - P[4][7]*S_inv[4][2] - P[4][8]*S_inv[5][2]) + P[4][11] + P[6][11]*(-P[4][0]*S_inv[0][3] - P[4][1]*S_inv[1][3] - P[4][2]*S_inv[2][3] - P[4][6]*S_inv[3][3] - P[4][7]*S_inv[4][3] - P[4][8]*S_inv[5][3]) + P[7][11]*(-P[4][0]*S_inv[0][4] - P[4][1]*S_inv[1][4] - P[4][2]*S_inv[2][4] - P[4][6]*S_inv[3][4] - P[4][7]*S_inv[4][4] - P[4][8]*S_inv[5][4]) + P[8][11]*(-P[4][0]*S_inv[0][5] - P[4][1]*S_inv[1][5] - P[4][2]*S_inv[2][5] - P[4][6]*S_inv[3][5] - P[4][7]*S_inv[4][5] - P[4][8]*S_inv[5][5]);
    P_up[4][12] = P[0][12]*(-P[4][0]*S_inv[0][0] - P[4][1]*S_inv[1][0] - P[4][2]*S_inv[2][0] - P[4][6]*S_inv[3][0] - P[4][7]*S_inv[4][0] - P[4][8]*S_inv[5][0]) + P[1][12]*(-P[4][0]*S_inv[0][1] - P[4][1]*S_inv[1][1] - P[4][2]*S_inv[2][1] - P[4][6]*S_inv[3][1] - P[4][7]*S_inv[4][1] - P[4][8]*S_inv[5][1]) + P[2][12]*(-P[4][0]*S_inv[0][2] - P[4][1]*S_inv[1][2] - P[4][2]*S_inv[2][2] - P[4][6]*S_inv[3][2] - P[4][7]*S_inv[4][2] - P[4][8]*S_inv[5][2]) + P[4][12] + P[6][12]*(-P[4][0]*S_inv[0][3] - P[4][1]*S_inv[1][3] - P[4][2]*S_inv[2][3] - P[4][6]*S_inv[3][3] - P[4][7]*S_inv[4][3] - P[4][8]*S_inv[5][3]) + P[7][12]*(-P[4][0]*S_inv[0][4] - P[4][1]*S_inv[1][4] - P[4][2]*S_inv[2][4] - P[4][6]*S_inv[3][4] - P[4][7]*S_inv[4][4] - P[4][8]*S_inv[5][4]) + P[8][12]*(-P[4][0]*S_inv[0][5] - P[4][1]*S_inv[1][5] - P[4][2]*S_inv[2][5] - P[4][6]*S_inv[3][5] - P[4][7]*S_inv[4][5] - P[4][8]*S_inv[5][5]);
    P_up[4][13] = P[0][13]*(-P[4][0]*S_inv[0][0] - P[4][1]*S_inv[1][0] - P[4][2]*S_inv[2][0] - P[4][6]*S_inv[3][0] - P[4][7]*S_inv[4][0] - P[4][8]*S_inv[5][0]) + P[1][13]*(-P[4][0]*S_inv[0][1] - P[4][1]*S_inv[1][1] - P[4][2]*S_inv[2][1] - P[4][6]*S_inv[3][1] - P[4][7]*S_inv[4][1] - P[4][8]*S_inv[5][1]) + P[2][13]*(-P[4][0]*S_inv[0][2] - P[4][1]*S_inv[1][2] - P[4][2]*S_inv[2][2] - P[4][6]*S_inv[3][2] - P[4][7]*S_inv[4][2] - P[4][8]*S_inv[5][2]) + P[4][13] + P[6][13]*(-P[4][0]*S_inv[0][3] - P[4][1]*S_inv[1][3] - P[4][2]*S_inv[2][3] - P[4][6]*S_inv[3][3] - P[4][7]*S_inv[4][3] - P[4][8]*S_inv[5][3]) + P[7][13]*(-P[4][0]*S_inv[0][4] - P[4][1]*S_inv[1][4] - P[4][2]*S_inv[2][4] - P[4][6]*S_inv[3][4] - P[4][7]*S_inv[4][4] - P[4][8]*S_inv[5][4]) + P[8][13]*(-P[4][0]*S_inv[0][5] - P[4][1]*S_inv[1][5] - P[4][2]*S_inv[2][5] - P[4][6]*S_inv[3][5] - P[4][7]*S_inv[4][5] - P[4][8]*S_inv[5][5]);
    P_up[4][14] = P[0][14]*(-P[4][0]*S_inv[0][0] - P[4][1]*S_inv[1][0] - P[4][2]*S_inv[2][0] - P[4][6]*S_inv[3][0] - P[4][7]*S_inv[4][0] - P[4][8]*S_inv[5][0]) + P[1][14]*(-P[4][0]*S_inv[0][1] - P[4][1]*S_inv[1][1] - P[4][2]*S_inv[2][1] - P[4][6]*S_inv[3][1] - P[4][7]*S_inv[4][1] - P[4][8]*S_inv[5][1]) + P[2][14]*(-P[4][0]*S_inv[0][2] - P[4][1]*S_inv[1][2] - P[4][2]*S_inv[2][2] - P[4][6]*S_inv[3][2] - P[4][7]*S_inv[4][2] - P[4][8]*S_inv[5][2]) + P[4][14] + P[6][14]*(-P[4][0]*S_inv[0][3] - P[4][1]*S_inv[1][3] - P[4][2]*S_inv[2][3] - P[4][6]*S_inv[3][3] - P[4][7]*S_inv[4][3] - P[4][8]*S_inv[5][3]) + P[7][14]*(-P[4][0]*S_inv[0][4] - P[4][1]*S_inv[1][4] - P[4][2]*S_inv[2][4] - P[4][6]*S_inv[3][4] - P[4][7]*S_inv[4][4] - P[4][8]*S_inv[5][4]) + P[8][14]*(-P[4][0]*S_inv[0][5] - P[4][1]*S_inv[1][5] - P[4][2]*S_inv[2][5] - P[4][6]*S_inv[3][5] - P[4][7]*S_inv[4][5] - P[4][8]*S_inv[5][5]);
    P_up[5][0] = P[0][0]*(-P[5][0]*S_inv[0][0] - P[5][1]*S_inv[1][0] - P[5][2]*S_inv[2][0] - P[5][6]*S_inv[3][0] - P[5][7]*S_inv[4][0] - P[5][8]*S_inv[5][0]) + P[1][0]*(-P[5][0]*S_inv[0][1] - P[5][1]*S_inv[1][1] - P[5][2]*S_inv[2][1] - P[5][6]*S_inv[3][1] - P[5][7]*S_inv[4][1] - P[5][8]*S_inv[5][1]) + P[2][0]*(-P[5][0]*S_inv[0][2] - P[5][1]*S_inv[1][2] - P[5][2]*S_inv[2][2] - P[5][6]*S_inv[3][2] - P[5][7]*S_inv[4][2] - P[5][8]*S_inv[5][2]) + P[5][0] + P[6][0]*(-P[5][0]*S_inv[0][3] - P[5][1]*S_inv[1][3] - P[5][2]*S_inv[2][3] - P[5][6]*S_inv[3][3] - P[5][7]*S_inv[4][3] - P[5][8]*S_inv[5][3]) + P[7][0]*(-P[5][0]*S_inv[0][4] - P[5][1]*S_inv[1][4] - P[5][2]*S_inv[2][4] - P[5][6]*S_inv[3][4] - P[5][7]*S_inv[4][4] - P[5][8]*S_inv[5][4]) + P[8][0]*(-P[5][0]*S_inv[0][5] - P[5][1]*S_inv[1][5] - P[5][2]*S_inv[2][5] - P[5][6]*S_inv[3][5] - P[5][7]*S_inv[4][5] - P[5][8]*S_inv[5][5]);
    P_up[5][1] = P[0][1]*(-P[5][0]*S_inv[0][0] - P[5][1]*S_inv[1][0] - P[5][2]*S_inv[2][0] - P[5][6]*S_inv[3][0] - P[5][7]*S_inv[4][0] - P[5][8]*S_inv[5][0]) + P[1][1]*(-P[5][0]*S_inv[0][1] - P[5][1]*S_inv[1][1] - P[5][2]*S_inv[2][1] - P[5][6]*S_inv[3][1] - P[5][7]*S_inv[4][1] - P[5][8]*S_inv[5][1]) + P[2][1]*(-P[5][0]*S_inv[0][2] - P[5][1]*S_inv[1][2] - P[5][2]*S_inv[2][2] - P[5][6]*S_inv[3][2] - P[5][7]*S_inv[4][2] - P[5][8]*S_inv[5][2]) + P[5][1] + P[6][1]*(-P[5][0]*S_inv[0][3] - P[5][1]*S_inv[1][3] - P[5][2]*S_inv[2][3] - P[5][6]*S_inv[3][3] - P[5][7]*S_inv[4][3] - P[5][8]*S_inv[5][3]) + P[7][1]*(-P[5][0]*S_inv[0][4] - P[5][1]*S_inv[1][4] - P[5][2]*S_inv[2][4] - P[5][6]*S_inv[3][4] - P[5][7]*S_inv[4][4] - P[5][8]*S_inv[5][4]) + P[8][1]*(-P[5][0]*S_inv[0][5] - P[5][1]*S_inv[1][5] - P[5][2]*S_inv[2][5] - P[5][6]*S_inv[3][5] - P[5][7]*S_inv[4][5] - P[5][8]*S_inv[5][5]);
    P_up[5][2] = P[0][2]*(-P[5][0]*S_inv[0][0] - P[5][1]*S_inv[1][0] - P[5][2]*S_inv[2][0] - P[5][6]*S_inv[3][0] - P[5][7]*S_inv[4][0] - P[5][8]*S_inv[5][0]) + P[1][2]*(-P[5][0]*S_inv[0][1] - P[5][1]*S_inv[1][1] - P[5][2]*S_inv[2][1] - P[5][6]*S_inv[3][1] - P[5][7]*S_inv[4][1] - P[5][8]*S_inv[5][1]) + P[2][2]*(-P[5][0]*S_inv[0][2] - P[5][1]*S_inv[1][2] - P[5][2]*S_inv[2][2] - P[5][6]*S_inv[3][2] - P[5][7]*S_inv[4][2] - P[5][8]*S_inv[5][2]) + P[5][2] + P[6][2]*(-P[5][0]*S_inv[0][3] - P[5][1]*S_inv[1][3] - P[5][2]*S_inv[2][3] - P[5][6]*S_inv[3][3] - P[5][7]*S_inv[4][3] - P[5][8]*S_inv[5][3]) + P[7][2]*(-P[5][0]*S_inv[0][4] - P[5][1]*S_inv[1][4] - P[5][2]*S_inv[2][4] - P[5][6]*S_inv[3][4] - P[5][7]*S_inv[4][4] - P[5][8]*S_inv[5][4]) + P[8][2]*(-P[5][0]*S_inv[0][5] - P[5][1]*S_inv[1][5] - P[5][2]*S_inv[2][5] - P[5][6]*S_inv[3][5] - P[5][7]*S_inv[4][5] - P[5][8]*S_inv[5][5]);
    P_up[5][3] = P[0][3]*(-P[5][0]*S_inv[0][0] - P[5][1]*S_inv[1][0] - P[5][2]*S_inv[2][0] - P[5][6]*S_inv[3][0] - P[5][7]*S_inv[4][0] - P[5][8]*S_inv[5][0]) + P[1][3]*(-P[5][0]*S_inv[0][1] - P[5][1]*S_inv[1][1] - P[5][2]*S_inv[2][1] - P[5][6]*S_inv[3][1] - P[5][7]*S_inv[4][1] - P[5][8]*S_inv[5][1]) + P[2][3]*(-P[5][0]*S_inv[0][2] - P[5][1]*S_inv[1][2] - P[5][2]*S_inv[2][2] - P[5][6]*S_inv[3][2] - P[5][7]*S_inv[4][2] - P[5][8]*S_inv[5][2]) + P[5][3] + P[6][3]*(-P[5][0]*S_inv[0][3] - P[5][1]*S_inv[1][3] - P[5][2]*S_inv[2][3] - P[5][6]*S_inv[3][3] - P[5][7]*S_inv[4][3] - P[5][8]*S_inv[5][3]) + P[7][3]*(-P[5][0]*S_inv[0][4] - P[5][1]*S_inv[1][4] - P[5][2]*S_inv[2][4] - P[5][6]*S_inv[3][4] - P[5][7]*S_inv[4][4] - P[5][8]*S_inv[5][4]) + P[8][3]*(-P[5][0]*S_inv[0][5] - P[5][1]*S_inv[1][5] - P[5][2]*S_inv[2][5] - P[5][6]*S_inv[3][5] - P[5][7]*S_inv[4][5] - P[5][8]*S_inv[5][5]);
    P_up[5][4] = P[0][4]*(-P[5][0]*S_inv[0][0] - P[5][1]*S_inv[1][0] - P[5][2]*S_inv[2][0] - P[5][6]*S_inv[3][0] - P[5][7]*S_inv[4][0] - P[5][8]*S_inv[5][0]) + P[1][4]*(-P[5][0]*S_inv[0][1] - P[5][1]*S_inv[1][1] - P[5][2]*S_inv[2][1] - P[5][6]*S_inv[3][1] - P[5][7]*S_inv[4][1] - P[5][8]*S_inv[5][1]) + P[2][4]*(-P[5][0]*S_inv[0][2] - P[5][1]*S_inv[1][2] - P[5][2]*S_inv[2][2] - P[5][6]*S_inv[3][2] - P[5][7]*S_inv[4][2] - P[5][8]*S_inv[5][2]) + P[5][4] + P[6][4]*(-P[5][0]*S_inv[0][3] - P[5][1]*S_inv[1][3] - P[5][2]*S_inv[2][3] - P[5][6]*S_inv[3][3] - P[5][7]*S_inv[4][3] - P[5][8]*S_inv[5][3]) + P[7][4]*(-P[5][0]*S_inv[0][4] - P[5][1]*S_inv[1][4] - P[5][2]*S_inv[2][4] - P[5][6]*S_inv[3][4] - P[5][7]*S_inv[4][4] - P[5][8]*S_inv[5][4]) + P[8][4]*(-P[5][0]*S_inv[0][5] - P[5][1]*S_inv[1][5] - P[5][2]*S_inv[2][5] - P[5][6]*S_inv[3][5] - P[5][7]*S_inv[4][5] - P[5][8]*S_inv[5][5]);
    P_up[5][5] = P[0][5]*(-P[5][0]*S_inv[0][0] - P[5][1]*S_inv[1][0] - P[5][2]*S_inv[2][0] - P[5][6]*S_inv[3][0] - P[5][7]*S_inv[4][0] - P[5][8]*S_inv[5][0]) + P[1][5]*(-P[5][0]*S_inv[0][1] - P[5][1]*S_inv[1][1] - P[5][2]*S_inv[2][1] - P[5][6]*S_inv[3][1] - P[5][7]*S_inv[4][1] - P[5][8]*S_inv[5][1]) + P[2][5]*(-P[5][0]*S_inv[0][2] - P[5][1]*S_inv[1][2] - P[5][2]*S_inv[2][2] - P[5][6]*S_inv[3][2] - P[5][7]*S_inv[4][2] - P[5][8]*S_inv[5][2]) + P[5][5] + P[6][5]*(-P[5][0]*S_inv[0][3] - P[5][1]*S_inv[1][3] - P[5][2]*S_inv[2][3] - P[5][6]*S_inv[3][3] - P[5][7]*S_inv[4][3] - P[5][8]*S_inv[5][3]) + P[7][5]*(-P[5][0]*S_inv[0][4] - P[5][1]*S_inv[1][4] - P[5][2]*S_inv[2][4] - P[5][6]*S_inv[3][4] - P[5][7]*S_inv[4][4] - P[5][8]*S_inv[5][4]) + P[8][5]*(-P[5][0]*S_inv[0][5] - P[5][1]*S_inv[1][5] - P[5][2]*S_inv[2][5] - P[5][6]*S_inv[3][5] - P[5][7]*S_inv[4][5] - P[5][8]*S_inv[5][5]);
    P_up[5][6] = P[0][6]*(-P[5][0]*S_inv[0][0] - P[5][1]*S_inv[1][0] - P[5][2]*S_inv[2][0] - P[5][6]*S_inv[3][0] - P[5][7]*S_inv[4][0] - P[5][8]*S_inv[5][0]) + P[1][6]*(-P[5][0]*S_inv[0][1] - P[5][1]*S_inv[1][1] - P[5][2]*S_inv[2][1] - P[5][6]*S_inv[3][1] - P[5][7]*S_inv[4][1] - P[5][8]*S_inv[5][1]) + P[2][6]*(-P[5][0]*S_inv[0][2] - P[5][1]*S_inv[1][2] - P[5][2]*S_inv[2][2] - P[5][6]*S_inv[3][2] - P[5][7]*S_inv[4][2] - P[5][8]*S_inv[5][2]) + P[5][6] + P[6][6]*(-P[5][0]*S_inv[0][3] - P[5][1]*S_inv[1][3] - P[5][2]*S_inv[2][3] - P[5][6]*S_inv[3][3] - P[5][7]*S_inv[4][3] - P[5][8]*S_inv[5][3]) + P[7][6]*(-P[5][0]*S_inv[0][4] - P[5][1]*S_inv[1][4] - P[5][2]*S_inv[2][4] - P[5][6]*S_inv[3][4] - P[5][7]*S_inv[4][4] - P[5][8]*S_inv[5][4]) + P[8][6]*(-P[5][0]*S_inv[0][5] - P[5][1]*S_inv[1][5] - P[5][2]*S_inv[2][5] - P[5][6]*S_inv[3][5] - P[5][7]*S_inv[4][5] - P[5][8]*S_inv[5][5]);
    P_up[5][7] = P[0][7]*(-P[5][0]*S_inv[0][0] - P[5][1]*S_inv[1][0] - P[5][2]*S_inv[2][0] - P[5][6]*S_inv[3][0] - P[5][7]*S_inv[4][0] - P[5][8]*S_inv[5][0]) + P[1][7]*(-P[5][0]*S_inv[0][1] - P[5][1]*S_inv[1][1] - P[5][2]*S_inv[2][1] - P[5][6]*S_inv[3][1] - P[5][7]*S_inv[4][1] - P[5][8]*S_inv[5][1]) + P[2][7]*(-P[5][0]*S_inv[0][2] - P[5][1]*S_inv[1][2] - P[5][2]*S_inv[2][2] - P[5][6]*S_inv[3][2] - P[5][7]*S_inv[4][2] - P[5][8]*S_inv[5][2]) + P[5][7] + P[6][7]*(-P[5][0]*S_inv[0][3] - P[5][1]*S_inv[1][3] - P[5][2]*S_inv[2][3] - P[5][6]*S_inv[3][3] - P[5][7]*S_inv[4][3] - P[5][8]*S_inv[5][3]) + P[7][7]*(-P[5][0]*S_inv[0][4] - P[5][1]*S_inv[1][4] - P[5][2]*S_inv[2][4] - P[5][6]*S_inv[3][4] - P[5][7]*S_inv[4][4] - P[5][8]*S_inv[5][4]) + P[8][7]*(-P[5][0]*S_inv[0][5] - P[5][1]*S_inv[1][5] - P[5][2]*S_inv[2][5] - P[5][6]*S_inv[3][5] - P[5][7]*S_inv[4][5] - P[5][8]*S_inv[5][5]);
    P_up[5][8] = P[0][8]*(-P[5][0]*S_inv[0][0] - P[5][1]*S_inv[1][0] - P[5][2]*S_inv[2][0] - P[5][6]*S_inv[3][0] - P[5][7]*S_inv[4][0] - P[5][8]*S_inv[5][0]) + P[1][8]*(-P[5][0]*S_inv[0][1] - P[5][1]*S_inv[1][1] - P[5][2]*S_inv[2][1] - P[5][6]*S_inv[3][1] - P[5][7]*S_inv[4][1] - P[5][8]*S_inv[5][1]) + P[2][8]*(-P[5][0]*S_inv[0][2] - P[5][1]*S_inv[1][2] - P[5][2]*S_inv[2][2] - P[5][6]*S_inv[3][2] - P[5][7]*S_inv[4][2] - P[5][8]*S_inv[5][2]) + P[5][8] + P[6][8]*(-P[5][0]*S_inv[0][3] - P[5][1]*S_inv[1][3] - P[5][2]*S_inv[2][3] - P[5][6]*S_inv[3][3] - P[5][7]*S_inv[4][3] - P[5][8]*S_inv[5][3]) + P[7][8]*(-P[5][0]*S_inv[0][4] - P[5][1]*S_inv[1][4] - P[5][2]*S_inv[2][4] - P[5][6]*S_inv[3][4] - P[5][7]*S_inv[4][4] - P[5][8]*S_inv[5][4]) + P[8][8]*(-P[5][0]*S_inv[0][5] - P[5][1]*S_inv[1][5] - P[5][2]*S_inv[2][5] - P[5][6]*S_inv[3][5] - P[5][7]*S_inv[4][5] - P[5][8]*S_inv[5][5]);
    P_up[5][9] = P[0][9]*(-P[5][0]*S_inv[0][0] - P[5][1]*S_inv[1][0] - P[5][2]*S_inv[2][0] - P[5][6]*S_inv[3][0] - P[5][7]*S_inv[4][0] - P[5][8]*S_inv[5][0]) + P[1][9]*(-P[5][0]*S_inv[0][1] - P[5][1]*S_inv[1][1] - P[5][2]*S_inv[2][1] - P[5][6]*S_inv[3][1] - P[5][7]*S_inv[4][1] - P[5][8]*S_inv[5][1]) + P[2][9]*(-P[5][0]*S_inv[0][2] - P[5][1]*S_inv[1][2] - P[5][2]*S_inv[2][2] - P[5][6]*S_inv[3][2] - P[5][7]*S_inv[4][2] - P[5][8]*S_inv[5][2]) + P[5][9] + P[6][9]*(-P[5][0]*S_inv[0][3] - P[5][1]*S_inv[1][3] - P[5][2]*S_inv[2][3] - P[5][6]*S_inv[3][3] - P[5][7]*S_inv[4][3] - P[5][8]*S_inv[5][3]) + P[7][9]*(-P[5][0]*S_inv[0][4] - P[5][1]*S_inv[1][4] - P[5][2]*S_inv[2][4] - P[5][6]*S_inv[3][4] - P[5][7]*S_inv[4][4] - P[5][8]*S_inv[5][4]) + P[8][9]*(-P[5][0]*S_inv[0][5] - P[5][1]*S_inv[1][5] - P[5][2]*S_inv[2][5] - P[5][6]*S_inv[3][5] - P[5][7]*S_inv[4][5] - P[5][8]*S_inv[5][5]);
    P_up[5][10] = P[0][10]*(-P[5][0]*S_inv[0][0] - P[5][1]*S_inv[1][0] - P[5][2]*S_inv[2][0] - P[5][6]*S_inv[3][0] - P[5][7]*S_inv[4][0] - P[5][8]*S_inv[5][0]) + P[1][10]*(-P[5][0]*S_inv[0][1] - P[5][1]*S_inv[1][1] - P[5][2]*S_inv[2][1] - P[5][6]*S_inv[3][1] - P[5][7]*S_inv[4][1] - P[5][8]*S_inv[5][1]) + P[2][10]*(-P[5][0]*S_inv[0][2] - P[5][1]*S_inv[1][2] - P[5][2]*S_inv[2][2] - P[5][6]*S_inv[3][2] - P[5][7]*S_inv[4][2] - P[5][8]*S_inv[5][2]) + P[5][10] + P[6][10]*(-P[5][0]*S_inv[0][3] - P[5][1]*S_inv[1][3] - P[5][2]*S_inv[2][3] - P[5][6]*S_inv[3][3] - P[5][7]*S_inv[4][3] - P[5][8]*S_inv[5][3]) + P[7][10]*(-P[5][0]*S_inv[0][4] - P[5][1]*S_inv[1][4] - P[5][2]*S_inv[2][4] - P[5][6]*S_inv[3][4] - P[5][7]*S_inv[4][4] - P[5][8]*S_inv[5][4]) + P[8][10]*(-P[5][0]*S_inv[0][5] - P[5][1]*S_inv[1][5] - P[5][2]*S_inv[2][5] - P[5][6]*S_inv[3][5] - P[5][7]*S_inv[4][5] - P[5][8]*S_inv[5][5]);
    P_up[5][11] = P[0][11]*(-P[5][0]*S_inv[0][0] - P[5][1]*S_inv[1][0] - P[5][2]*S_inv[2][0] - P[5][6]*S_inv[3][0] - P[5][7]*S_inv[4][0] - P[5][8]*S_inv[5][0]) + P[1][11]*(-P[5][0]*S_inv[0][1] - P[5][1]*S_inv[1][1] - P[5][2]*S_inv[2][1] - P[5][6]*S_inv[3][1] - P[5][7]*S_inv[4][1] - P[5][8]*S_inv[5][1]) + P[2][11]*(-P[5][0]*S_inv[0][2] - P[5][1]*S_inv[1][2] - P[5][2]*S_inv[2][2] - P[5][6]*S_inv[3][2] - P[5][7]*S_inv[4][2] - P[5][8]*S_inv[5][2]) + P[5][11] + P[6][11]*(-P[5][0]*S_inv[0][3] - P[5][1]*S_inv[1][3] - P[5][2]*S_inv[2][3] - P[5][6]*S_inv[3][3] - P[5][7]*S_inv[4][3] - P[5][8]*S_inv[5][3]) + P[7][11]*(-P[5][0]*S_inv[0][4] - P[5][1]*S_inv[1][4] - P[5][2]*S_inv[2][4] - P[5][6]*S_inv[3][4] - P[5][7]*S_inv[4][4] - P[5][8]*S_inv[5][4]) + P[8][11]*(-P[5][0]*S_inv[0][5] - P[5][1]*S_inv[1][5] - P[5][2]*S_inv[2][5] - P[5][6]*S_inv[3][5] - P[5][7]*S_inv[4][5] - P[5][8]*S_inv[5][5]);
    P_up[5][12] = P[0][12]*(-P[5][0]*S_inv[0][0] - P[5][1]*S_inv[1][0] - P[5][2]*S_inv[2][0] - P[5][6]*S_inv[3][0] - P[5][7]*S_inv[4][0] - P[5][8]*S_inv[5][0]) + P[1][12]*(-P[5][0]*S_inv[0][1] - P[5][1]*S_inv[1][1] - P[5][2]*S_inv[2][1] - P[5][6]*S_inv[3][1] - P[5][7]*S_inv[4][1] - P[5][8]*S_inv[5][1]) + P[2][12]*(-P[5][0]*S_inv[0][2] - P[5][1]*S_inv[1][2] - P[5][2]*S_inv[2][2] - P[5][6]*S_inv[3][2] - P[5][7]*S_inv[4][2] - P[5][8]*S_inv[5][2]) + P[5][12] + P[6][12]*(-P[5][0]*S_inv[0][3] - P[5][1]*S_inv[1][3] - P[5][2]*S_inv[2][3] - P[5][6]*S_inv[3][3] - P[5][7]*S_inv[4][3] - P[5][8]*S_inv[5][3]) + P[7][12]*(-P[5][0]*S_inv[0][4] - P[5][1]*S_inv[1][4] - P[5][2]*S_inv[2][4] - P[5][6]*S_inv[3][4] - P[5][7]*S_inv[4][4] - P[5][8]*S_inv[5][4]) + P[8][12]*(-P[5][0]*S_inv[0][5] - P[5][1]*S_inv[1][5] - P[5][2]*S_inv[2][5] - P[5][6]*S_inv[3][5] - P[5][7]*S_inv[4][5] - P[5][8]*S_inv[5][5]);
    P_up[5][13] = P[0][13]*(-P[5][0]*S_inv[0][0] - P[5][1]*S_inv[1][0] - P[5][2]*S_inv[2][0] - P[5][6]*S_inv[3][0] - P[5][7]*S_inv[4][0] - P[5][8]*S_inv[5][0]) + P[1][13]*(-P[5][0]*S_inv[0][1] - P[5][1]*S_inv[1][1] - P[5][2]*S_inv[2][1] - P[5][6]*S_inv[3][1] - P[5][7]*S_inv[4][1] - P[5][8]*S_inv[5][1]) + P[2][13]*(-P[5][0]*S_inv[0][2] - P[5][1]*S_inv[1][2] - P[5][2]*S_inv[2][2] - P[5][6]*S_inv[3][2] - P[5][7]*S_inv[4][2] - P[5][8]*S_inv[5][2]) + P[5][13] + P[6][13]*(-P[5][0]*S_inv[0][3] - P[5][1]*S_inv[1][3] - P[5][2]*S_inv[2][3] - P[5][6]*S_inv[3][3] - P[5][7]*S_inv[4][3] - P[5][8]*S_inv[5][3]) + P[7][13]*(-P[5][0]*S_inv[0][4] - P[5][1]*S_inv[1][4] - P[5][2]*S_inv[2][4] - P[5][6]*S_inv[3][4] - P[5][7]*S_inv[4][4] - P[5][8]*S_inv[5][4]) + P[8][13]*(-P[5][0]*S_inv[0][5] - P[5][1]*S_inv[1][5] - P[5][2]*S_inv[2][5] - P[5][6]*S_inv[3][5] - P[5][7]*S_inv[4][5] - P[5][8]*S_inv[5][5]);
    P_up[5][14] = P[0][14]*(-P[5][0]*S_inv[0][0] - P[5][1]*S_inv[1][0] - P[5][2]*S_inv[2][0] - P[5][6]*S_inv[3][0] - P[5][7]*S_inv[4][0] - P[5][8]*S_inv[5][0]) + P[1][14]*(-P[5][0]*S_inv[0][1] - P[5][1]*S_inv[1][1] - P[5][2]*S_inv[2][1] - P[5][6]*S_inv[3][1] - P[5][7]*S_inv[4][1] - P[5][8]*S_inv[5][1]) + P[2][14]*(-P[5][0]*S_inv[0][2] - P[5][1]*S_inv[1][2] - P[5][2]*S_inv[2][2] - P[5][6]*S_inv[3][2] - P[5][7]*S_inv[4][2] - P[5][8]*S_inv[5][2]) + P[5][14] + P[6][14]*(-P[5][0]*S_inv[0][3] - P[5][1]*S_inv[1][3] - P[5][2]*S_inv[2][3] - P[5][6]*S_inv[3][3] - P[5][7]*S_inv[4][3] - P[5][8]*S_inv[5][3]) + P[7][14]*(-P[5][0]*S_inv[0][4] - P[5][1]*S_inv[1][4] - P[5][2]*S_inv[2][4] - P[5][6]*S_inv[3][4] - P[5][7]*S_inv[4][4] - P[5][8]*S_inv[5][4]) + P[8][14]*(-P[5][0]*S_inv[0][5] - P[5][1]*S_inv[1][5] - P[5][2]*S_inv[2][5] - P[5][6]*S_inv[3][5] - P[5][7]*S_inv[4][5] - P[5][8]*S_inv[5][5]);
    P_up[6][0] = P[0][0]*(-P[6][0]*S_inv[0][0] - P[6][1]*S_inv[1][0] - P[6][2]*S_inv[2][0] - P[6][6]*S_inv[3][0] - P[6][7]*S_inv[4][0] - P[6][8]*S_inv[5][0]) + P[1][0]*(-P[6][0]*S_inv[0][1] - P[6][1]*S_inv[1][1] - P[6][2]*S_inv[2][1] - P[6][6]*S_inv[3][1] - P[6][7]*S_inv[4][1] - P[6][8]*S_inv[5][1]) + P[2][0]*(-P[6][0]*S_inv[0][2] - P[6][1]*S_inv[1][2] - P[6][2]*S_inv[2][2] - P[6][6]*S_inv[3][2] - P[6][7]*S_inv[4][2] - P[6][8]*S_inv[5][2]) + P[6][0]*(-P[6][0]*S_inv[0][3] - P[6][1]*S_inv[1][3] - P[6][2]*S_inv[2][3] - P[6][6]*S_inv[3][3] - P[6][7]*S_inv[4][3] - P[6][8]*S_inv[5][3] + 1) + P[7][0]*(-P[6][0]*S_inv[0][4] - P[6][1]*S_inv[1][4] - P[6][2]*S_inv[2][4] - P[6][6]*S_inv[3][4] - P[6][7]*S_inv[4][4] - P[6][8]*S_inv[5][4]) + P[8][0]*(-P[6][0]*S_inv[0][5] - P[6][1]*S_inv[1][5] - P[6][2]*S_inv[2][5] - P[6][6]*S_inv[3][5] - P[6][7]*S_inv[4][5] - P[6][8]*S_inv[5][5]);
    P_up[6][1] = P[0][1]*(-P[6][0]*S_inv[0][0] - P[6][1]*S_inv[1][0] - P[6][2]*S_inv[2][0] - P[6][6]*S_inv[3][0] - P[6][7]*S_inv[4][0] - P[6][8]*S_inv[5][0]) + P[1][1]*(-P[6][0]*S_inv[0][1] - P[6][1]*S_inv[1][1] - P[6][2]*S_inv[2][1] - P[6][6]*S_inv[3][1] - P[6][7]*S_inv[4][1] - P[6][8]*S_inv[5][1]) + P[2][1]*(-P[6][0]*S_inv[0][2] - P[6][1]*S_inv[1][2] - P[6][2]*S_inv[2][2] - P[6][6]*S_inv[3][2] - P[6][7]*S_inv[4][2] - P[6][8]*S_inv[5][2]) + P[6][1]*(-P[6][0]*S_inv[0][3] - P[6][1]*S_inv[1][3] - P[6][2]*S_inv[2][3] - P[6][6]*S_inv[3][3] - P[6][7]*S_inv[4][3] - P[6][8]*S_inv[5][3] + 1) + P[7][1]*(-P[6][0]*S_inv[0][4] - P[6][1]*S_inv[1][4] - P[6][2]*S_inv[2][4] - P[6][6]*S_inv[3][4] - P[6][7]*S_inv[4][4] - P[6][8]*S_inv[5][4]) + P[8][1]*(-P[6][0]*S_inv[0][5] - P[6][1]*S_inv[1][5] - P[6][2]*S_inv[2][5] - P[6][6]*S_inv[3][5] - P[6][7]*S_inv[4][5] - P[6][8]*S_inv[5][5]);
    P_up[6][2] = P[0][2]*(-P[6][0]*S_inv[0][0] - P[6][1]*S_inv[1][0] - P[6][2]*S_inv[2][0] - P[6][6]*S_inv[3][0] - P[6][7]*S_inv[4][0] - P[6][8]*S_inv[5][0]) + P[1][2]*(-P[6][0]*S_inv[0][1] - P[6][1]*S_inv[1][1] - P[6][2]*S_inv[2][1] - P[6][6]*S_inv[3][1] - P[6][7]*S_inv[4][1] - P[6][8]*S_inv[5][1]) + P[2][2]*(-P[6][0]*S_inv[0][2] - P[6][1]*S_inv[1][2] - P[6][2]*S_inv[2][2] - P[6][6]*S_inv[3][2] - P[6][7]*S_inv[4][2] - P[6][8]*S_inv[5][2]) + P[6][2]*(-P[6][0]*S_inv[0][3] - P[6][1]*S_inv[1][3] - P[6][2]*S_inv[2][3] - P[6][6]*S_inv[3][3] - P[6][7]*S_inv[4][3] - P[6][8]*S_inv[5][3] + 1) + P[7][2]*(-P[6][0]*S_inv[0][4] - P[6][1]*S_inv[1][4] - P[6][2]*S_inv[2][4] - P[6][6]*S_inv[3][4] - P[6][7]*S_inv[4][4] - P[6][8]*S_inv[5][4]) + P[8][2]*(-P[6][0]*S_inv[0][5] - P[6][1]*S_inv[1][5] - P[6][2]*S_inv[2][5] - P[6][6]*S_inv[3][5] - P[6][7]*S_inv[4][5] - P[6][8]*S_inv[5][5]);
    P_up[6][3] = P[0][3]*(-P[6][0]*S_inv[0][0] - P[6][1]*S_inv[1][0] - P[6][2]*S_inv[2][0] - P[6][6]*S_inv[3][0] - P[6][7]*S_inv[4][0] - P[6][8]*S_inv[5][0]) + P[1][3]*(-P[6][0]*S_inv[0][1] - P[6][1]*S_inv[1][1] - P[6][2]*S_inv[2][1] - P[6][6]*S_inv[3][1] - P[6][7]*S_inv[4][1] - P[6][8]*S_inv[5][1]) + P[2][3]*(-P[6][0]*S_inv[0][2] - P[6][1]*S_inv[1][2] - P[6][2]*S_inv[2][2] - P[6][6]*S_inv[3][2] - P[6][7]*S_inv[4][2] - P[6][8]*S_inv[5][2]) + P[6][3]*(-P[6][0]*S_inv[0][3] - P[6][1]*S_inv[1][3] - P[6][2]*S_inv[2][3] - P[6][6]*S_inv[3][3] - P[6][7]*S_inv[4][3] - P[6][8]*S_inv[5][3] + 1) + P[7][3]*(-P[6][0]*S_inv[0][4] - P[6][1]*S_inv[1][4] - P[6][2]*S_inv[2][4] - P[6][6]*S_inv[3][4] - P[6][7]*S_inv[4][4] - P[6][8]*S_inv[5][4]) + P[8][3]*(-P[6][0]*S_inv[0][5] - P[6][1]*S_inv[1][5] - P[6][2]*S_inv[2][5] - P[6][6]*S_inv[3][5] - P[6][7]*S_inv[4][5] - P[6][8]*S_inv[5][5]);
    P_up[6][4] = P[0][4]*(-P[6][0]*S_inv[0][0] - P[6][1]*S_inv[1][0] - P[6][2]*S_inv[2][0] - P[6][6]*S_inv[3][0] - P[6][7]*S_inv[4][0] - P[6][8]*S_inv[5][0]) + P[1][4]*(-P[6][0]*S_inv[0][1] - P[6][1]*S_inv[1][1] - P[6][2]*S_inv[2][1] - P[6][6]*S_inv[3][1] - P[6][7]*S_inv[4][1] - P[6][8]*S_inv[5][1]) + P[2][4]*(-P[6][0]*S_inv[0][2] - P[6][1]*S_inv[1][2] - P[6][2]*S_inv[2][2] - P[6][6]*S_inv[3][2] - P[6][7]*S_inv[4][2] - P[6][8]*S_inv[5][2]) + P[6][4]*(-P[6][0]*S_inv[0][3] - P[6][1]*S_inv[1][3] - P[6][2]*S_inv[2][3] - P[6][6]*S_inv[3][3] - P[6][7]*S_inv[4][3] - P[6][8]*S_inv[5][3] + 1) + P[7][4]*(-P[6][0]*S_inv[0][4] - P[6][1]*S_inv[1][4] - P[6][2]*S_inv[2][4] - P[6][6]*S_inv[3][4] - P[6][7]*S_inv[4][4] - P[6][8]*S_inv[5][4]) + P[8][4]*(-P[6][0]*S_inv[0][5] - P[6][1]*S_inv[1][5] - P[6][2]*S_inv[2][5] - P[6][6]*S_inv[3][5] - P[6][7]*S_inv[4][5] - P[6][8]*S_inv[5][5]);
    P_up[6][5] = P[0][5]*(-P[6][0]*S_inv[0][0] - P[6][1]*S_inv[1][0] - P[6][2]*S_inv[2][0] - P[6][6]*S_inv[3][0] - P[6][7]*S_inv[4][0] - P[6][8]*S_inv[5][0]) + P[1][5]*(-P[6][0]*S_inv[0][1] - P[6][1]*S_inv[1][1] - P[6][2]*S_inv[2][1] - P[6][6]*S_inv[3][1] - P[6][7]*S_inv[4][1] - P[6][8]*S_inv[5][1]) + P[2][5]*(-P[6][0]*S_inv[0][2] - P[6][1]*S_inv[1][2] - P[6][2]*S_inv[2][2] - P[6][6]*S_inv[3][2] - P[6][7]*S_inv[4][2] - P[6][8]*S_inv[5][2]) + P[6][5]*(-P[6][0]*S_inv[0][3] - P[6][1]*S_inv[1][3] - P[6][2]*S_inv[2][3] - P[6][6]*S_inv[3][3] - P[6][7]*S_inv[4][3] - P[6][8]*S_inv[5][3] + 1) + P[7][5]*(-P[6][0]*S_inv[0][4] - P[6][1]*S_inv[1][4] - P[6][2]*S_inv[2][4] - P[6][6]*S_inv[3][4] - P[6][7]*S_inv[4][4] - P[6][8]*S_inv[5][4]) + P[8][5]*(-P[6][0]*S_inv[0][5] - P[6][1]*S_inv[1][5] - P[6][2]*S_inv[2][5] - P[6][6]*S_inv[3][5] - P[6][7]*S_inv[4][5] - P[6][8]*S_inv[5][5]);
    P_up[6][6] = P[0][6]*(-P[6][0]*S_inv[0][0] - P[6][1]*S_inv[1][0] - P[6][2]*S_inv[2][0] - P[6][6]*S_inv[3][0] - P[6][7]*S_inv[4][0] - P[6][8]*S_inv[5][0]) + P[1][6]*(-P[6][0]*S_inv[0][1] - P[6][1]*S_inv[1][1] - P[6][2]*S_inv[2][1] - P[6][6]*S_inv[3][1] - P[6][7]*S_inv[4][1] - P[6][8]*S_inv[5][1]) + P[2][6]*(-P[6][0]*S_inv[0][2] - P[6][1]*S_inv[1][2] - P[6][2]*S_inv[2][2] - P[6][6]*S_inv[3][2] - P[6][7]*S_inv[4][2] - P[6][8]*S_inv[5][2]) + P[6][6]*(-P[6][0]*S_inv[0][3] - P[6][1]*S_inv[1][3] - P[6][2]*S_inv[2][3] - P[6][6]*S_inv[3][3] - P[6][7]*S_inv[4][3] - P[6][8]*S_inv[5][3] + 1) + P[7][6]*(-P[6][0]*S_inv[0][4] - P[6][1]*S_inv[1][4] - P[6][2]*S_inv[2][4] - P[6][6]*S_inv[3][4] - P[6][7]*S_inv[4][4] - P[6][8]*S_inv[5][4]) + P[8][6]*(-P[6][0]*S_inv[0][5] - P[6][1]*S_inv[1][5] - P[6][2]*S_inv[2][5] - P[6][6]*S_inv[3][5] - P[6][7]*S_inv[4][5] - P[6][8]*S_inv[5][5]);
    P_up[6][7] = P[0][7]*(-P[6][0]*S_inv[0][0] - P[6][1]*S_inv[1][0] - P[6][2]*S_inv[2][0] - P[6][6]*S_inv[3][0] - P[6][7]*S_inv[4][0] - P[6][8]*S_inv[5][0]) + P[1][7]*(-P[6][0]*S_inv[0][1] - P[6][1]*S_inv[1][1] - P[6][2]*S_inv[2][1] - P[6][6]*S_inv[3][1] - P[6][7]*S_inv[4][1] - P[6][8]*S_inv[5][1]) + P[2][7]*(-P[6][0]*S_inv[0][2] - P[6][1]*S_inv[1][2] - P[6][2]*S_inv[2][2] - P[6][6]*S_inv[3][2] - P[6][7]*S_inv[4][2] - P[6][8]*S_inv[5][2]) + P[6][7]*(-P[6][0]*S_inv[0][3] - P[6][1]*S_inv[1][3] - P[6][2]*S_inv[2][3] - P[6][6]*S_inv[3][3] - P[6][7]*S_inv[4][3] - P[6][8]*S_inv[5][3] + 1) + P[7][7]*(-P[6][0]*S_inv[0][4] - P[6][1]*S_inv[1][4] - P[6][2]*S_inv[2][4] - P[6][6]*S_inv[3][4] - P[6][7]*S_inv[4][4] - P[6][8]*S_inv[5][4]) + P[8][7]*(-P[6][0]*S_inv[0][5] - P[6][1]*S_inv[1][5] - P[6][2]*S_inv[2][5] - P[6][6]*S_inv[3][5] - P[6][7]*S_inv[4][5] - P[6][8]*S_inv[5][5]);
    P_up[6][8] = P[0][8]*(-P[6][0]*S_inv[0][0] - P[6][1]*S_inv[1][0] - P[6][2]*S_inv[2][0] - P[6][6]*S_inv[3][0] - P[6][7]*S_inv[4][0] - P[6][8]*S_inv[5][0]) + P[1][8]*(-P[6][0]*S_inv[0][1] - P[6][1]*S_inv[1][1] - P[6][2]*S_inv[2][1] - P[6][6]*S_inv[3][1] - P[6][7]*S_inv[4][1] - P[6][8]*S_inv[5][1]) + P[2][8]*(-P[6][0]*S_inv[0][2] - P[6][1]*S_inv[1][2] - P[6][2]*S_inv[2][2] - P[6][6]*S_inv[3][2] - P[6][7]*S_inv[4][2] - P[6][8]*S_inv[5][2]) + P[6][8]*(-P[6][0]*S_inv[0][3] - P[6][1]*S_inv[1][3] - P[6][2]*S_inv[2][3] - P[6][6]*S_inv[3][3] - P[6][7]*S_inv[4][3] - P[6][8]*S_inv[5][3] + 1) + P[7][8]*(-P[6][0]*S_inv[0][4] - P[6][1]*S_inv[1][4] - P[6][2]*S_inv[2][4] - P[6][6]*S_inv[3][4] - P[6][7]*S_inv[4][4] - P[6][8]*S_inv[5][4]) + P[8][8]*(-P[6][0]*S_inv[0][5] - P[6][1]*S_inv[1][5] - P[6][2]*S_inv[2][5] - P[6][6]*S_inv[3][5] - P[6][7]*S_inv[4][5] - P[6][8]*S_inv[5][5]);
    P_up[6][9] = P[0][9]*(-P[6][0]*S_inv[0][0] - P[6][1]*S_inv[1][0] - P[6][2]*S_inv[2][0] - P[6][6]*S_inv[3][0] - P[6][7]*S_inv[4][0] - P[6][8]*S_inv[5][0]) + P[1][9]*(-P[6][0]*S_inv[0][1] - P[6][1]*S_inv[1][1] - P[6][2]*S_inv[2][1] - P[6][6]*S_inv[3][1] - P[6][7]*S_inv[4][1] - P[6][8]*S_inv[5][1]) + P[2][9]*(-P[6][0]*S_inv[0][2] - P[6][1]*S_inv[1][2] - P[6][2]*S_inv[2][2] - P[6][6]*S_inv[3][2] - P[6][7]*S_inv[4][2] - P[6][8]*S_inv[5][2]) + P[6][9]*(-P[6][0]*S_inv[0][3] - P[6][1]*S_inv[1][3] - P[6][2]*S_inv[2][3] - P[6][6]*S_inv[3][3] - P[6][7]*S_inv[4][3] - P[6][8]*S_inv[5][3] + 1) + P[7][9]*(-P[6][0]*S_inv[0][4] - P[6][1]*S_inv[1][4] - P[6][2]*S_inv[2][4] - P[6][6]*S_inv[3][4] - P[6][7]*S_inv[4][4] - P[6][8]*S_inv[5][4]) + P[8][9]*(-P[6][0]*S_inv[0][5] - P[6][1]*S_inv[1][5] - P[6][2]*S_inv[2][5] - P[6][6]*S_inv[3][5] - P[6][7]*S_inv[4][5] - P[6][8]*S_inv[5][5]);
    P_up[6][10] = P[0][10]*(-P[6][0]*S_inv[0][0] - P[6][1]*S_inv[1][0] - P[6][2]*S_inv[2][0] - P[6][6]*S_inv[3][0] - P[6][7]*S_inv[4][0] - P[6][8]*S_inv[5][0]) + P[1][10]*(-P[6][0]*S_inv[0][1] - P[6][1]*S_inv[1][1] - P[6][2]*S_inv[2][1] - P[6][6]*S_inv[3][1] - P[6][7]*S_inv[4][1] - P[6][8]*S_inv[5][1]) + P[2][10]*(-P[6][0]*S_inv[0][2] - P[6][1]*S_inv[1][2] - P[6][2]*S_inv[2][2] - P[6][6]*S_inv[3][2] - P[6][7]*S_inv[4][2] - P[6][8]*S_inv[5][2]) + P[6][10]*(-P[6][0]*S_inv[0][3] - P[6][1]*S_inv[1][3] - P[6][2]*S_inv[2][3] - P[6][6]*S_inv[3][3] - P[6][7]*S_inv[4][3] - P[6][8]*S_inv[5][3] + 1) + P[7][10]*(-P[6][0]*S_inv[0][4] - P[6][1]*S_inv[1][4] - P[6][2]*S_inv[2][4] - P[6][6]*S_inv[3][4] - P[6][7]*S_inv[4][4] - P[6][8]*S_inv[5][4]) + P[8][10]*(-P[6][0]*S_inv[0][5] - P[6][1]*S_inv[1][5] - P[6][2]*S_inv[2][5] - P[6][6]*S_inv[3][5] - P[6][7]*S_inv[4][5] - P[6][8]*S_inv[5][5]);
    P_up[6][11] = P[0][11]*(-P[6][0]*S_inv[0][0] - P[6][1]*S_inv[1][0] - P[6][2]*S_inv[2][0] - P[6][6]*S_inv[3][0] - P[6][7]*S_inv[4][0] - P[6][8]*S_inv[5][0]) + P[1][11]*(-P[6][0]*S_inv[0][1] - P[6][1]*S_inv[1][1] - P[6][2]*S_inv[2][1] - P[6][6]*S_inv[3][1] - P[6][7]*S_inv[4][1] - P[6][8]*S_inv[5][1]) + P[2][11]*(-P[6][0]*S_inv[0][2] - P[6][1]*S_inv[1][2] - P[6][2]*S_inv[2][2] - P[6][6]*S_inv[3][2] - P[6][7]*S_inv[4][2] - P[6][8]*S_inv[5][2]) + P[6][11]*(-P[6][0]*S_inv[0][3] - P[6][1]*S_inv[1][3] - P[6][2]*S_inv[2][3] - P[6][6]*S_inv[3][3] - P[6][7]*S_inv[4][3] - P[6][8]*S_inv[5][3] + 1) + P[7][11]*(-P[6][0]*S_inv[0][4] - P[6][1]*S_inv[1][4] - P[6][2]*S_inv[2][4] - P[6][6]*S_inv[3][4] - P[6][7]*S_inv[4][4] - P[6][8]*S_inv[5][4]) + P[8][11]*(-P[6][0]*S_inv[0][5] - P[6][1]*S_inv[1][5] - P[6][2]*S_inv[2][5] - P[6][6]*S_inv[3][5] - P[6][7]*S_inv[4][5] - P[6][8]*S_inv[5][5]);
    P_up[6][12] = P[0][12]*(-P[6][0]*S_inv[0][0] - P[6][1]*S_inv[1][0] - P[6][2]*S_inv[2][0] - P[6][6]*S_inv[3][0] - P[6][7]*S_inv[4][0] - P[6][8]*S_inv[5][0]) + P[1][12]*(-P[6][0]*S_inv[0][1] - P[6][1]*S_inv[1][1] - P[6][2]*S_inv[2][1] - P[6][6]*S_inv[3][1] - P[6][7]*S_inv[4][1] - P[6][8]*S_inv[5][1]) + P[2][12]*(-P[6][0]*S_inv[0][2] - P[6][1]*S_inv[1][2] - P[6][2]*S_inv[2][2] - P[6][6]*S_inv[3][2] - P[6][7]*S_inv[4][2] - P[6][8]*S_inv[5][2]) + P[6][12]*(-P[6][0]*S_inv[0][3] - P[6][1]*S_inv[1][3] - P[6][2]*S_inv[2][3] - P[6][6]*S_inv[3][3] - P[6][7]*S_inv[4][3] - P[6][8]*S_inv[5][3] + 1) + P[7][12]*(-P[6][0]*S_inv[0][4] - P[6][1]*S_inv[1][4] - P[6][2]*S_inv[2][4] - P[6][6]*S_inv[3][4] - P[6][7]*S_inv[4][4] - P[6][8]*S_inv[5][4]) + P[8][12]*(-P[6][0]*S_inv[0][5] - P[6][1]*S_inv[1][5] - P[6][2]*S_inv[2][5] - P[6][6]*S_inv[3][5] - P[6][7]*S_inv[4][5] - P[6][8]*S_inv[5][5]);
    P_up[6][13] = P[0][13]*(-P[6][0]*S_inv[0][0] - P[6][1]*S_inv[1][0] - P[6][2]*S_inv[2][0] - P[6][6]*S_inv[3][0] - P[6][7]*S_inv[4][0] - P[6][8]*S_inv[5][0]) + P[1][13]*(-P[6][0]*S_inv[0][1] - P[6][1]*S_inv[1][1] - P[6][2]*S_inv[2][1] - P[6][6]*S_inv[3][1] - P[6][7]*S_inv[4][1] - P[6][8]*S_inv[5][1]) + P[2][13]*(-P[6][0]*S_inv[0][2] - P[6][1]*S_inv[1][2] - P[6][2]*S_inv[2][2] - P[6][6]*S_inv[3][2] - P[6][7]*S_inv[4][2] - P[6][8]*S_inv[5][2]) + P[6][13]*(-P[6][0]*S_inv[0][3] - P[6][1]*S_inv[1][3] - P[6][2]*S_inv[2][3] - P[6][6]*S_inv[3][3] - P[6][7]*S_inv[4][3] - P[6][8]*S_inv[5][3] + 1) + P[7][13]*(-P[6][0]*S_inv[0][4] - P[6][1]*S_inv[1][4] - P[6][2]*S_inv[2][4] - P[6][6]*S_inv[3][4] - P[6][7]*S_inv[4][4] - P[6][8]*S_inv[5][4]) + P[8][13]*(-P[6][0]*S_inv[0][5] - P[6][1]*S_inv[1][5] - P[6][2]*S_inv[2][5] - P[6][6]*S_inv[3][5] - P[6][7]*S_inv[4][5] - P[6][8]*S_inv[5][5]);
    P_up[6][14] = P[0][14]*(-P[6][0]*S_inv[0][0] - P[6][1]*S_inv[1][0] - P[6][2]*S_inv[2][0] - P[6][6]*S_inv[3][0] - P[6][7]*S_inv[4][0] - P[6][8]*S_inv[5][0]) + P[1][14]*(-P[6][0]*S_inv[0][1] - P[6][1]*S_inv[1][1] - P[6][2]*S_inv[2][1] - P[6][6]*S_inv[3][1] - P[6][7]*S_inv[4][1] - P[6][8]*S_inv[5][1]) + P[2][14]*(-P[6][0]*S_inv[0][2] - P[6][1]*S_inv[1][2] - P[6][2]*S_inv[2][2] - P[6][6]*S_inv[3][2] - P[6][7]*S_inv[4][2] - P[6][8]*S_inv[5][2]) + P[6][14]*(-P[6][0]*S_inv[0][3] - P[6][1]*S_inv[1][3] - P[6][2]*S_inv[2][3] - P[6][6]*S_inv[3][3] - P[6][7]*S_inv[4][3] - P[6][8]*S_inv[5][3] + 1) + P[7][14]*(-P[6][0]*S_inv[0][4] - P[6][1]*S_inv[1][4] - P[6][2]*S_inv[2][4] - P[6][6]*S_inv[3][4] - P[6][7]*S_inv[4][4] - P[6][8]*S_inv[5][4]) + P[8][14]*(-P[6][0]*S_inv[0][5] - P[6][1]*S_inv[1][5] - P[6][2]*S_inv[2][5] - P[6][6]*S_inv[3][5] - P[6][7]*S_inv[4][5] - P[6][8]*S_inv[5][5]);
    P_up[7][0] = P[0][0]*(-P[7][0]*S_inv[0][0] - P[7][1]*S_inv[1][0] - P[7][2]*S_inv[2][0] - P[7][6]*S_inv[3][0] - P[7][7]*S_inv[4][0] - P[7][8]*S_inv[5][0]) + P[1][0]*(-P[7][0]*S_inv[0][1] - P[7][1]*S_inv[1][1] - P[7][2]*S_inv[2][1] - P[7][6]*S_inv[3][1] - P[7][7]*S_inv[4][1] - P[7][8]*S_inv[5][1]) + P[2][0]*(-P[7][0]*S_inv[0][2] - P[7][1]*S_inv[1][2] - P[7][2]*S_inv[2][2] - P[7][6]*S_inv[3][2] - P[7][7]*S_inv[4][2] - P[7][8]*S_inv[5][2]) + P[6][0]*(-P[7][0]*S_inv[0][3] - P[7][1]*S_inv[1][3] - P[7][2]*S_inv[2][3] - P[7][6]*S_inv[3][3] - P[7][7]*S_inv[4][3] - P[7][8]*S_inv[5][3]) + P[7][0]*(-P[7][0]*S_inv[0][4] - P[7][1]*S_inv[1][4] - P[7][2]*S_inv[2][4] - P[7][6]*S_inv[3][4] - P[7][7]*S_inv[4][4] - P[7][8]*S_inv[5][4] + 1) + P[8][0]*(-P[7][0]*S_inv[0][5] - P[7][1]*S_inv[1][5] - P[7][2]*S_inv[2][5] - P[7][6]*S_inv[3][5] - P[7][7]*S_inv[4][5] - P[7][8]*S_inv[5][5]);
    P_up[7][1] = P[0][1]*(-P[7][0]*S_inv[0][0] - P[7][1]*S_inv[1][0] - P[7][2]*S_inv[2][0] - P[7][6]*S_inv[3][0] - P[7][7]*S_inv[4][0] - P[7][8]*S_inv[5][0]) + P[1][1]*(-P[7][0]*S_inv[0][1] - P[7][1]*S_inv[1][1] - P[7][2]*S_inv[2][1] - P[7][6]*S_inv[3][1] - P[7][7]*S_inv[4][1] - P[7][8]*S_inv[5][1]) + P[2][1]*(-P[7][0]*S_inv[0][2] - P[7][1]*S_inv[1][2] - P[7][2]*S_inv[2][2] - P[7][6]*S_inv[3][2] - P[7][7]*S_inv[4][2] - P[7][8]*S_inv[5][2]) + P[6][1]*(-P[7][0]*S_inv[0][3] - P[7][1]*S_inv[1][3] - P[7][2]*S_inv[2][3] - P[7][6]*S_inv[3][3] - P[7][7]*S_inv[4][3] - P[7][8]*S_inv[5][3]) + P[7][1]*(-P[7][0]*S_inv[0][4] - P[7][1]*S_inv[1][4] - P[7][2]*S_inv[2][4] - P[7][6]*S_inv[3][4] - P[7][7]*S_inv[4][4] - P[7][8]*S_inv[5][4] + 1) + P[8][1]*(-P[7][0]*S_inv[0][5] - P[7][1]*S_inv[1][5] - P[7][2]*S_inv[2][5] - P[7][6]*S_inv[3][5] - P[7][7]*S_inv[4][5] - P[7][8]*S_inv[5][5]);
    P_up[7][2] = P[0][2]*(-P[7][0]*S_inv[0][0] - P[7][1]*S_inv[1][0] - P[7][2]*S_inv[2][0] - P[7][6]*S_inv[3][0] - P[7][7]*S_inv[4][0] - P[7][8]*S_inv[5][0]) + P[1][2]*(-P[7][0]*S_inv[0][1] - P[7][1]*S_inv[1][1] - P[7][2]*S_inv[2][1] - P[7][6]*S_inv[3][1] - P[7][7]*S_inv[4][1] - P[7][8]*S_inv[5][1]) + P[2][2]*(-P[7][0]*S_inv[0][2] - P[7][1]*S_inv[1][2] - P[7][2]*S_inv[2][2] - P[7][6]*S_inv[3][2] - P[7][7]*S_inv[4][2] - P[7][8]*S_inv[5][2]) + P[6][2]*(-P[7][0]*S_inv[0][3] - P[7][1]*S_inv[1][3] - P[7][2]*S_inv[2][3] - P[7][6]*S_inv[3][3] - P[7][7]*S_inv[4][3] - P[7][8]*S_inv[5][3]) + P[7][2]*(-P[7][0]*S_inv[0][4] - P[7][1]*S_inv[1][4] - P[7][2]*S_inv[2][4] - P[7][6]*S_inv[3][4] - P[7][7]*S_inv[4][4] - P[7][8]*S_inv[5][4] + 1) + P[8][2]*(-P[7][0]*S_inv[0][5] - P[7][1]*S_inv[1][5] - P[7][2]*S_inv[2][5] - P[7][6]*S_inv[3][5] - P[7][7]*S_inv[4][5] - P[7][8]*S_inv[5][5]);
    P_up[7][3] = P[0][3]*(-P[7][0]*S_inv[0][0] - P[7][1]*S_inv[1][0] - P[7][2]*S_inv[2][0] - P[7][6]*S_inv[3][0] - P[7][7]*S_inv[4][0] - P[7][8]*S_inv[5][0]) + P[1][3]*(-P[7][0]*S_inv[0][1] - P[7][1]*S_inv[1][1] - P[7][2]*S_inv[2][1] - P[7][6]*S_inv[3][1] - P[7][7]*S_inv[4][1] - P[7][8]*S_inv[5][1]) + P[2][3]*(-P[7][0]*S_inv[0][2] - P[7][1]*S_inv[1][2] - P[7][2]*S_inv[2][2] - P[7][6]*S_inv[3][2] - P[7][7]*S_inv[4][2] - P[7][8]*S_inv[5][2]) + P[6][3]*(-P[7][0]*S_inv[0][3] - P[7][1]*S_inv[1][3] - P[7][2]*S_inv[2][3] - P[7][6]*S_inv[3][3] - P[7][7]*S_inv[4][3] - P[7][8]*S_inv[5][3]) + P[7][3]*(-P[7][0]*S_inv[0][4] - P[7][1]*S_inv[1][4] - P[7][2]*S_inv[2][4] - P[7][6]*S_inv[3][4] - P[7][7]*S_inv[4][4] - P[7][8]*S_inv[5][4] + 1) + P[8][3]*(-P[7][0]*S_inv[0][5] - P[7][1]*S_inv[1][5] - P[7][2]*S_inv[2][5] - P[7][6]*S_inv[3][5] - P[7][7]*S_inv[4][5] - P[7][8]*S_inv[5][5]);
    P_up[7][4] = P[0][4]*(-P[7][0]*S_inv[0][0] - P[7][1]*S_inv[1][0] - P[7][2]*S_inv[2][0] - P[7][6]*S_inv[3][0] - P[7][7]*S_inv[4][0] - P[7][8]*S_inv[5][0]) + P[1][4]*(-P[7][0]*S_inv[0][1] - P[7][1]*S_inv[1][1] - P[7][2]*S_inv[2][1] - P[7][6]*S_inv[3][1] - P[7][7]*S_inv[4][1] - P[7][8]*S_inv[5][1]) + P[2][4]*(-P[7][0]*S_inv[0][2] - P[7][1]*S_inv[1][2] - P[7][2]*S_inv[2][2] - P[7][6]*S_inv[3][2] - P[7][7]*S_inv[4][2] - P[7][8]*S_inv[5][2]) + P[6][4]*(-P[7][0]*S_inv[0][3] - P[7][1]*S_inv[1][3] - P[7][2]*S_inv[2][3] - P[7][6]*S_inv[3][3] - P[7][7]*S_inv[4][3] - P[7][8]*S_inv[5][3]) + P[7][4]*(-P[7][0]*S_inv[0][4] - P[7][1]*S_inv[1][4] - P[7][2]*S_inv[2][4] - P[7][6]*S_inv[3][4] - P[7][7]*S_inv[4][4] - P[7][8]*S_inv[5][4] + 1) + P[8][4]*(-P[7][0]*S_inv[0][5] - P[7][1]*S_inv[1][5] - P[7][2]*S_inv[2][5] - P[7][6]*S_inv[3][5] - P[7][7]*S_inv[4][5] - P[7][8]*S_inv[5][5]);
    P_up[7][5] = P[0][5]*(-P[7][0]*S_inv[0][0] - P[7][1]*S_inv[1][0] - P[7][2]*S_inv[2][0] - P[7][6]*S_inv[3][0] - P[7][7]*S_inv[4][0] - P[7][8]*S_inv[5][0]) + P[1][5]*(-P[7][0]*S_inv[0][1] - P[7][1]*S_inv[1][1] - P[7][2]*S_inv[2][1] - P[7][6]*S_inv[3][1] - P[7][7]*S_inv[4][1] - P[7][8]*S_inv[5][1]) + P[2][5]*(-P[7][0]*S_inv[0][2] - P[7][1]*S_inv[1][2] - P[7][2]*S_inv[2][2] - P[7][6]*S_inv[3][2] - P[7][7]*S_inv[4][2] - P[7][8]*S_inv[5][2]) + P[6][5]*(-P[7][0]*S_inv[0][3] - P[7][1]*S_inv[1][3] - P[7][2]*S_inv[2][3] - P[7][6]*S_inv[3][3] - P[7][7]*S_inv[4][3] - P[7][8]*S_inv[5][3]) + P[7][5]*(-P[7][0]*S_inv[0][4] - P[7][1]*S_inv[1][4] - P[7][2]*S_inv[2][4] - P[7][6]*S_inv[3][4] - P[7][7]*S_inv[4][4] - P[7][8]*S_inv[5][4] + 1) + P[8][5]*(-P[7][0]*S_inv[0][5] - P[7][1]*S_inv[1][5] - P[7][2]*S_inv[2][5] - P[7][6]*S_inv[3][5] - P[7][7]*S_inv[4][5] - P[7][8]*S_inv[5][5]);
    P_up[7][6] = P[0][6]*(-P[7][0]*S_inv[0][0] - P[7][1]*S_inv[1][0] - P[7][2]*S_inv[2][0] - P[7][6]*S_inv[3][0] - P[7][7]*S_inv[4][0] - P[7][8]*S_inv[5][0]) + P[1][6]*(-P[7][0]*S_inv[0][1] - P[7][1]*S_inv[1][1] - P[7][2]*S_inv[2][1] - P[7][6]*S_inv[3][1] - P[7][7]*S_inv[4][1] - P[7][8]*S_inv[5][1]) + P[2][6]*(-P[7][0]*S_inv[0][2] - P[7][1]*S_inv[1][2] - P[7][2]*S_inv[2][2] - P[7][6]*S_inv[3][2] - P[7][7]*S_inv[4][2] - P[7][8]*S_inv[5][2]) + P[6][6]*(-P[7][0]*S_inv[0][3] - P[7][1]*S_inv[1][3] - P[7][2]*S_inv[2][3] - P[7][6]*S_inv[3][3] - P[7][7]*S_inv[4][3] - P[7][8]*S_inv[5][3]) + P[7][6]*(-P[7][0]*S_inv[0][4] - P[7][1]*S_inv[1][4] - P[7][2]*S_inv[2][4] - P[7][6]*S_inv[3][4] - P[7][7]*S_inv[4][4] - P[7][8]*S_inv[5][4] + 1) + P[8][6]*(-P[7][0]*S_inv[0][5] - P[7][1]*S_inv[1][5] - P[7][2]*S_inv[2][5] - P[7][6]*S_inv[3][5] - P[7][7]*S_inv[4][5] - P[7][8]*S_inv[5][5]);
    P_up[7][7] = P[0][7]*(-P[7][0]*S_inv[0][0] - P[7][1]*S_inv[1][0] - P[7][2]*S_inv[2][0] - P[7][6]*S_inv[3][0] - P[7][7]*S_inv[4][0] - P[7][8]*S_inv[5][0]) + P[1][7]*(-P[7][0]*S_inv[0][1] - P[7][1]*S_inv[1][1] - P[7][2]*S_inv[2][1] - P[7][6]*S_inv[3][1] - P[7][7]*S_inv[4][1] - P[7][8]*S_inv[5][1]) + P[2][7]*(-P[7][0]*S_inv[0][2] - P[7][1]*S_inv[1][2] - P[7][2]*S_inv[2][2] - P[7][6]*S_inv[3][2] - P[7][7]*S_inv[4][2] - P[7][8]*S_inv[5][2]) + P[6][7]*(-P[7][0]*S_inv[0][3] - P[7][1]*S_inv[1][3] - P[7][2]*S_inv[2][3] - P[7][6]*S_inv[3][3] - P[7][7]*S_inv[4][3] - P[7][8]*S_inv[5][3]) + P[7][7]*(-P[7][0]*S_inv[0][4] - P[7][1]*S_inv[1][4] - P[7][2]*S_inv[2][4] - P[7][6]*S_inv[3][4] - P[7][7]*S_inv[4][4] - P[7][8]*S_inv[5][4] + 1) + P[8][7]*(-P[7][0]*S_inv[0][5] - P[7][1]*S_inv[1][5] - P[7][2]*S_inv[2][5] - P[7][6]*S_inv[3][5] - P[7][7]*S_inv[4][5] - P[7][8]*S_inv[5][5]);
    P_up[7][8] = P[0][8]*(-P[7][0]*S_inv[0][0] - P[7][1]*S_inv[1][0] - P[7][2]*S_inv[2][0] - P[7][6]*S_inv[3][0] - P[7][7]*S_inv[4][0] - P[7][8]*S_inv[5][0]) + P[1][8]*(-P[7][0]*S_inv[0][1] - P[7][1]*S_inv[1][1] - P[7][2]*S_inv[2][1] - P[7][6]*S_inv[3][1] - P[7][7]*S_inv[4][1] - P[7][8]*S_inv[5][1]) + P[2][8]*(-P[7][0]*S_inv[0][2] - P[7][1]*S_inv[1][2] - P[7][2]*S_inv[2][2] - P[7][6]*S_inv[3][2] - P[7][7]*S_inv[4][2] - P[7][8]*S_inv[5][2]) + P[6][8]*(-P[7][0]*S_inv[0][3] - P[7][1]*S_inv[1][3] - P[7][2]*S_inv[2][3] - P[7][6]*S_inv[3][3] - P[7][7]*S_inv[4][3] - P[7][8]*S_inv[5][3]) + P[7][8]*(-P[7][0]*S_inv[0][4] - P[7][1]*S_inv[1][4] - P[7][2]*S_inv[2][4] - P[7][6]*S_inv[3][4] - P[7][7]*S_inv[4][4] - P[7][8]*S_inv[5][4] + 1) + P[8][8]*(-P[7][0]*S_inv[0][5] - P[7][1]*S_inv[1][5] - P[7][2]*S_inv[2][5] - P[7][6]*S_inv[3][5] - P[7][7]*S_inv[4][5] - P[7][8]*S_inv[5][5]);
    P_up[7][9] = P[0][9]*(-P[7][0]*S_inv[0][0] - P[7][1]*S_inv[1][0] - P[7][2]*S_inv[2][0] - P[7][6]*S_inv[3][0] - P[7][7]*S_inv[4][0] - P[7][8]*S_inv[5][0]) + P[1][9]*(-P[7][0]*S_inv[0][1] - P[7][1]*S_inv[1][1] - P[7][2]*S_inv[2][1] - P[7][6]*S_inv[3][1] - P[7][7]*S_inv[4][1] - P[7][8]*S_inv[5][1]) + P[2][9]*(-P[7][0]*S_inv[0][2] - P[7][1]*S_inv[1][2] - P[7][2]*S_inv[2][2] - P[7][6]*S_inv[3][2] - P[7][7]*S_inv[4][2] - P[7][8]*S_inv[5][2]) + P[6][9]*(-P[7][0]*S_inv[0][3] - P[7][1]*S_inv[1][3] - P[7][2]*S_inv[2][3] - P[7][6]*S_inv[3][3] - P[7][7]*S_inv[4][3] - P[7][8]*S_inv[5][3]) + P[7][9]*(-P[7][0]*S_inv[0][4] - P[7][1]*S_inv[1][4] - P[7][2]*S_inv[2][4] - P[7][6]*S_inv[3][4] - P[7][7]*S_inv[4][4] - P[7][8]*S_inv[5][4] + 1) + P[8][9]*(-P[7][0]*S_inv[0][5] - P[7][1]*S_inv[1][5] - P[7][2]*S_inv[2][5] - P[7][6]*S_inv[3][5] - P[7][7]*S_inv[4][5] - P[7][8]*S_inv[5][5]);
    P_up[7][10] = P[0][10]*(-P[7][0]*S_inv[0][0] - P[7][1]*S_inv[1][0] - P[7][2]*S_inv[2][0] - P[7][6]*S_inv[3][0] - P[7][7]*S_inv[4][0] - P[7][8]*S_inv[5][0]) + P[1][10]*(-P[7][0]*S_inv[0][1] - P[7][1]*S_inv[1][1] - P[7][2]*S_inv[2][1] - P[7][6]*S_inv[3][1] - P[7][7]*S_inv[4][1] - P[7][8]*S_inv[5][1]) + P[2][10]*(-P[7][0]*S_inv[0][2] - P[7][1]*S_inv[1][2] - P[7][2]*S_inv[2][2] - P[7][6]*S_inv[3][2] - P[7][7]*S_inv[4][2] - P[7][8]*S_inv[5][2]) + P[6][10]*(-P[7][0]*S_inv[0][3] - P[7][1]*S_inv[1][3] - P[7][2]*S_inv[2][3] - P[7][6]*S_inv[3][3] - P[7][7]*S_inv[4][3] - P[7][8]*S_inv[5][3]) + P[7][10]*(-P[7][0]*S_inv[0][4] - P[7][1]*S_inv[1][4] - P[7][2]*S_inv[2][4] - P[7][6]*S_inv[3][4] - P[7][7]*S_inv[4][4] - P[7][8]*S_inv[5][4] + 1) + P[8][10]*(-P[7][0]*S_inv[0][5] - P[7][1]*S_inv[1][5] - P[7][2]*S_inv[2][5] - P[7][6]*S_inv[3][5] - P[7][7]*S_inv[4][5] - P[7][8]*S_inv[5][5]);
    P_up[7][11] = P[0][11]*(-P[7][0]*S_inv[0][0] - P[7][1]*S_inv[1][0] - P[7][2]*S_inv[2][0] - P[7][6]*S_inv[3][0] - P[7][7]*S_inv[4][0] - P[7][8]*S_inv[5][0]) + P[1][11]*(-P[7][0]*S_inv[0][1] - P[7][1]*S_inv[1][1] - P[7][2]*S_inv[2][1] - P[7][6]*S_inv[3][1] - P[7][7]*S_inv[4][1] - P[7][8]*S_inv[5][1]) + P[2][11]*(-P[7][0]*S_inv[0][2] - P[7][1]*S_inv[1][2] - P[7][2]*S_inv[2][2] - P[7][6]*S_inv[3][2] - P[7][7]*S_inv[4][2] - P[7][8]*S_inv[5][2]) + P[6][11]*(-P[7][0]*S_inv[0][3] - P[7][1]*S_inv[1][3] - P[7][2]*S_inv[2][3] - P[7][6]*S_inv[3][3] - P[7][7]*S_inv[4][3] - P[7][8]*S_inv[5][3]) + P[7][11]*(-P[7][0]*S_inv[0][4] - P[7][1]*S_inv[1][4] - P[7][2]*S_inv[2][4] - P[7][6]*S_inv[3][4] - P[7][7]*S_inv[4][4] - P[7][8]*S_inv[5][4] + 1) + P[8][11]*(-P[7][0]*S_inv[0][5] - P[7][1]*S_inv[1][5] - P[7][2]*S_inv[2][5] - P[7][6]*S_inv[3][5] - P[7][7]*S_inv[4][5] - P[7][8]*S_inv[5][5]);
    P_up[7][12] = P[0][12]*(-P[7][0]*S_inv[0][0] - P[7][1]*S_inv[1][0] - P[7][2]*S_inv[2][0] - P[7][6]*S_inv[3][0] - P[7][7]*S_inv[4][0] - P[7][8]*S_inv[5][0]) + P[1][12]*(-P[7][0]*S_inv[0][1] - P[7][1]*S_inv[1][1] - P[7][2]*S_inv[2][1] - P[7][6]*S_inv[3][1] - P[7][7]*S_inv[4][1] - P[7][8]*S_inv[5][1]) + P[2][12]*(-P[7][0]*S_inv[0][2] - P[7][1]*S_inv[1][2] - P[7][2]*S_inv[2][2] - P[7][6]*S_inv[3][2] - P[7][7]*S_inv[4][2] - P[7][8]*S_inv[5][2]) + P[6][12]*(-P[7][0]*S_inv[0][3] - P[7][1]*S_inv[1][3] - P[7][2]*S_inv[2][3] - P[7][6]*S_inv[3][3] - P[7][7]*S_inv[4][3] - P[7][8]*S_inv[5][3]) + P[7][12]*(-P[7][0]*S_inv[0][4] - P[7][1]*S_inv[1][4] - P[7][2]*S_inv[2][4] - P[7][6]*S_inv[3][4] - P[7][7]*S_inv[4][4] - P[7][8]*S_inv[5][4] + 1) + P[8][12]*(-P[7][0]*S_inv[0][5] - P[7][1]*S_inv[1][5] - P[7][2]*S_inv[2][5] - P[7][6]*S_inv[3][5] - P[7][7]*S_inv[4][5] - P[7][8]*S_inv[5][5]);
    P_up[7][13] = P[0][13]*(-P[7][0]*S_inv[0][0] - P[7][1]*S_inv[1][0] - P[7][2]*S_inv[2][0] - P[7][6]*S_inv[3][0] - P[7][7]*S_inv[4][0] - P[7][8]*S_inv[5][0]) + P[1][13]*(-P[7][0]*S_inv[0][1] - P[7][1]*S_inv[1][1] - P[7][2]*S_inv[2][1] - P[7][6]*S_inv[3][1] - P[7][7]*S_inv[4][1] - P[7][8]*S_inv[5][1]) + P[2][13]*(-P[7][0]*S_inv[0][2] - P[7][1]*S_inv[1][2] - P[7][2]*S_inv[2][2] - P[7][6]*S_inv[3][2] - P[7][7]*S_inv[4][2] - P[7][8]*S_inv[5][2]) + P[6][13]*(-P[7][0]*S_inv[0][3] - P[7][1]*S_inv[1][3] - P[7][2]*S_inv[2][3] - P[7][6]*S_inv[3][3] - P[7][7]*S_inv[4][3] - P[7][8]*S_inv[5][3]) + P[7][13]*(-P[7][0]*S_inv[0][4] - P[7][1]*S_inv[1][4] - P[7][2]*S_inv[2][4] - P[7][6]*S_inv[3][4] - P[7][7]*S_inv[4][4] - P[7][8]*S_inv[5][4] + 1) + P[8][13]*(-P[7][0]*S_inv[0][5] - P[7][1]*S_inv[1][5] - P[7][2]*S_inv[2][5] - P[7][6]*S_inv[3][5] - P[7][7]*S_inv[4][5] - P[7][8]*S_inv[5][5]);
    P_up[7][14] = P[0][14]*(-P[7][0]*S_inv[0][0] - P[7][1]*S_inv[1][0] - P[7][2]*S_inv[2][0] - P[7][6]*S_inv[3][0] - P[7][7]*S_inv[4][0] - P[7][8]*S_inv[5][0]) + P[1][14]*(-P[7][0]*S_inv[0][1] - P[7][1]*S_inv[1][1] - P[7][2]*S_inv[2][1] - P[7][6]*S_inv[3][1] - P[7][7]*S_inv[4][1] - P[7][8]*S_inv[5][1]) + P[2][14]*(-P[7][0]*S_inv[0][2] - P[7][1]*S_inv[1][2] - P[7][2]*S_inv[2][2] - P[7][6]*S_inv[3][2] - P[7][7]*S_inv[4][2] - P[7][8]*S_inv[5][2]) + P[6][14]*(-P[7][0]*S_inv[0][3] - P[7][1]*S_inv[1][3] - P[7][2]*S_inv[2][3] - P[7][6]*S_inv[3][3] - P[7][7]*S_inv[4][3] - P[7][8]*S_inv[5][3]) + P[7][14]*(-P[7][0]*S_inv[0][4] - P[7][1]*S_inv[1][4] - P[7][2]*S_inv[2][4] - P[7][6]*S_inv[3][4] - P[7][7]*S_inv[4][4] - P[7][8]*S_inv[5][4] + 1) + P[8][14]*(-P[7][0]*S_inv[0][5] - P[7][1]*S_inv[1][5] - P[7][2]*S_inv[2][5] - P[7][6]*S_inv[3][5] - P[7][7]*S_inv[4][5] - P[7][8]*S_inv[5][5]);
    P_up[8][0] = P[0][0]*(-P[8][0]*S_inv[0][0] - P[8][1]*S_inv[1][0] - P[8][2]*S_inv[2][0] - P[8][6]*S_inv[3][0] - P[8][7]*S_inv[4][0] - P[8][8]*S_inv[5][0]) + P[1][0]*(-P[8][0]*S_inv[0][1] - P[8][1]*S_inv[1][1] - P[8][2]*S_inv[2][1] - P[8][6]*S_inv[3][1] - P[8][7]*S_inv[4][1] - P[8][8]*S_inv[5][1]) + P[2][0]*(-P[8][0]*S_inv[0][2] - P[8][1]*S_inv[1][2] - P[8][2]*S_inv[2][2] - P[8][6]*S_inv[3][2] - P[8][7]*S_inv[4][2] - P[8][8]*S_inv[5][2]) + P[6][0]*(-P[8][0]*S_inv[0][3] - P[8][1]*S_inv[1][3] - P[8][2]*S_inv[2][3] - P[8][6]*S_inv[3][3] - P[8][7]*S_inv[4][3] - P[8][8]*S_inv[5][3]) + P[7][0]*(-P[8][0]*S_inv[0][4] - P[8][1]*S_inv[1][4] - P[8][2]*S_inv[2][4] - P[8][6]*S_inv[3][4] - P[8][7]*S_inv[4][4] - P[8][8]*S_inv[5][4]) + P[8][0]*(-P[8][0]*S_inv[0][5] - P[8][1]*S_inv[1][5] - P[8][2]*S_inv[2][5] - P[8][6]*S_inv[3][5] - P[8][7]*S_inv[4][5] - P[8][8]*S_inv[5][5] + 1);
    P_up[8][1] = P[0][1]*(-P[8][0]*S_inv[0][0] - P[8][1]*S_inv[1][0] - P[8][2]*S_inv[2][0] - P[8][6]*S_inv[3][0] - P[8][7]*S_inv[4][0] - P[8][8]*S_inv[5][0]) + P[1][1]*(-P[8][0]*S_inv[0][1] - P[8][1]*S_inv[1][1] - P[8][2]*S_inv[2][1] - P[8][6]*S_inv[3][1] - P[8][7]*S_inv[4][1] - P[8][8]*S_inv[5][1]) + P[2][1]*(-P[8][0]*S_inv[0][2] - P[8][1]*S_inv[1][2] - P[8][2]*S_inv[2][2] - P[8][6]*S_inv[3][2] - P[8][7]*S_inv[4][2] - P[8][8]*S_inv[5][2]) + P[6][1]*(-P[8][0]*S_inv[0][3] - P[8][1]*S_inv[1][3] - P[8][2]*S_inv[2][3] - P[8][6]*S_inv[3][3] - P[8][7]*S_inv[4][3] - P[8][8]*S_inv[5][3]) + P[7][1]*(-P[8][0]*S_inv[0][4] - P[8][1]*S_inv[1][4] - P[8][2]*S_inv[2][4] - P[8][6]*S_inv[3][4] - P[8][7]*S_inv[4][4] - P[8][8]*S_inv[5][4]) + P[8][1]*(-P[8][0]*S_inv[0][5] - P[8][1]*S_inv[1][5] - P[8][2]*S_inv[2][5] - P[8][6]*S_inv[3][5] - P[8][7]*S_inv[4][5] - P[8][8]*S_inv[5][5] + 1);
    P_up[8][2] = P[0][2]*(-P[8][0]*S_inv[0][0] - P[8][1]*S_inv[1][0] - P[8][2]*S_inv[2][0] - P[8][6]*S_inv[3][0] - P[8][7]*S_inv[4][0] - P[8][8]*S_inv[5][0]) + P[1][2]*(-P[8][0]*S_inv[0][1] - P[8][1]*S_inv[1][1] - P[8][2]*S_inv[2][1] - P[8][6]*S_inv[3][1] - P[8][7]*S_inv[4][1] - P[8][8]*S_inv[5][1]) + P[2][2]*(-P[8][0]*S_inv[0][2] - P[8][1]*S_inv[1][2] - P[8][2]*S_inv[2][2] - P[8][6]*S_inv[3][2] - P[8][7]*S_inv[4][2] - P[8][8]*S_inv[5][2]) + P[6][2]*(-P[8][0]*S_inv[0][3] - P[8][1]*S_inv[1][3] - P[8][2]*S_inv[2][3] - P[8][6]*S_inv[3][3] - P[8][7]*S_inv[4][3] - P[8][8]*S_inv[5][3]) + P[7][2]*(-P[8][0]*S_inv[0][4] - P[8][1]*S_inv[1][4] - P[8][2]*S_inv[2][4] - P[8][6]*S_inv[3][4] - P[8][7]*S_inv[4][4] - P[8][8]*S_inv[5][4]) + P[8][2]*(-P[8][0]*S_inv[0][5] - P[8][1]*S_inv[1][5] - P[8][2]*S_inv[2][5] - P[8][6]*S_inv[3][5] - P[8][7]*S_inv[4][5] - P[8][8]*S_inv[5][5] + 1);
    P_up[8][3] = P[0][3]*(-P[8][0]*S_inv[0][0] - P[8][1]*S_inv[1][0] - P[8][2]*S_inv[2][0] - P[8][6]*S_inv[3][0] - P[8][7]*S_inv[4][0] - P[8][8]*S_inv[5][0]) + P[1][3]*(-P[8][0]*S_inv[0][1] - P[8][1]*S_inv[1][1] - P[8][2]*S_inv[2][1] - P[8][6]*S_inv[3][1] - P[8][7]*S_inv[4][1] - P[8][8]*S_inv[5][1]) + P[2][3]*(-P[8][0]*S_inv[0][2] - P[8][1]*S_inv[1][2] - P[8][2]*S_inv[2][2] - P[8][6]*S_inv[3][2] - P[8][7]*S_inv[4][2] - P[8][8]*S_inv[5][2]) + P[6][3]*(-P[8][0]*S_inv[0][3] - P[8][1]*S_inv[1][3] - P[8][2]*S_inv[2][3] - P[8][6]*S_inv[3][3] - P[8][7]*S_inv[4][3] - P[8][8]*S_inv[5][3]) + P[7][3]*(-P[8][0]*S_inv[0][4] - P[8][1]*S_inv[1][4] - P[8][2]*S_inv[2][4] - P[8][6]*S_inv[3][4] - P[8][7]*S_inv[4][4] - P[8][8]*S_inv[5][4]) + P[8][3]*(-P[8][0]*S_inv[0][5] - P[8][1]*S_inv[1][5] - P[8][2]*S_inv[2][5] - P[8][6]*S_inv[3][5] - P[8][7]*S_inv[4][5] - P[8][8]*S_inv[5][5] + 1);
    P_up[8][4] = P[0][4]*(-P[8][0]*S_inv[0][0] - P[8][1]*S_inv[1][0] - P[8][2]*S_inv[2][0] - P[8][6]*S_inv[3][0] - P[8][7]*S_inv[4][0] - P[8][8]*S_inv[5][0]) + P[1][4]*(-P[8][0]*S_inv[0][1] - P[8][1]*S_inv[1][1] - P[8][2]*S_inv[2][1] - P[8][6]*S_inv[3][1] - P[8][7]*S_inv[4][1] - P[8][8]*S_inv[5][1]) + P[2][4]*(-P[8][0]*S_inv[0][2] - P[8][1]*S_inv[1][2] - P[8][2]*S_inv[2][2] - P[8][6]*S_inv[3][2] - P[8][7]*S_inv[4][2] - P[8][8]*S_inv[5][2]) + P[6][4]*(-P[8][0]*S_inv[0][3] - P[8][1]*S_inv[1][3] - P[8][2]*S_inv[2][3] - P[8][6]*S_inv[3][3] - P[8][7]*S_inv[4][3] - P[8][8]*S_inv[5][3]) + P[7][4]*(-P[8][0]*S_inv[0][4] - P[8][1]*S_inv[1][4] - P[8][2]*S_inv[2][4] - P[8][6]*S_inv[3][4] - P[8][7]*S_inv[4][4] - P[8][8]*S_inv[5][4]) + P[8][4]*(-P[8][0]*S_inv[0][5] - P[8][1]*S_inv[1][5] - P[8][2]*S_inv[2][5] - P[8][6]*S_inv[3][5] - P[8][7]*S_inv[4][5] - P[8][8]*S_inv[5][5] + 1);
    P_up[8][5] = P[0][5]*(-P[8][0]*S_inv[0][0] - P[8][1]*S_inv[1][0] - P[8][2]*S_inv[2][0] - P[8][6]*S_inv[3][0] - P[8][7]*S_inv[4][0] - P[8][8]*S_inv[5][0]) + P[1][5]*(-P[8][0]*S_inv[0][1] - P[8][1]*S_inv[1][1] - P[8][2]*S_inv[2][1] - P[8][6]*S_inv[3][1] - P[8][7]*S_inv[4][1] - P[8][8]*S_inv[5][1]) + P[2][5]*(-P[8][0]*S_inv[0][2] - P[8][1]*S_inv[1][2] - P[8][2]*S_inv[2][2] - P[8][6]*S_inv[3][2] - P[8][7]*S_inv[4][2] - P[8][8]*S_inv[5][2]) + P[6][5]*(-P[8][0]*S_inv[0][3] - P[8][1]*S_inv[1][3] - P[8][2]*S_inv[2][3] - P[8][6]*S_inv[3][3] - P[8][7]*S_inv[4][3] - P[8][8]*S_inv[5][3]) + P[7][5]*(-P[8][0]*S_inv[0][4] - P[8][1]*S_inv[1][4] - P[8][2]*S_inv[2][4] - P[8][6]*S_inv[3][4] - P[8][7]*S_inv[4][4] - P[8][8]*S_inv[5][4]) + P[8][5]*(-P[8][0]*S_inv[0][5] - P[8][1]*S_inv[1][5] - P[8][2]*S_inv[2][5] - P[8][6]*S_inv[3][5] - P[8][7]*S_inv[4][5] - P[8][8]*S_inv[5][5] + 1);
    P_up[8][6] = P[0][6]*(-P[8][0]*S_inv[0][0] - P[8][1]*S_inv[1][0] - P[8][2]*S_inv[2][0] - P[8][6]*S_inv[3][0] - P[8][7]*S_inv[4][0] - P[8][8]*S_inv[5][0]) + P[1][6]*(-P[8][0]*S_inv[0][1] - P[8][1]*S_inv[1][1] - P[8][2]*S_inv[2][1] - P[8][6]*S_inv[3][1] - P[8][7]*S_inv[4][1] - P[8][8]*S_inv[5][1]) + P[2][6]*(-P[8][0]*S_inv[0][2] - P[8][1]*S_inv[1][2] - P[8][2]*S_inv[2][2] - P[8][6]*S_inv[3][2] - P[8][7]*S_inv[4][2] - P[8][8]*S_inv[5][2]) + P[6][6]*(-P[8][0]*S_inv[0][3] - P[8][1]*S_inv[1][3] - P[8][2]*S_inv[2][3] - P[8][6]*S_inv[3][3] - P[8][7]*S_inv[4][3] - P[8][8]*S_inv[5][3]) + P[7][6]*(-P[8][0]*S_inv[0][4] - P[8][1]*S_inv[1][4] - P[8][2]*S_inv[2][4] - P[8][6]*S_inv[3][4] - P[8][7]*S_inv[4][4] - P[8][8]*S_inv[5][4]) + P[8][6]*(-P[8][0]*S_inv[0][5] - P[8][1]*S_inv[1][5] - P[8][2]*S_inv[2][5] - P[8][6]*S_inv[3][5] - P[8][7]*S_inv[4][5] - P[8][8]*S_inv[5][5] + 1);
    P_up[8][7] = P[0][7]*(-P[8][0]*S_inv[0][0] - P[8][1]*S_inv[1][0] - P[8][2]*S_inv[2][0] - P[8][6]*S_inv[3][0] - P[8][7]*S_inv[4][0] - P[8][8]*S_inv[5][0]) + P[1][7]*(-P[8][0]*S_inv[0][1] - P[8][1]*S_inv[1][1] - P[8][2]*S_inv[2][1] - P[8][6]*S_inv[3][1] - P[8][7]*S_inv[4][1] - P[8][8]*S_inv[5][1]) + P[2][7]*(-P[8][0]*S_inv[0][2] - P[8][1]*S_inv[1][2] - P[8][2]*S_inv[2][2] - P[8][6]*S_inv[3][2] - P[8][7]*S_inv[4][2] - P[8][8]*S_inv[5][2]) + P[6][7]*(-P[8][0]*S_inv[0][3] - P[8][1]*S_inv[1][3] - P[8][2]*S_inv[2][3] - P[8][6]*S_inv[3][3] - P[8][7]*S_inv[4][3] - P[8][8]*S_inv[5][3]) + P[7][7]*(-P[8][0]*S_inv[0][4] - P[8][1]*S_inv[1][4] - P[8][2]*S_inv[2][4] - P[8][6]*S_inv[3][4] - P[8][7]*S_inv[4][4] - P[8][8]*S_inv[5][4]) + P[8][7]*(-P[8][0]*S_inv[0][5] - P[8][1]*S_inv[1][5] - P[8][2]*S_inv[2][5] - P[8][6]*S_inv[3][5] - P[8][7]*S_inv[4][5] - P[8][8]*S_inv[5][5] + 1);
    P_up[8][8] = P[0][8]*(-P[8][0]*S_inv[0][0] - P[8][1]*S_inv[1][0] - P[8][2]*S_inv[2][0] - P[8][6]*S_inv[3][0] - P[8][7]*S_inv[4][0] - P[8][8]*S_inv[5][0]) + P[1][8]*(-P[8][0]*S_inv[0][1] - P[8][1]*S_inv[1][1] - P[8][2]*S_inv[2][1] - P[8][6]*S_inv[3][1] - P[8][7]*S_inv[4][1] - P[8][8]*S_inv[5][1]) + P[2][8]*(-P[8][0]*S_inv[0][2] - P[8][1]*S_inv[1][2] - P[8][2]*S_inv[2][2] - P[8][6]*S_inv[3][2] - P[8][7]*S_inv[4][2] - P[8][8]*S_inv[5][2]) + P[6][8]*(-P[8][0]*S_inv[0][3] - P[8][1]*S_inv[1][3] - P[8][2]*S_inv[2][3] - P[8][6]*S_inv[3][3] - P[8][7]*S_inv[4][3] - P[8][8]*S_inv[5][3]) + P[7][8]*(-P[8][0]*S_inv[0][4] - P[8][1]*S_inv[1][4] - P[8][2]*S_inv[2][4] - P[8][6]*S_inv[3][4] - P[8][7]*S_inv[4][4] - P[8][8]*S_inv[5][4]) + P[8][8]*(-P[8][0]*S_inv[0][5] - P[8][1]*S_inv[1][5] - P[8][2]*S_inv[2][5] - P[8][6]*S_inv[3][5] - P[8][7]*S_inv[4][5] - P[8][8]*S_inv[5][5] + 1);
    P_up[8][9] = P[0][9]*(-P[8][0]*S_inv[0][0] - P[8][1]*S_inv[1][0] - P[8][2]*S_inv[2][0] - P[8][6]*S_inv[3][0] - P[8][7]*S_inv[4][0] - P[8][8]*S_inv[5][0]) + P[1][9]*(-P[8][0]*S_inv[0][1] - P[8][1]*S_inv[1][1] - P[8][2]*S_inv[2][1] - P[8][6]*S_inv[3][1] - P[8][7]*S_inv[4][1] - P[8][8]*S_inv[5][1]) + P[2][9]*(-P[8][0]*S_inv[0][2] - P[8][1]*S_inv[1][2] - P[8][2]*S_inv[2][2] - P[8][6]*S_inv[3][2] - P[8][7]*S_inv[4][2] - P[8][8]*S_inv[5][2]) + P[6][9]*(-P[8][0]*S_inv[0][3] - P[8][1]*S_inv[1][3] - P[8][2]*S_inv[2][3] - P[8][6]*S_inv[3][3] - P[8][7]*S_inv[4][3] - P[8][8]*S_inv[5][3]) + P[7][9]*(-P[8][0]*S_inv[0][4] - P[8][1]*S_inv[1][4] - P[8][2]*S_inv[2][4] - P[8][6]*S_inv[3][4] - P[8][7]*S_inv[4][4] - P[8][8]*S_inv[5][4]) + P[8][9]*(-P[8][0]*S_inv[0][5] - P[8][1]*S_inv[1][5] - P[8][2]*S_inv[2][5] - P[8][6]*S_inv[3][5] - P[8][7]*S_inv[4][5] - P[8][8]*S_inv[5][5] + 1);
    P_up[8][10] = P[0][10]*(-P[8][0]*S_inv[0][0] - P[8][1]*S_inv[1][0] - P[8][2]*S_inv[2][0] - P[8][6]*S_inv[3][0] - P[8][7]*S_inv[4][0] - P[8][8]*S_inv[5][0]) + P[1][10]*(-P[8][0]*S_inv[0][1] - P[8][1]*S_inv[1][1] - P[8][2]*S_inv[2][1] - P[8][6]*S_inv[3][1] - P[8][7]*S_inv[4][1] - P[8][8]*S_inv[5][1]) + P[2][10]*(-P[8][0]*S_inv[0][2] - P[8][1]*S_inv[1][2] - P[8][2]*S_inv[2][2] - P[8][6]*S_inv[3][2] - P[8][7]*S_inv[4][2] - P[8][8]*S_inv[5][2]) + P[6][10]*(-P[8][0]*S_inv[0][3] - P[8][1]*S_inv[1][3] - P[8][2]*S_inv[2][3] - P[8][6]*S_inv[3][3] - P[8][7]*S_inv[4][3] - P[8][8]*S_inv[5][3]) + P[7][10]*(-P[8][0]*S_inv[0][4] - P[8][1]*S_inv[1][4] - P[8][2]*S_inv[2][4] - P[8][6]*S_inv[3][4] - P[8][7]*S_inv[4][4] - P[8][8]*S_inv[5][4]) + P[8][10]*(-P[8][0]*S_inv[0][5] - P[8][1]*S_inv[1][5] - P[8][2]*S_inv[2][5] - P[8][6]*S_inv[3][5] - P[8][7]*S_inv[4][5] - P[8][8]*S_inv[5][5] + 1);
    P_up[8][11] = P[0][11]*(-P[8][0]*S_inv[0][0] - P[8][1]*S_inv[1][0] - P[8][2]*S_inv[2][0] - P[8][6]*S_inv[3][0] - P[8][7]*S_inv[4][0] - P[8][8]*S_inv[5][0]) + P[1][11]*(-P[8][0]*S_inv[0][1] - P[8][1]*S_inv[1][1] - P[8][2]*S_inv[2][1] - P[8][6]*S_inv[3][1] - P[8][7]*S_inv[4][1] - P[8][8]*S_inv[5][1]) + P[2][11]*(-P[8][0]*S_inv[0][2] - P[8][1]*S_inv[1][2] - P[8][2]*S_inv[2][2] - P[8][6]*S_inv[3][2] - P[8][7]*S_inv[4][2] - P[8][8]*S_inv[5][2]) + P[6][11]*(-P[8][0]*S_inv[0][3] - P[8][1]*S_inv[1][3] - P[8][2]*S_inv[2][3] - P[8][6]*S_inv[3][3] - P[8][7]*S_inv[4][3] - P[8][8]*S_inv[5][3]) + P[7][11]*(-P[8][0]*S_inv[0][4] - P[8][1]*S_inv[1][4] - P[8][2]*S_inv[2][4] - P[8][6]*S_inv[3][4] - P[8][7]*S_inv[4][4] - P[8][8]*S_inv[5][4]) + P[8][11]*(-P[8][0]*S_inv[0][5] - P[8][1]*S_inv[1][5] - P[8][2]*S_inv[2][5] - P[8][6]*S_inv[3][5] - P[8][7]*S_inv[4][5] - P[8][8]*S_inv[5][5] + 1);
    P_up[8][12] = P[0][12]*(-P[8][0]*S_inv[0][0] - P[8][1]*S_inv[1][0] - P[8][2]*S_inv[2][0] - P[8][6]*S_inv[3][0] - P[8][7]*S_inv[4][0] - P[8][8]*S_inv[5][0]) + P[1][12]*(-P[8][0]*S_inv[0][1] - P[8][1]*S_inv[1][1] - P[8][2]*S_inv[2][1] - P[8][6]*S_inv[3][1] - P[8][7]*S_inv[4][1] - P[8][8]*S_inv[5][1]) + P[2][12]*(-P[8][0]*S_inv[0][2] - P[8][1]*S_inv[1][2] - P[8][2]*S_inv[2][2] - P[8][6]*S_inv[3][2] - P[8][7]*S_inv[4][2] - P[8][8]*S_inv[5][2]) + P[6][12]*(-P[8][0]*S_inv[0][3] - P[8][1]*S_inv[1][3] - P[8][2]*S_inv[2][3] - P[8][6]*S_inv[3][3] - P[8][7]*S_inv[4][3] - P[8][8]*S_inv[5][3]) + P[7][12]*(-P[8][0]*S_inv[0][4] - P[8][1]*S_inv[1][4] - P[8][2]*S_inv[2][4] - P[8][6]*S_inv[3][4] - P[8][7]*S_inv[4][4] - P[8][8]*S_inv[5][4]) + P[8][12]*(-P[8][0]*S_inv[0][5] - P[8][1]*S_inv[1][5] - P[8][2]*S_inv[2][5] - P[8][6]*S_inv[3][5] - P[8][7]*S_inv[4][5] - P[8][8]*S_inv[5][5] + 1);
    P_up[8][13] = P[0][13]*(-P[8][0]*S_inv[0][0] - P[8][1]*S_inv[1][0] - P[8][2]*S_inv[2][0] - P[8][6]*S_inv[3][0] - P[8][7]*S_inv[4][0] - P[8][8]*S_inv[5][0]) + P[1][13]*(-P[8][0]*S_inv[0][1] - P[8][1]*S_inv[1][1] - P[8][2]*S_inv[2][1] - P[8][6]*S_inv[3][1] - P[8][7]*S_inv[4][1] - P[8][8]*S_inv[5][1]) + P[2][13]*(-P[8][0]*S_inv[0][2] - P[8][1]*S_inv[1][2] - P[8][2]*S_inv[2][2] - P[8][6]*S_inv[3][2] - P[8][7]*S_inv[4][2] - P[8][8]*S_inv[5][2]) + P[6][13]*(-P[8][0]*S_inv[0][3] - P[8][1]*S_inv[1][3] - P[8][2]*S_inv[2][3] - P[8][6]*S_inv[3][3] - P[8][7]*S_inv[4][3] - P[8][8]*S_inv[5][3]) + P[7][13]*(-P[8][0]*S_inv[0][4] - P[8][1]*S_inv[1][4] - P[8][2]*S_inv[2][4] - P[8][6]*S_inv[3][4] - P[8][7]*S_inv[4][4] - P[8][8]*S_inv[5][4]) + P[8][13]*(-P[8][0]*S_inv[0][5] - P[8][1]*S_inv[1][5] - P[8][2]*S_inv[2][5] - P[8][6]*S_inv[3][5] - P[8][7]*S_inv[4][5] - P[8][8]*S_inv[5][5] + 1);
    P_up[8][14] = P[0][14]*(-P[8][0]*S_inv[0][0] - P[8][1]*S_inv[1][0] - P[8][2]*S_inv[2][0] - P[8][6]*S_inv[3][0] - P[8][7]*S_inv[4][0] - P[8][8]*S_inv[5][0]) + P[1][14]*(-P[8][0]*S_inv[0][1] - P[8][1]*S_inv[1][1] - P[8][2]*S_inv[2][1] - P[8][6]*S_inv[3][1] - P[8][7]*S_inv[4][1] - P[8][8]*S_inv[5][1]) + P[2][14]*(-P[8][0]*S_inv[0][2] - P[8][1]*S_inv[1][2] - P[8][2]*S_inv[2][2] - P[8][6]*S_inv[3][2] - P[8][7]*S_inv[4][2] - P[8][8]*S_inv[5][2]) + P[6][14]*(-P[8][0]*S_inv[0][3] - P[8][1]*S_inv[1][3] - P[8][2]*S_inv[2][3] - P[8][6]*S_inv[3][3] - P[8][7]*S_inv[4][3] - P[8][8]*S_inv[5][3]) + P[7][14]*(-P[8][0]*S_inv[0][4] - P[8][1]*S_inv[1][4] - P[8][2]*S_inv[2][4] - P[8][6]*S_inv[3][4] - P[8][7]*S_inv[4][4] - P[8][8]*S_inv[5][4]) + P[8][14]*(-P[8][0]*S_inv[0][5] - P[8][1]*S_inv[1][5] - P[8][2]*S_inv[2][5] - P[8][6]*S_inv[3][5] - P[8][7]*S_inv[4][5] - P[8][8]*S_inv[5][5] + 1);
    P_up[9][0] = P[0][0]*(-P[9][0]*S_inv[0][0] - P[9][1]*S_inv[1][0] - P[9][2]*S_inv[2][0] - P[9][6]*S_inv[3][0] - P[9][7]*S_inv[4][0] - P[9][8]*S_inv[5][0]) + P[1][0]*(-P[9][0]*S_inv[0][1] - P[9][1]*S_inv[1][1] - P[9][2]*S_inv[2][1] - P[9][6]*S_inv[3][1] - P[9][7]*S_inv[4][1] - P[9][8]*S_inv[5][1]) + P[2][0]*(-P[9][0]*S_inv[0][2] - P[9][1]*S_inv[1][2] - P[9][2]*S_inv[2][2] - P[9][6]*S_inv[3][2] - P[9][7]*S_inv[4][2] - P[9][8]*S_inv[5][2]) + P[6][0]*(-P[9][0]*S_inv[0][3] - P[9][1]*S_inv[1][3] - P[9][2]*S_inv[2][3] - P[9][6]*S_inv[3][3] - P[9][7]*S_inv[4][3] - P[9][8]*S_inv[5][3]) + P[7][0]*(-P[9][0]*S_inv[0][4] - P[9][1]*S_inv[1][4] - P[9][2]*S_inv[2][4] - P[9][6]*S_inv[3][4] - P[9][7]*S_inv[4][4] - P[9][8]*S_inv[5][4]) + P[8][0]*(-P[9][0]*S_inv[0][5] - P[9][1]*S_inv[1][5] - P[9][2]*S_inv[2][5] - P[9][6]*S_inv[3][5] - P[9][7]*S_inv[4][5] - P[9][8]*S_inv[5][5]) + P[9][0];
    P_up[9][1] = P[0][1]*(-P[9][0]*S_inv[0][0] - P[9][1]*S_inv[1][0] - P[9][2]*S_inv[2][0] - P[9][6]*S_inv[3][0] - P[9][7]*S_inv[4][0] - P[9][8]*S_inv[5][0]) + P[1][1]*(-P[9][0]*S_inv[0][1] - P[9][1]*S_inv[1][1] - P[9][2]*S_inv[2][1] - P[9][6]*S_inv[3][1] - P[9][7]*S_inv[4][1] - P[9][8]*S_inv[5][1]) + P[2][1]*(-P[9][0]*S_inv[0][2] - P[9][1]*S_inv[1][2] - P[9][2]*S_inv[2][2] - P[9][6]*S_inv[3][2] - P[9][7]*S_inv[4][2] - P[9][8]*S_inv[5][2]) + P[6][1]*(-P[9][0]*S_inv[0][3] - P[9][1]*S_inv[1][3] - P[9][2]*S_inv[2][3] - P[9][6]*S_inv[3][3] - P[9][7]*S_inv[4][3] - P[9][8]*S_inv[5][3]) + P[7][1]*(-P[9][0]*S_inv[0][4] - P[9][1]*S_inv[1][4] - P[9][2]*S_inv[2][4] - P[9][6]*S_inv[3][4] - P[9][7]*S_inv[4][4] - P[9][8]*S_inv[5][4]) + P[8][1]*(-P[9][0]*S_inv[0][5] - P[9][1]*S_inv[1][5] - P[9][2]*S_inv[2][5] - P[9][6]*S_inv[3][5] - P[9][7]*S_inv[4][5] - P[9][8]*S_inv[5][5]) + P[9][1];
    P_up[9][2] = P[0][2]*(-P[9][0]*S_inv[0][0] - P[9][1]*S_inv[1][0] - P[9][2]*S_inv[2][0] - P[9][6]*S_inv[3][0] - P[9][7]*S_inv[4][0] - P[9][8]*S_inv[5][0]) + P[1][2]*(-P[9][0]*S_inv[0][1] - P[9][1]*S_inv[1][1] - P[9][2]*S_inv[2][1] - P[9][6]*S_inv[3][1] - P[9][7]*S_inv[4][1] - P[9][8]*S_inv[5][1]) + P[2][2]*(-P[9][0]*S_inv[0][2] - P[9][1]*S_inv[1][2] - P[9][2]*S_inv[2][2] - P[9][6]*S_inv[3][2] - P[9][7]*S_inv[4][2] - P[9][8]*S_inv[5][2]) + P[6][2]*(-P[9][0]*S_inv[0][3] - P[9][1]*S_inv[1][3] - P[9][2]*S_inv[2][3] - P[9][6]*S_inv[3][3] - P[9][7]*S_inv[4][3] - P[9][8]*S_inv[5][3]) + P[7][2]*(-P[9][0]*S_inv[0][4] - P[9][1]*S_inv[1][4] - P[9][2]*S_inv[2][4] - P[9][6]*S_inv[3][4] - P[9][7]*S_inv[4][4] - P[9][8]*S_inv[5][4]) + P[8][2]*(-P[9][0]*S_inv[0][5] - P[9][1]*S_inv[1][5] - P[9][2]*S_inv[2][5] - P[9][6]*S_inv[3][5] - P[9][7]*S_inv[4][5] - P[9][8]*S_inv[5][5]) + P[9][2];
    P_up[9][3] = P[0][3]*(-P[9][0]*S_inv[0][0] - P[9][1]*S_inv[1][0] - P[9][2]*S_inv[2][0] - P[9][6]*S_inv[3][0] - P[9][7]*S_inv[4][0] - P[9][8]*S_inv[5][0]) + P[1][3]*(-P[9][0]*S_inv[0][1] - P[9][1]*S_inv[1][1] - P[9][2]*S_inv[2][1] - P[9][6]*S_inv[3][1] - P[9][7]*S_inv[4][1] - P[9][8]*S_inv[5][1]) + P[2][3]*(-P[9][0]*S_inv[0][2] - P[9][1]*S_inv[1][2] - P[9][2]*S_inv[2][2] - P[9][6]*S_inv[3][2] - P[9][7]*S_inv[4][2] - P[9][8]*S_inv[5][2]) + P[6][3]*(-P[9][0]*S_inv[0][3] - P[9][1]*S_inv[1][3] - P[9][2]*S_inv[2][3] - P[9][6]*S_inv[3][3] - P[9][7]*S_inv[4][3] - P[9][8]*S_inv[5][3]) + P[7][3]*(-P[9][0]*S_inv[0][4] - P[9][1]*S_inv[1][4] - P[9][2]*S_inv[2][4] - P[9][6]*S_inv[3][4] - P[9][7]*S_inv[4][4] - P[9][8]*S_inv[5][4]) + P[8][3]*(-P[9][0]*S_inv[0][5] - P[9][1]*S_inv[1][5] - P[9][2]*S_inv[2][5] - P[9][6]*S_inv[3][5] - P[9][7]*S_inv[4][5] - P[9][8]*S_inv[5][5]) + P[9][3];
    P_up[9][4] = P[0][4]*(-P[9][0]*S_inv[0][0] - P[9][1]*S_inv[1][0] - P[9][2]*S_inv[2][0] - P[9][6]*S_inv[3][0] - P[9][7]*S_inv[4][0] - P[9][8]*S_inv[5][0]) + P[1][4]*(-P[9][0]*S_inv[0][1] - P[9][1]*S_inv[1][1] - P[9][2]*S_inv[2][1] - P[9][6]*S_inv[3][1] - P[9][7]*S_inv[4][1] - P[9][8]*S_inv[5][1]) + P[2][4]*(-P[9][0]*S_inv[0][2] - P[9][1]*S_inv[1][2] - P[9][2]*S_inv[2][2] - P[9][6]*S_inv[3][2] - P[9][7]*S_inv[4][2] - P[9][8]*S_inv[5][2]) + P[6][4]*(-P[9][0]*S_inv[0][3] - P[9][1]*S_inv[1][3] - P[9][2]*S_inv[2][3] - P[9][6]*S_inv[3][3] - P[9][7]*S_inv[4][3] - P[9][8]*S_inv[5][3]) + P[7][4]*(-P[9][0]*S_inv[0][4] - P[9][1]*S_inv[1][4] - P[9][2]*S_inv[2][4] - P[9][6]*S_inv[3][4] - P[9][7]*S_inv[4][4] - P[9][8]*S_inv[5][4]) + P[8][4]*(-P[9][0]*S_inv[0][5] - P[9][1]*S_inv[1][5] - P[9][2]*S_inv[2][5] - P[9][6]*S_inv[3][5] - P[9][7]*S_inv[4][5] - P[9][8]*S_inv[5][5]) + P[9][4];
    P_up[9][5] = P[0][5]*(-P[9][0]*S_inv[0][0] - P[9][1]*S_inv[1][0] - P[9][2]*S_inv[2][0] - P[9][6]*S_inv[3][0] - P[9][7]*S_inv[4][0] - P[9][8]*S_inv[5][0]) + P[1][5]*(-P[9][0]*S_inv[0][1] - P[9][1]*S_inv[1][1] - P[9][2]*S_inv[2][1] - P[9][6]*S_inv[3][1] - P[9][7]*S_inv[4][1] - P[9][8]*S_inv[5][1]) + P[2][5]*(-P[9][0]*S_inv[0][2] - P[9][1]*S_inv[1][2] - P[9][2]*S_inv[2][2] - P[9][6]*S_inv[3][2] - P[9][7]*S_inv[4][2] - P[9][8]*S_inv[5][2]) + P[6][5]*(-P[9][0]*S_inv[0][3] - P[9][1]*S_inv[1][3] - P[9][2]*S_inv[2][3] - P[9][6]*S_inv[3][3] - P[9][7]*S_inv[4][3] - P[9][8]*S_inv[5][3]) + P[7][5]*(-P[9][0]*S_inv[0][4] - P[9][1]*S_inv[1][4] - P[9][2]*S_inv[2][4] - P[9][6]*S_inv[3][4] - P[9][7]*S_inv[4][4] - P[9][8]*S_inv[5][4]) + P[8][5]*(-P[9][0]*S_inv[0][5] - P[9][1]*S_inv[1][5] - P[9][2]*S_inv[2][5] - P[9][6]*S_inv[3][5] - P[9][7]*S_inv[4][5] - P[9][8]*S_inv[5][5]) + P[9][5];
    P_up[9][6] = P[0][6]*(-P[9][0]*S_inv[0][0] - P[9][1]*S_inv[1][0] - P[9][2]*S_inv[2][0] - P[9][6]*S_inv[3][0] - P[9][7]*S_inv[4][0] - P[9][8]*S_inv[5][0]) + P[1][6]*(-P[9][0]*S_inv[0][1] - P[9][1]*S_inv[1][1] - P[9][2]*S_inv[2][1] - P[9][6]*S_inv[3][1] - P[9][7]*S_inv[4][1] - P[9][8]*S_inv[5][1]) + P[2][6]*(-P[9][0]*S_inv[0][2] - P[9][1]*S_inv[1][2] - P[9][2]*S_inv[2][2] - P[9][6]*S_inv[3][2] - P[9][7]*S_inv[4][2] - P[9][8]*S_inv[5][2]) + P[6][6]*(-P[9][0]*S_inv[0][3] - P[9][1]*S_inv[1][3] - P[9][2]*S_inv[2][3] - P[9][6]*S_inv[3][3] - P[9][7]*S_inv[4][3] - P[9][8]*S_inv[5][3]) + P[7][6]*(-P[9][0]*S_inv[0][4] - P[9][1]*S_inv[1][4] - P[9][2]*S_inv[2][4] - P[9][6]*S_inv[3][4] - P[9][7]*S_inv[4][4] - P[9][8]*S_inv[5][4]) + P[8][6]*(-P[9][0]*S_inv[0][5] - P[9][1]*S_inv[1][5] - P[9][2]*S_inv[2][5] - P[9][6]*S_inv[3][5] - P[9][7]*S_inv[4][5] - P[9][8]*S_inv[5][5]) + P[9][6];
    P_up[9][7] = P[0][7]*(-P[9][0]*S_inv[0][0] - P[9][1]*S_inv[1][0] - P[9][2]*S_inv[2][0] - P[9][6]*S_inv[3][0] - P[9][7]*S_inv[4][0] - P[9][8]*S_inv[5][0]) + P[1][7]*(-P[9][0]*S_inv[0][1] - P[9][1]*S_inv[1][1] - P[9][2]*S_inv[2][1] - P[9][6]*S_inv[3][1] - P[9][7]*S_inv[4][1] - P[9][8]*S_inv[5][1]) + P[2][7]*(-P[9][0]*S_inv[0][2] - P[9][1]*S_inv[1][2] - P[9][2]*S_inv[2][2] - P[9][6]*S_inv[3][2] - P[9][7]*S_inv[4][2] - P[9][8]*S_inv[5][2]) + P[6][7]*(-P[9][0]*S_inv[0][3] - P[9][1]*S_inv[1][3] - P[9][2]*S_inv[2][3] - P[9][6]*S_inv[3][3] - P[9][7]*S_inv[4][3] - P[9][8]*S_inv[5][3]) + P[7][7]*(-P[9][0]*S_inv[0][4] - P[9][1]*S_inv[1][4] - P[9][2]*S_inv[2][4] - P[9][6]*S_inv[3][4] - P[9][7]*S_inv[4][4] - P[9][8]*S_inv[5][4]) + P[8][7]*(-P[9][0]*S_inv[0][5] - P[9][1]*S_inv[1][5] - P[9][2]*S_inv[2][5] - P[9][6]*S_inv[3][5] - P[9][7]*S_inv[4][5] - P[9][8]*S_inv[5][5]) + P[9][7];
    P_up[9][8] = P[0][8]*(-P[9][0]*S_inv[0][0] - P[9][1]*S_inv[1][0] - P[9][2]*S_inv[2][0] - P[9][6]*S_inv[3][0] - P[9][7]*S_inv[4][0] - P[9][8]*S_inv[5][0]) + P[1][8]*(-P[9][0]*S_inv[0][1] - P[9][1]*S_inv[1][1] - P[9][2]*S_inv[2][1] - P[9][6]*S_inv[3][1] - P[9][7]*S_inv[4][1] - P[9][8]*S_inv[5][1]) + P[2][8]*(-P[9][0]*S_inv[0][2] - P[9][1]*S_inv[1][2] - P[9][2]*S_inv[2][2] - P[9][6]*S_inv[3][2] - P[9][7]*S_inv[4][2] - P[9][8]*S_inv[5][2]) + P[6][8]*(-P[9][0]*S_inv[0][3] - P[9][1]*S_inv[1][3] - P[9][2]*S_inv[2][3] - P[9][6]*S_inv[3][3] - P[9][7]*S_inv[4][3] - P[9][8]*S_inv[5][3]) + P[7][8]*(-P[9][0]*S_inv[0][4] - P[9][1]*S_inv[1][4] - P[9][2]*S_inv[2][4] - P[9][6]*S_inv[3][4] - P[9][7]*S_inv[4][4] - P[9][8]*S_inv[5][4]) + P[8][8]*(-P[9][0]*S_inv[0][5] - P[9][1]*S_inv[1][5] - P[9][2]*S_inv[2][5] - P[9][6]*S_inv[3][5] - P[9][7]*S_inv[4][5] - P[9][8]*S_inv[5][5]) + P[9][8];
    P_up[9][9] = P[0][9]*(-P[9][0]*S_inv[0][0] - P[9][1]*S_inv[1][0] - P[9][2]*S_inv[2][0] - P[9][6]*S_inv[3][0] - P[9][7]*S_inv[4][0] - P[9][8]*S_inv[5][0]) + P[1][9]*(-P[9][0]*S_inv[0][1] - P[9][1]*S_inv[1][1] - P[9][2]*S_inv[2][1] - P[9][6]*S_inv[3][1] - P[9][7]*S_inv[4][1] - P[9][8]*S_inv[5][1]) + P[2][9]*(-P[9][0]*S_inv[0][2] - P[9][1]*S_inv[1][2] - P[9][2]*S_inv[2][2] - P[9][6]*S_inv[3][2] - P[9][7]*S_inv[4][2] - P[9][8]*S_inv[5][2]) + P[6][9]*(-P[9][0]*S_inv[0][3] - P[9][1]*S_inv[1][3] - P[9][2]*S_inv[2][3] - P[9][6]*S_inv[3][3] - P[9][7]*S_inv[4][3] - P[9][8]*S_inv[5][3]) + P[7][9]*(-P[9][0]*S_inv[0][4] - P[9][1]*S_inv[1][4] - P[9][2]*S_inv[2][4] - P[9][6]*S_inv[3][4] - P[9][7]*S_inv[4][4] - P[9][8]*S_inv[5][4]) + P[8][9]*(-P[9][0]*S_inv[0][5] - P[9][1]*S_inv[1][5] - P[9][2]*S_inv[2][5] - P[9][6]*S_inv[3][5] - P[9][7]*S_inv[4][5] - P[9][8]*S_inv[5][5]) + P[9][9];
    P_up[9][10] = P[0][10]*(-P[9][0]*S_inv[0][0] - P[9][1]*S_inv[1][0] - P[9][2]*S_inv[2][0] - P[9][6]*S_inv[3][0] - P[9][7]*S_inv[4][0] - P[9][8]*S_inv[5][0]) + P[1][10]*(-P[9][0]*S_inv[0][1] - P[9][1]*S_inv[1][1] - P[9][2]*S_inv[2][1] - P[9][6]*S_inv[3][1] - P[9][7]*S_inv[4][1] - P[9][8]*S_inv[5][1]) + P[2][10]*(-P[9][0]*S_inv[0][2] - P[9][1]*S_inv[1][2] - P[9][2]*S_inv[2][2] - P[9][6]*S_inv[3][2] - P[9][7]*S_inv[4][2] - P[9][8]*S_inv[5][2]) + P[6][10]*(-P[9][0]*S_inv[0][3] - P[9][1]*S_inv[1][3] - P[9][2]*S_inv[2][3] - P[9][6]*S_inv[3][3] - P[9][7]*S_inv[4][3] - P[9][8]*S_inv[5][3]) + P[7][10]*(-P[9][0]*S_inv[0][4] - P[9][1]*S_inv[1][4] - P[9][2]*S_inv[2][4] - P[9][6]*S_inv[3][4] - P[9][7]*S_inv[4][4] - P[9][8]*S_inv[5][4]) + P[8][10]*(-P[9][0]*S_inv[0][5] - P[9][1]*S_inv[1][5] - P[9][2]*S_inv[2][5] - P[9][6]*S_inv[3][5] - P[9][7]*S_inv[4][5] - P[9][8]*S_inv[5][5]) + P[9][10];
    P_up[9][11] = P[0][11]*(-P[9][0]*S_inv[0][0] - P[9][1]*S_inv[1][0] - P[9][2]*S_inv[2][0] - P[9][6]*S_inv[3][0] - P[9][7]*S_inv[4][0] - P[9][8]*S_inv[5][0]) + P[1][11]*(-P[9][0]*S_inv[0][1] - P[9][1]*S_inv[1][1] - P[9][2]*S_inv[2][1] - P[9][6]*S_inv[3][1] - P[9][7]*S_inv[4][1] - P[9][8]*S_inv[5][1]) + P[2][11]*(-P[9][0]*S_inv[0][2] - P[9][1]*S_inv[1][2] - P[9][2]*S_inv[2][2] - P[9][6]*S_inv[3][2] - P[9][7]*S_inv[4][2] - P[9][8]*S_inv[5][2]) + P[6][11]*(-P[9][0]*S_inv[0][3] - P[9][1]*S_inv[1][3] - P[9][2]*S_inv[2][3] - P[9][6]*S_inv[3][3] - P[9][7]*S_inv[4][3] - P[9][8]*S_inv[5][3]) + P[7][11]*(-P[9][0]*S_inv[0][4] - P[9][1]*S_inv[1][4] - P[9][2]*S_inv[2][4] - P[9][6]*S_inv[3][4] - P[9][7]*S_inv[4][4] - P[9][8]*S_inv[5][4]) + P[8][11]*(-P[9][0]*S_inv[0][5] - P[9][1]*S_inv[1][5] - P[9][2]*S_inv[2][5] - P[9][6]*S_inv[3][5] - P[9][7]*S_inv[4][5] - P[9][8]*S_inv[5][5]) + P[9][11];
    P_up[9][12] = P[0][12]*(-P[9][0]*S_inv[0][0] - P[9][1]*S_inv[1][0] - P[9][2]*S_inv[2][0] - P[9][6]*S_inv[3][0] - P[9][7]*S_inv[4][0] - P[9][8]*S_inv[5][0]) + P[1][12]*(-P[9][0]*S_inv[0][1] - P[9][1]*S_inv[1][1] - P[9][2]*S_inv[2][1] - P[9][6]*S_inv[3][1] - P[9][7]*S_inv[4][1] - P[9][8]*S_inv[5][1]) + P[2][12]*(-P[9][0]*S_inv[0][2] - P[9][1]*S_inv[1][2] - P[9][2]*S_inv[2][2] - P[9][6]*S_inv[3][2] - P[9][7]*S_inv[4][2] - P[9][8]*S_inv[5][2]) + P[6][12]*(-P[9][0]*S_inv[0][3] - P[9][1]*S_inv[1][3] - P[9][2]*S_inv[2][3] - P[9][6]*S_inv[3][3] - P[9][7]*S_inv[4][3] - P[9][8]*S_inv[5][3]) + P[7][12]*(-P[9][0]*S_inv[0][4] - P[9][1]*S_inv[1][4] - P[9][2]*S_inv[2][4] - P[9][6]*S_inv[3][4] - P[9][7]*S_inv[4][4] - P[9][8]*S_inv[5][4]) + P[8][12]*(-P[9][0]*S_inv[0][5] - P[9][1]*S_inv[1][5] - P[9][2]*S_inv[2][5] - P[9][6]*S_inv[3][5] - P[9][7]*S_inv[4][5] - P[9][8]*S_inv[5][5]) + P[9][12];
    P_up[9][13] = P[0][13]*(-P[9][0]*S_inv[0][0] - P[9][1]*S_inv[1][0] - P[9][2]*S_inv[2][0] - P[9][6]*S_inv[3][0] - P[9][7]*S_inv[4][0] - P[9][8]*S_inv[5][0]) + P[1][13]*(-P[9][0]*S_inv[0][1] - P[9][1]*S_inv[1][1] - P[9][2]*S_inv[2][1] - P[9][6]*S_inv[3][1] - P[9][7]*S_inv[4][1] - P[9][8]*S_inv[5][1]) + P[2][13]*(-P[9][0]*S_inv[0][2] - P[9][1]*S_inv[1][2] - P[9][2]*S_inv[2][2] - P[9][6]*S_inv[3][2] - P[9][7]*S_inv[4][2] - P[9][8]*S_inv[5][2]) + P[6][13]*(-P[9][0]*S_inv[0][3] - P[9][1]*S_inv[1][3] - P[9][2]*S_inv[2][3] - P[9][6]*S_inv[3][3] - P[9][7]*S_inv[4][3] - P[9][8]*S_inv[5][3]) + P[7][13]*(-P[9][0]*S_inv[0][4] - P[9][1]*S_inv[1][4] - P[9][2]*S_inv[2][4] - P[9][6]*S_inv[3][4] - P[9][7]*S_inv[4][4] - P[9][8]*S_inv[5][4]) + P[8][13]*(-P[9][0]*S_inv[0][5] - P[9][1]*S_inv[1][5] - P[9][2]*S_inv[2][5] - P[9][6]*S_inv[3][5] - P[9][7]*S_inv[4][5] - P[9][8]*S_inv[5][5]) + P[9][13];
    P_up[9][14] = P[0][14]*(-P[9][0]*S_inv[0][0] - P[9][1]*S_inv[1][0] - P[9][2]*S_inv[2][0] - P[9][6]*S_inv[3][0] - P[9][7]*S_inv[4][0] - P[9][8]*S_inv[5][0]) + P[1][14]*(-P[9][0]*S_inv[0][1] - P[9][1]*S_inv[1][1] - P[9][2]*S_inv[2][1] - P[9][6]*S_inv[3][1] - P[9][7]*S_inv[4][1] - P[9][8]*S_inv[5][1]) + P[2][14]*(-P[9][0]*S_inv[0][2] - P[9][1]*S_inv[1][2] - P[9][2]*S_inv[2][2] - P[9][6]*S_inv[3][2] - P[9][7]*S_inv[4][2] - P[9][8]*S_inv[5][2]) + P[6][14]*(-P[9][0]*S_inv[0][3] - P[9][1]*S_inv[1][3] - P[9][2]*S_inv[2][3] - P[9][6]*S_inv[3][3] - P[9][7]*S_inv[4][3] - P[9][8]*S_inv[5][3]) + P[7][14]*(-P[9][0]*S_inv[0][4] - P[9][1]*S_inv[1][4] - P[9][2]*S_inv[2][4] - P[9][6]*S_inv[3][4] - P[9][7]*S_inv[4][4] - P[9][8]*S_inv[5][4]) + P[8][14]*(-P[9][0]*S_inv[0][5] - P[9][1]*S_inv[1][5] - P[9][2]*S_inv[2][5] - P[9][6]*S_inv[3][5] - P[9][7]*S_inv[4][5] - P[9][8]*S_inv[5][5]) + P[9][14];
    P_up[10][0] = P[0][0]*(-P[10][0]*S_inv[0][0] - P[10][1]*S_inv[1][0] - P[10][2]*S_inv[2][0] - P[10][6]*S_inv[3][0] - P[10][7]*S_inv[4][0] - P[10][8]*S_inv[5][0]) + P[10][0] + P[1][0]*(-P[10][0]*S_inv[0][1] - P[10][1]*S_inv[1][1] - P[10][2]*S_inv[2][1] - P[10][6]*S_inv[3][1] - P[10][7]*S_inv[4][1] - P[10][8]*S_inv[5][1]) + P[2][0]*(-P[10][0]*S_inv[0][2] - P[10][1]*S_inv[1][2] - P[10][2]*S_inv[2][2] - P[10][6]*S_inv[3][2] - P[10][7]*S_inv[4][2] - P[10][8]*S_inv[5][2]) + P[6][0]*(-P[10][0]*S_inv[0][3] - P[10][1]*S_inv[1][3] - P[10][2]*S_inv[2][3] - P[10][6]*S_inv[3][3] - P[10][7]*S_inv[4][3] - P[10][8]*S_inv[5][3]) + P[7][0]*(-P[10][0]*S_inv[0][4] - P[10][1]*S_inv[1][4] - P[10][2]*S_inv[2][4] - P[10][6]*S_inv[3][4] - P[10][7]*S_inv[4][4] - P[10][8]*S_inv[5][4]) + P[8][0]*(-P[10][0]*S_inv[0][5] - P[10][1]*S_inv[1][5] - P[10][2]*S_inv[2][5] - P[10][6]*S_inv[3][5] - P[10][7]*S_inv[4][5] - P[10][8]*S_inv[5][5]);
    P_up[10][1] = P[0][1]*(-P[10][0]*S_inv[0][0] - P[10][1]*S_inv[1][0] - P[10][2]*S_inv[2][0] - P[10][6]*S_inv[3][0] - P[10][7]*S_inv[4][0] - P[10][8]*S_inv[5][0]) + P[10][1] + P[1][1]*(-P[10][0]*S_inv[0][1] - P[10][1]*S_inv[1][1] - P[10][2]*S_inv[2][1] - P[10][6]*S_inv[3][1] - P[10][7]*S_inv[4][1] - P[10][8]*S_inv[5][1]) + P[2][1]*(-P[10][0]*S_inv[0][2] - P[10][1]*S_inv[1][2] - P[10][2]*S_inv[2][2] - P[10][6]*S_inv[3][2] - P[10][7]*S_inv[4][2] - P[10][8]*S_inv[5][2]) + P[6][1]*(-P[10][0]*S_inv[0][3] - P[10][1]*S_inv[1][3] - P[10][2]*S_inv[2][3] - P[10][6]*S_inv[3][3] - P[10][7]*S_inv[4][3] - P[10][8]*S_inv[5][3]) + P[7][1]*(-P[10][0]*S_inv[0][4] - P[10][1]*S_inv[1][4] - P[10][2]*S_inv[2][4] - P[10][6]*S_inv[3][4] - P[10][7]*S_inv[4][4] - P[10][8]*S_inv[5][4]) + P[8][1]*(-P[10][0]*S_inv[0][5] - P[10][1]*S_inv[1][5] - P[10][2]*S_inv[2][5] - P[10][6]*S_inv[3][5] - P[10][7]*S_inv[4][5] - P[10][8]*S_inv[5][5]);
    P_up[10][2] = P[0][2]*(-P[10][0]*S_inv[0][0] - P[10][1]*S_inv[1][0] - P[10][2]*S_inv[2][0] - P[10][6]*S_inv[3][0] - P[10][7]*S_inv[4][0] - P[10][8]*S_inv[5][0]) + P[10][2] + P[1][2]*(-P[10][0]*S_inv[0][1] - P[10][1]*S_inv[1][1] - P[10][2]*S_inv[2][1] - P[10][6]*S_inv[3][1] - P[10][7]*S_inv[4][1] - P[10][8]*S_inv[5][1]) + P[2][2]*(-P[10][0]*S_inv[0][2] - P[10][1]*S_inv[1][2] - P[10][2]*S_inv[2][2] - P[10][6]*S_inv[3][2] - P[10][7]*S_inv[4][2] - P[10][8]*S_inv[5][2]) + P[6][2]*(-P[10][0]*S_inv[0][3] - P[10][1]*S_inv[1][3] - P[10][2]*S_inv[2][3] - P[10][6]*S_inv[3][3] - P[10][7]*S_inv[4][3] - P[10][8]*S_inv[5][3]) + P[7][2]*(-P[10][0]*S_inv[0][4] - P[10][1]*S_inv[1][4] - P[10][2]*S_inv[2][4] - P[10][6]*S_inv[3][4] - P[10][7]*S_inv[4][4] - P[10][8]*S_inv[5][4]) + P[8][2]*(-P[10][0]*S_inv[0][5] - P[10][1]*S_inv[1][5] - P[10][2]*S_inv[2][5] - P[10][6]*S_inv[3][5] - P[10][7]*S_inv[4][5] - P[10][8]*S_inv[5][5]);
    P_up[10][3] = P[0][3]*(-P[10][0]*S_inv[0][0] - P[10][1]*S_inv[1][0] - P[10][2]*S_inv[2][0] - P[10][6]*S_inv[3][0] - P[10][7]*S_inv[4][0] - P[10][8]*S_inv[5][0]) + P[10][3] + P[1][3]*(-P[10][0]*S_inv[0][1] - P[10][1]*S_inv[1][1] - P[10][2]*S_inv[2][1] - P[10][6]*S_inv[3][1] - P[10][7]*S_inv[4][1] - P[10][8]*S_inv[5][1]) + P[2][3]*(-P[10][0]*S_inv[0][2] - P[10][1]*S_inv[1][2] - P[10][2]*S_inv[2][2] - P[10][6]*S_inv[3][2] - P[10][7]*S_inv[4][2] - P[10][8]*S_inv[5][2]) + P[6][3]*(-P[10][0]*S_inv[0][3] - P[10][1]*S_inv[1][3] - P[10][2]*S_inv[2][3] - P[10][6]*S_inv[3][3] - P[10][7]*S_inv[4][3] - P[10][8]*S_inv[5][3]) + P[7][3]*(-P[10][0]*S_inv[0][4] - P[10][1]*S_inv[1][4] - P[10][2]*S_inv[2][4] - P[10][6]*S_inv[3][4] - P[10][7]*S_inv[4][4] - P[10][8]*S_inv[5][4]) + P[8][3]*(-P[10][0]*S_inv[0][5] - P[10][1]*S_inv[1][5] - P[10][2]*S_inv[2][5] - P[10][6]*S_inv[3][5] - P[10][7]*S_inv[4][5] - P[10][8]*S_inv[5][5]);
    P_up[10][4] = P[0][4]*(-P[10][0]*S_inv[0][0] - P[10][1]*S_inv[1][0] - P[10][2]*S_inv[2][0] - P[10][6]*S_inv[3][0] - P[10][7]*S_inv[4][0] - P[10][8]*S_inv[5][0]) + P[10][4] + P[1][4]*(-P[10][0]*S_inv[0][1] - P[10][1]*S_inv[1][1] - P[10][2]*S_inv[2][1] - P[10][6]*S_inv[3][1] - P[10][7]*S_inv[4][1] - P[10][8]*S_inv[5][1]) + P[2][4]*(-P[10][0]*S_inv[0][2] - P[10][1]*S_inv[1][2] - P[10][2]*S_inv[2][2] - P[10][6]*S_inv[3][2] - P[10][7]*S_inv[4][2] - P[10][8]*S_inv[5][2]) + P[6][4]*(-P[10][0]*S_inv[0][3] - P[10][1]*S_inv[1][3] - P[10][2]*S_inv[2][3] - P[10][6]*S_inv[3][3] - P[10][7]*S_inv[4][3] - P[10][8]*S_inv[5][3]) + P[7][4]*(-P[10][0]*S_inv[0][4] - P[10][1]*S_inv[1][4] - P[10][2]*S_inv[2][4] - P[10][6]*S_inv[3][4] - P[10][7]*S_inv[4][4] - P[10][8]*S_inv[5][4]) + P[8][4]*(-P[10][0]*S_inv[0][5] - P[10][1]*S_inv[1][5] - P[10][2]*S_inv[2][5] - P[10][6]*S_inv[3][5] - P[10][7]*S_inv[4][5] - P[10][8]*S_inv[5][5]);
    P_up[10][5] = P[0][5]*(-P[10][0]*S_inv[0][0] - P[10][1]*S_inv[1][0] - P[10][2]*S_inv[2][0] - P[10][6]*S_inv[3][0] - P[10][7]*S_inv[4][0] - P[10][8]*S_inv[5][0]) + P[10][5] + P[1][5]*(-P[10][0]*S_inv[0][1] - P[10][1]*S_inv[1][1] - P[10][2]*S_inv[2][1] - P[10][6]*S_inv[3][1] - P[10][7]*S_inv[4][1] - P[10][8]*S_inv[5][1]) + P[2][5]*(-P[10][0]*S_inv[0][2] - P[10][1]*S_inv[1][2] - P[10][2]*S_inv[2][2] - P[10][6]*S_inv[3][2] - P[10][7]*S_inv[4][2] - P[10][8]*S_inv[5][2]) + P[6][5]*(-P[10][0]*S_inv[0][3] - P[10][1]*S_inv[1][3] - P[10][2]*S_inv[2][3] - P[10][6]*S_inv[3][3] - P[10][7]*S_inv[4][3] - P[10][8]*S_inv[5][3]) + P[7][5]*(-P[10][0]*S_inv[0][4] - P[10][1]*S_inv[1][4] - P[10][2]*S_inv[2][4] - P[10][6]*S_inv[3][4] - P[10][7]*S_inv[4][4] - P[10][8]*S_inv[5][4]) + P[8][5]*(-P[10][0]*S_inv[0][5] - P[10][1]*S_inv[1][5] - P[10][2]*S_inv[2][5] - P[10][6]*S_inv[3][5] - P[10][7]*S_inv[4][5] - P[10][8]*S_inv[5][5]);
    P_up[10][6] = P[0][6]*(-P[10][0]*S_inv[0][0] - P[10][1]*S_inv[1][0] - P[10][2]*S_inv[2][0] - P[10][6]*S_inv[3][0] - P[10][7]*S_inv[4][0] - P[10][8]*S_inv[5][0]) + P[10][6] + P[1][6]*(-P[10][0]*S_inv[0][1] - P[10][1]*S_inv[1][1] - P[10][2]*S_inv[2][1] - P[10][6]*S_inv[3][1] - P[10][7]*S_inv[4][1] - P[10][8]*S_inv[5][1]) + P[2][6]*(-P[10][0]*S_inv[0][2] - P[10][1]*S_inv[1][2] - P[10][2]*S_inv[2][2] - P[10][6]*S_inv[3][2] - P[10][7]*S_inv[4][2] - P[10][8]*S_inv[5][2]) + P[6][6]*(-P[10][0]*S_inv[0][3] - P[10][1]*S_inv[1][3] - P[10][2]*S_inv[2][3] - P[10][6]*S_inv[3][3] - P[10][7]*S_inv[4][3] - P[10][8]*S_inv[5][3]) + P[7][6]*(-P[10][0]*S_inv[0][4] - P[10][1]*S_inv[1][4] - P[10][2]*S_inv[2][4] - P[10][6]*S_inv[3][4] - P[10][7]*S_inv[4][4] - P[10][8]*S_inv[5][4]) + P[8][6]*(-P[10][0]*S_inv[0][5] - P[10][1]*S_inv[1][5] - P[10][2]*S_inv[2][5] - P[10][6]*S_inv[3][5] - P[10][7]*S_inv[4][5] - P[10][8]*S_inv[5][5]);
    P_up[10][7] = P[0][7]*(-P[10][0]*S_inv[0][0] - P[10][1]*S_inv[1][0] - P[10][2]*S_inv[2][0] - P[10][6]*S_inv[3][0] - P[10][7]*S_inv[4][0] - P[10][8]*S_inv[5][0]) + P[10][7] + P[1][7]*(-P[10][0]*S_inv[0][1] - P[10][1]*S_inv[1][1] - P[10][2]*S_inv[2][1] - P[10][6]*S_inv[3][1] - P[10][7]*S_inv[4][1] - P[10][8]*S_inv[5][1]) + P[2][7]*(-P[10][0]*S_inv[0][2] - P[10][1]*S_inv[1][2] - P[10][2]*S_inv[2][2] - P[10][6]*S_inv[3][2] - P[10][7]*S_inv[4][2] - P[10][8]*S_inv[5][2]) + P[6][7]*(-P[10][0]*S_inv[0][3] - P[10][1]*S_inv[1][3] - P[10][2]*S_inv[2][3] - P[10][6]*S_inv[3][3] - P[10][7]*S_inv[4][3] - P[10][8]*S_inv[5][3]) + P[7][7]*(-P[10][0]*S_inv[0][4] - P[10][1]*S_inv[1][4] - P[10][2]*S_inv[2][4] - P[10][6]*S_inv[3][4] - P[10][7]*S_inv[4][4] - P[10][8]*S_inv[5][4]) + P[8][7]*(-P[10][0]*S_inv[0][5] - P[10][1]*S_inv[1][5] - P[10][2]*S_inv[2][5] - P[10][6]*S_inv[3][5] - P[10][7]*S_inv[4][5] - P[10][8]*S_inv[5][5]);
    P_up[10][8] = P[0][8]*(-P[10][0]*S_inv[0][0] - P[10][1]*S_inv[1][0] - P[10][2]*S_inv[2][0] - P[10][6]*S_inv[3][0] - P[10][7]*S_inv[4][0] - P[10][8]*S_inv[5][0]) + P[10][8] + P[1][8]*(-P[10][0]*S_inv[0][1] - P[10][1]*S_inv[1][1] - P[10][2]*S_inv[2][1] - P[10][6]*S_inv[3][1] - P[10][7]*S_inv[4][1] - P[10][8]*S_inv[5][1]) + P[2][8]*(-P[10][0]*S_inv[0][2] - P[10][1]*S_inv[1][2] - P[10][2]*S_inv[2][2] - P[10][6]*S_inv[3][2] - P[10][7]*S_inv[4][2] - P[10][8]*S_inv[5][2]) + P[6][8]*(-P[10][0]*S_inv[0][3] - P[10][1]*S_inv[1][3] - P[10][2]*S_inv[2][3] - P[10][6]*S_inv[3][3] - P[10][7]*S_inv[4][3] - P[10][8]*S_inv[5][3]) + P[7][8]*(-P[10][0]*S_inv[0][4] - P[10][1]*S_inv[1][4] - P[10][2]*S_inv[2][4] - P[10][6]*S_inv[3][4] - P[10][7]*S_inv[4][4] - P[10][8]*S_inv[5][4]) + P[8][8]*(-P[10][0]*S_inv[0][5] - P[10][1]*S_inv[1][5] - P[10][2]*S_inv[2][5] - P[10][6]*S_inv[3][5] - P[10][7]*S_inv[4][5] - P[10][8]*S_inv[5][5]);
    P_up[10][9] = P[0][9]*(-P[10][0]*S_inv[0][0] - P[10][1]*S_inv[1][0] - P[10][2]*S_inv[2][0] - P[10][6]*S_inv[3][0] - P[10][7]*S_inv[4][0] - P[10][8]*S_inv[5][0]) + P[10][9] + P[1][9]*(-P[10][0]*S_inv[0][1] - P[10][1]*S_inv[1][1] - P[10][2]*S_inv[2][1] - P[10][6]*S_inv[3][1] - P[10][7]*S_inv[4][1] - P[10][8]*S_inv[5][1]) + P[2][9]*(-P[10][0]*S_inv[0][2] - P[10][1]*S_inv[1][2] - P[10][2]*S_inv[2][2] - P[10][6]*S_inv[3][2] - P[10][7]*S_inv[4][2] - P[10][8]*S_inv[5][2]) + P[6][9]*(-P[10][0]*S_inv[0][3] - P[10][1]*S_inv[1][3] - P[10][2]*S_inv[2][3] - P[10][6]*S_inv[3][3] - P[10][7]*S_inv[4][3] - P[10][8]*S_inv[5][3]) + P[7][9]*(-P[10][0]*S_inv[0][4] - P[10][1]*S_inv[1][4] - P[10][2]*S_inv[2][4] - P[10][6]*S_inv[3][4] - P[10][7]*S_inv[4][4] - P[10][8]*S_inv[5][4]) + P[8][9]*(-P[10][0]*S_inv[0][5] - P[10][1]*S_inv[1][5] - P[10][2]*S_inv[2][5] - P[10][6]*S_inv[3][5] - P[10][7]*S_inv[4][5] - P[10][8]*S_inv[5][5]);
    P_up[10][10] = P[0][10]*(-P[10][0]*S_inv[0][0] - P[10][1]*S_inv[1][0] - P[10][2]*S_inv[2][0] - P[10][6]*S_inv[3][0] - P[10][7]*S_inv[4][0] - P[10][8]*S_inv[5][0]) + P[10][10] + P[1][10]*(-P[10][0]*S_inv[0][1] - P[10][1]*S_inv[1][1] - P[10][2]*S_inv[2][1] - P[10][6]*S_inv[3][1] - P[10][7]*S_inv[4][1] - P[10][8]*S_inv[5][1]) + P[2][10]*(-P[10][0]*S_inv[0][2] - P[10][1]*S_inv[1][2] - P[10][2]*S_inv[2][2] - P[10][6]*S_inv[3][2] - P[10][7]*S_inv[4][2] - P[10][8]*S_inv[5][2]) + P[6][10]*(-P[10][0]*S_inv[0][3] - P[10][1]*S_inv[1][3] - P[10][2]*S_inv[2][3] - P[10][6]*S_inv[3][3] - P[10][7]*S_inv[4][3] - P[10][8]*S_inv[5][3]) + P[7][10]*(-P[10][0]*S_inv[0][4] - P[10][1]*S_inv[1][4] - P[10][2]*S_inv[2][4] - P[10][6]*S_inv[3][4] - P[10][7]*S_inv[4][4] - P[10][8]*S_inv[5][4]) + P[8][10]*(-P[10][0]*S_inv[0][5] - P[10][1]*S_inv[1][5] - P[10][2]*S_inv[2][5] - P[10][6]*S_inv[3][5] - P[10][7]*S_inv[4][5] - P[10][8]*S_inv[5][5]);
    P_up[10][11] = P[0][11]*(-P[10][0]*S_inv[0][0] - P[10][1]*S_inv[1][0] - P[10][2]*S_inv[2][0] - P[10][6]*S_inv[3][0] - P[10][7]*S_inv[4][0] - P[10][8]*S_inv[5][0]) + P[10][11] + P[1][11]*(-P[10][0]*S_inv[0][1] - P[10][1]*S_inv[1][1] - P[10][2]*S_inv[2][1] - P[10][6]*S_inv[3][1] - P[10][7]*S_inv[4][1] - P[10][8]*S_inv[5][1]) + P[2][11]*(-P[10][0]*S_inv[0][2] - P[10][1]*S_inv[1][2] - P[10][2]*S_inv[2][2] - P[10][6]*S_inv[3][2] - P[10][7]*S_inv[4][2] - P[10][8]*S_inv[5][2]) + P[6][11]*(-P[10][0]*S_inv[0][3] - P[10][1]*S_inv[1][3] - P[10][2]*S_inv[2][3] - P[10][6]*S_inv[3][3] - P[10][7]*S_inv[4][3] - P[10][8]*S_inv[5][3]) + P[7][11]*(-P[10][0]*S_inv[0][4] - P[10][1]*S_inv[1][4] - P[10][2]*S_inv[2][4] - P[10][6]*S_inv[3][4] - P[10][7]*S_inv[4][4] - P[10][8]*S_inv[5][4]) + P[8][11]*(-P[10][0]*S_inv[0][5] - P[10][1]*S_inv[1][5] - P[10][2]*S_inv[2][5] - P[10][6]*S_inv[3][5] - P[10][7]*S_inv[4][5] - P[10][8]*S_inv[5][5]);
    P_up[10][12] = P[0][12]*(-P[10][0]*S_inv[0][0] - P[10][1]*S_inv[1][0] - P[10][2]*S_inv[2][0] - P[10][6]*S_inv[3][0] - P[10][7]*S_inv[4][0] - P[10][8]*S_inv[5][0]) + P[10][12] + P[1][12]*(-P[10][0]*S_inv[0][1] - P[10][1]*S_inv[1][1] - P[10][2]*S_inv[2][1] - P[10][6]*S_inv[3][1] - P[10][7]*S_inv[4][1] - P[10][8]*S_inv[5][1]) + P[2][12]*(-P[10][0]*S_inv[0][2] - P[10][1]*S_inv[1][2] - P[10][2]*S_inv[2][2] - P[10][6]*S_inv[3][2] - P[10][7]*S_inv[4][2] - P[10][8]*S_inv[5][2]) + P[6][12]*(-P[10][0]*S_inv[0][3] - P[10][1]*S_inv[1][3] - P[10][2]*S_inv[2][3] - P[10][6]*S_inv[3][3] - P[10][7]*S_inv[4][3] - P[10][8]*S_inv[5][3]) + P[7][12]*(-P[10][0]*S_inv[0][4] - P[10][1]*S_inv[1][4] - P[10][2]*S_inv[2][4] - P[10][6]*S_inv[3][4] - P[10][7]*S_inv[4][4] - P[10][8]*S_inv[5][4]) + P[8][12]*(-P[10][0]*S_inv[0][5] - P[10][1]*S_inv[1][5] - P[10][2]*S_inv[2][5] - P[10][6]*S_inv[3][5] - P[10][7]*S_inv[4][5] - P[10][8]*S_inv[5][5]);
    P_up[10][13] = P[0][13]*(-P[10][0]*S_inv[0][0] - P[10][1]*S_inv[1][0] - P[10][2]*S_inv[2][0] - P[10][6]*S_inv[3][0] - P[10][7]*S_inv[4][0] - P[10][8]*S_inv[5][0]) + P[10][13] + P[1][13]*(-P[10][0]*S_inv[0][1] - P[10][1]*S_inv[1][1] - P[10][2]*S_inv[2][1] - P[10][6]*S_inv[3][1] - P[10][7]*S_inv[4][1] - P[10][8]*S_inv[5][1]) + P[2][13]*(-P[10][0]*S_inv[0][2] - P[10][1]*S_inv[1][2] - P[10][2]*S_inv[2][2] - P[10][6]*S_inv[3][2] - P[10][7]*S_inv[4][2] - P[10][8]*S_inv[5][2]) + P[6][13]*(-P[10][0]*S_inv[0][3] - P[10][1]*S_inv[1][3] - P[10][2]*S_inv[2][3] - P[10][6]*S_inv[3][3] - P[10][7]*S_inv[4][3] - P[10][8]*S_inv[5][3]) + P[7][13]*(-P[10][0]*S_inv[0][4] - P[10][1]*S_inv[1][4] - P[10][2]*S_inv[2][4] - P[10][6]*S_inv[3][4] - P[10][7]*S_inv[4][4] - P[10][8]*S_inv[5][4]) + P[8][13]*(-P[10][0]*S_inv[0][5] - P[10][1]*S_inv[1][5] - P[10][2]*S_inv[2][5] - P[10][6]*S_inv[3][5] - P[10][7]*S_inv[4][5] - P[10][8]*S_inv[5][5]);
    P_up[10][14] = P[0][14]*(-P[10][0]*S_inv[0][0] - P[10][1]*S_inv[1][0] - P[10][2]*S_inv[2][0] - P[10][6]*S_inv[3][0] - P[10][7]*S_inv[4][0] - P[10][8]*S_inv[5][0]) + P[10][14] + P[1][14]*(-P[10][0]*S_inv[0][1] - P[10][1]*S_inv[1][1] - P[10][2]*S_inv[2][1] - P[10][6]*S_inv[3][1] - P[10][7]*S_inv[4][1] - P[10][8]*S_inv[5][1]) + P[2][14]*(-P[10][0]*S_inv[0][2] - P[10][1]*S_inv[1][2] - P[10][2]*S_inv[2][2] - P[10][6]*S_inv[3][2] - P[10][7]*S_inv[4][2] - P[10][8]*S_inv[5][2]) + P[6][14]*(-P[10][0]*S_inv[0][3] - P[10][1]*S_inv[1][3] - P[10][2]*S_inv[2][3] - P[10][6]*S_inv[3][3] - P[10][7]*S_inv[4][3] - P[10][8]*S_inv[5][3]) + P[7][14]*(-P[10][0]*S_inv[0][4] - P[10][1]*S_inv[1][4] - P[10][2]*S_inv[2][4] - P[10][6]*S_inv[3][4] - P[10][7]*S_inv[4][4] - P[10][8]*S_inv[5][4]) + P[8][14]*(-P[10][0]*S_inv[0][5] - P[10][1]*S_inv[1][5] - P[10][2]*S_inv[2][5] - P[10][6]*S_inv[3][5] - P[10][7]*S_inv[4][5] - P[10][8]*S_inv[5][5]);
    P_up[11][0] = P[0][0]*(-P[11][0]*S_inv[0][0] - P[11][1]*S_inv[1][0] - P[11][2]*S_inv[2][0] - P[11][6]*S_inv[3][0] - P[11][7]*S_inv[4][0] - P[11][8]*S_inv[5][0]) + P[11][0] + P[1][0]*(-P[11][0]*S_inv[0][1] - P[11][1]*S_inv[1][1] - P[11][2]*S_inv[2][1] - P[11][6]*S_inv[3][1] - P[11][7]*S_inv[4][1] - P[11][8]*S_inv[5][1]) + P[2][0]*(-P[11][0]*S_inv[0][2] - P[11][1]*S_inv[1][2] - P[11][2]*S_inv[2][2] - P[11][6]*S_inv[3][2] - P[11][7]*S_inv[4][2] - P[11][8]*S_inv[5][2]) + P[6][0]*(-P[11][0]*S_inv[0][3] - P[11][1]*S_inv[1][3] - P[11][2]*S_inv[2][3] - P[11][6]*S_inv[3][3] - P[11][7]*S_inv[4][3] - P[11][8]*S_inv[5][3]) + P[7][0]*(-P[11][0]*S_inv[0][4] - P[11][1]*S_inv[1][4] - P[11][2]*S_inv[2][4] - P[11][6]*S_inv[3][4] - P[11][7]*S_inv[4][4] - P[11][8]*S_inv[5][4]) + P[8][0]*(-P[11][0]*S_inv[0][5] - P[11][1]*S_inv[1][5] - P[11][2]*S_inv[2][5] - P[11][6]*S_inv[3][5] - P[11][7]*S_inv[4][5] - P[11][8]*S_inv[5][5]);
    P_up[11][1] = P[0][1]*(-P[11][0]*S_inv[0][0] - P[11][1]*S_inv[1][0] - P[11][2]*S_inv[2][0] - P[11][6]*S_inv[3][0] - P[11][7]*S_inv[4][0] - P[11][8]*S_inv[5][0]) + P[11][1] + P[1][1]*(-P[11][0]*S_inv[0][1] - P[11][1]*S_inv[1][1] - P[11][2]*S_inv[2][1] - P[11][6]*S_inv[3][1] - P[11][7]*S_inv[4][1] - P[11][8]*S_inv[5][1]) + P[2][1]*(-P[11][0]*S_inv[0][2] - P[11][1]*S_inv[1][2] - P[11][2]*S_inv[2][2] - P[11][6]*S_inv[3][2] - P[11][7]*S_inv[4][2] - P[11][8]*S_inv[5][2]) + P[6][1]*(-P[11][0]*S_inv[0][3] - P[11][1]*S_inv[1][3] - P[11][2]*S_inv[2][3] - P[11][6]*S_inv[3][3] - P[11][7]*S_inv[4][3] - P[11][8]*S_inv[5][3]) + P[7][1]*(-P[11][0]*S_inv[0][4] - P[11][1]*S_inv[1][4] - P[11][2]*S_inv[2][4] - P[11][6]*S_inv[3][4] - P[11][7]*S_inv[4][4] - P[11][8]*S_inv[5][4]) + P[8][1]*(-P[11][0]*S_inv[0][5] - P[11][1]*S_inv[1][5] - P[11][2]*S_inv[2][5] - P[11][6]*S_inv[3][5] - P[11][7]*S_inv[4][5] - P[11][8]*S_inv[5][5]);
    P_up[11][2] = P[0][2]*(-P[11][0]*S_inv[0][0] - P[11][1]*S_inv[1][0] - P[11][2]*S_inv[2][0] - P[11][6]*S_inv[3][0] - P[11][7]*S_inv[4][0] - P[11][8]*S_inv[5][0]) + P[11][2] + P[1][2]*(-P[11][0]*S_inv[0][1] - P[11][1]*S_inv[1][1] - P[11][2]*S_inv[2][1] - P[11][6]*S_inv[3][1] - P[11][7]*S_inv[4][1] - P[11][8]*S_inv[5][1]) + P[2][2]*(-P[11][0]*S_inv[0][2] - P[11][1]*S_inv[1][2] - P[11][2]*S_inv[2][2] - P[11][6]*S_inv[3][2] - P[11][7]*S_inv[4][2] - P[11][8]*S_inv[5][2]) + P[6][2]*(-P[11][0]*S_inv[0][3] - P[11][1]*S_inv[1][3] - P[11][2]*S_inv[2][3] - P[11][6]*S_inv[3][3] - P[11][7]*S_inv[4][3] - P[11][8]*S_inv[5][3]) + P[7][2]*(-P[11][0]*S_inv[0][4] - P[11][1]*S_inv[1][4] - P[11][2]*S_inv[2][4] - P[11][6]*S_inv[3][4] - P[11][7]*S_inv[4][4] - P[11][8]*S_inv[5][4]) + P[8][2]*(-P[11][0]*S_inv[0][5] - P[11][1]*S_inv[1][5] - P[11][2]*S_inv[2][5] - P[11][6]*S_inv[3][5] - P[11][7]*S_inv[4][5] - P[11][8]*S_inv[5][5]);
    P_up[11][3] = P[0][3]*(-P[11][0]*S_inv[0][0] - P[11][1]*S_inv[1][0] - P[11][2]*S_inv[2][0] - P[11][6]*S_inv[3][0] - P[11][7]*S_inv[4][0] - P[11][8]*S_inv[5][0]) + P[11][3] + P[1][3]*(-P[11][0]*S_inv[0][1] - P[11][1]*S_inv[1][1] - P[11][2]*S_inv[2][1] - P[11][6]*S_inv[3][1] - P[11][7]*S_inv[4][1] - P[11][8]*S_inv[5][1]) + P[2][3]*(-P[11][0]*S_inv[0][2] - P[11][1]*S_inv[1][2] - P[11][2]*S_inv[2][2] - P[11][6]*S_inv[3][2] - P[11][7]*S_inv[4][2] - P[11][8]*S_inv[5][2]) + P[6][3]*(-P[11][0]*S_inv[0][3] - P[11][1]*S_inv[1][3] - P[11][2]*S_inv[2][3] - P[11][6]*S_inv[3][3] - P[11][7]*S_inv[4][3] - P[11][8]*S_inv[5][3]) + P[7][3]*(-P[11][0]*S_inv[0][4] - P[11][1]*S_inv[1][4] - P[11][2]*S_inv[2][4] - P[11][6]*S_inv[3][4] - P[11][7]*S_inv[4][4] - P[11][8]*S_inv[5][4]) + P[8][3]*(-P[11][0]*S_inv[0][5] - P[11][1]*S_inv[1][5] - P[11][2]*S_inv[2][5] - P[11][6]*S_inv[3][5] - P[11][7]*S_inv[4][5] - P[11][8]*S_inv[5][5]);
    P_up[11][4] = P[0][4]*(-P[11][0]*S_inv[0][0] - P[11][1]*S_inv[1][0] - P[11][2]*S_inv[2][0] - P[11][6]*S_inv[3][0] - P[11][7]*S_inv[4][0] - P[11][8]*S_inv[5][0]) + P[11][4] + P[1][4]*(-P[11][0]*S_inv[0][1] - P[11][1]*S_inv[1][1] - P[11][2]*S_inv[2][1] - P[11][6]*S_inv[3][1] - P[11][7]*S_inv[4][1] - P[11][8]*S_inv[5][1]) + P[2][4]*(-P[11][0]*S_inv[0][2] - P[11][1]*S_inv[1][2] - P[11][2]*S_inv[2][2] - P[11][6]*S_inv[3][2] - P[11][7]*S_inv[4][2] - P[11][8]*S_inv[5][2]) + P[6][4]*(-P[11][0]*S_inv[0][3] - P[11][1]*S_inv[1][3] - P[11][2]*S_inv[2][3] - P[11][6]*S_inv[3][3] - P[11][7]*S_inv[4][3] - P[11][8]*S_inv[5][3]) + P[7][4]*(-P[11][0]*S_inv[0][4] - P[11][1]*S_inv[1][4] - P[11][2]*S_inv[2][4] - P[11][6]*S_inv[3][4] - P[11][7]*S_inv[4][4] - P[11][8]*S_inv[5][4]) + P[8][4]*(-P[11][0]*S_inv[0][5] - P[11][1]*S_inv[1][5] - P[11][2]*S_inv[2][5] - P[11][6]*S_inv[3][5] - P[11][7]*S_inv[4][5] - P[11][8]*S_inv[5][5]);
    P_up[11][5] = P[0][5]*(-P[11][0]*S_inv[0][0] - P[11][1]*S_inv[1][0] - P[11][2]*S_inv[2][0] - P[11][6]*S_inv[3][0] - P[11][7]*S_inv[4][0] - P[11][8]*S_inv[5][0]) + P[11][5] + P[1][5]*(-P[11][0]*S_inv[0][1] - P[11][1]*S_inv[1][1] - P[11][2]*S_inv[2][1] - P[11][6]*S_inv[3][1] - P[11][7]*S_inv[4][1] - P[11][8]*S_inv[5][1]) + P[2][5]*(-P[11][0]*S_inv[0][2] - P[11][1]*S_inv[1][2] - P[11][2]*S_inv[2][2] - P[11][6]*S_inv[3][2] - P[11][7]*S_inv[4][2] - P[11][8]*S_inv[5][2]) + P[6][5]*(-P[11][0]*S_inv[0][3] - P[11][1]*S_inv[1][3] - P[11][2]*S_inv[2][3] - P[11][6]*S_inv[3][3] - P[11][7]*S_inv[4][3] - P[11][8]*S_inv[5][3]) + P[7][5]*(-P[11][0]*S_inv[0][4] - P[11][1]*S_inv[1][4] - P[11][2]*S_inv[2][4] - P[11][6]*S_inv[3][4] - P[11][7]*S_inv[4][4] - P[11][8]*S_inv[5][4]) + P[8][5]*(-P[11][0]*S_inv[0][5] - P[11][1]*S_inv[1][5] - P[11][2]*S_inv[2][5] - P[11][6]*S_inv[3][5] - P[11][7]*S_inv[4][5] - P[11][8]*S_inv[5][5]);
    P_up[11][6] = P[0][6]*(-P[11][0]*S_inv[0][0] - P[11][1]*S_inv[1][0] - P[11][2]*S_inv[2][0] - P[11][6]*S_inv[3][0] - P[11][7]*S_inv[4][0] - P[11][8]*S_inv[5][0]) + P[11][6] + P[1][6]*(-P[11][0]*S_inv[0][1] - P[11][1]*S_inv[1][1] - P[11][2]*S_inv[2][1] - P[11][6]*S_inv[3][1] - P[11][7]*S_inv[4][1] - P[11][8]*S_inv[5][1]) + P[2][6]*(-P[11][0]*S_inv[0][2] - P[11][1]*S_inv[1][2] - P[11][2]*S_inv[2][2] - P[11][6]*S_inv[3][2] - P[11][7]*S_inv[4][2] - P[11][8]*S_inv[5][2]) + P[6][6]*(-P[11][0]*S_inv[0][3] - P[11][1]*S_inv[1][3] - P[11][2]*S_inv[2][3] - P[11][6]*S_inv[3][3] - P[11][7]*S_inv[4][3] - P[11][8]*S_inv[5][3]) + P[7][6]*(-P[11][0]*S_inv[0][4] - P[11][1]*S_inv[1][4] - P[11][2]*S_inv[2][4] - P[11][6]*S_inv[3][4] - P[11][7]*S_inv[4][4] - P[11][8]*S_inv[5][4]) + P[8][6]*(-P[11][0]*S_inv[0][5] - P[11][1]*S_inv[1][5] - P[11][2]*S_inv[2][5] - P[11][6]*S_inv[3][5] - P[11][7]*S_inv[4][5] - P[11][8]*S_inv[5][5]);
    P_up[11][7] = P[0][7]*(-P[11][0]*S_inv[0][0] - P[11][1]*S_inv[1][0] - P[11][2]*S_inv[2][0] - P[11][6]*S_inv[3][0] - P[11][7]*S_inv[4][0] - P[11][8]*S_inv[5][0]) + P[11][7] + P[1][7]*(-P[11][0]*S_inv[0][1] - P[11][1]*S_inv[1][1] - P[11][2]*S_inv[2][1] - P[11][6]*S_inv[3][1] - P[11][7]*S_inv[4][1] - P[11][8]*S_inv[5][1]) + P[2][7]*(-P[11][0]*S_inv[0][2] - P[11][1]*S_inv[1][2] - P[11][2]*S_inv[2][2] - P[11][6]*S_inv[3][2] - P[11][7]*S_inv[4][2] - P[11][8]*S_inv[5][2]) + P[6][7]*(-P[11][0]*S_inv[0][3] - P[11][1]*S_inv[1][3] - P[11][2]*S_inv[2][3] - P[11][6]*S_inv[3][3] - P[11][7]*S_inv[4][3] - P[11][8]*S_inv[5][3]) + P[7][7]*(-P[11][0]*S_inv[0][4] - P[11][1]*S_inv[1][4] - P[11][2]*S_inv[2][4] - P[11][6]*S_inv[3][4] - P[11][7]*S_inv[4][4] - P[11][8]*S_inv[5][4]) + P[8][7]*(-P[11][0]*S_inv[0][5] - P[11][1]*S_inv[1][5] - P[11][2]*S_inv[2][5] - P[11][6]*S_inv[3][5] - P[11][7]*S_inv[4][5] - P[11][8]*S_inv[5][5]);
    P_up[11][8] = P[0][8]*(-P[11][0]*S_inv[0][0] - P[11][1]*S_inv[1][0] - P[11][2]*S_inv[2][0] - P[11][6]*S_inv[3][0] - P[11][7]*S_inv[4][0] - P[11][8]*S_inv[5][0]) + P[11][8] + P[1][8]*(-P[11][0]*S_inv[0][1] - P[11][1]*S_inv[1][1] - P[11][2]*S_inv[2][1] - P[11][6]*S_inv[3][1] - P[11][7]*S_inv[4][1] - P[11][8]*S_inv[5][1]) + P[2][8]*(-P[11][0]*S_inv[0][2] - P[11][1]*S_inv[1][2] - P[11][2]*S_inv[2][2] - P[11][6]*S_inv[3][2] - P[11][7]*S_inv[4][2] - P[11][8]*S_inv[5][2]) + P[6][8]*(-P[11][0]*S_inv[0][3] - P[11][1]*S_inv[1][3] - P[11][2]*S_inv[2][3] - P[11][6]*S_inv[3][3] - P[11][7]*S_inv[4][3] - P[11][8]*S_inv[5][3]) + P[7][8]*(-P[11][0]*S_inv[0][4] - P[11][1]*S_inv[1][4] - P[11][2]*S_inv[2][4] - P[11][6]*S_inv[3][4] - P[11][7]*S_inv[4][4] - P[11][8]*S_inv[5][4]) + P[8][8]*(-P[11][0]*S_inv[0][5] - P[11][1]*S_inv[1][5] - P[11][2]*S_inv[2][5] - P[11][6]*S_inv[3][5] - P[11][7]*S_inv[4][5] - P[11][8]*S_inv[5][5]);
    P_up[11][9] = P[0][9]*(-P[11][0]*S_inv[0][0] - P[11][1]*S_inv[1][0] - P[11][2]*S_inv[2][0] - P[11][6]*S_inv[3][0] - P[11][7]*S_inv[4][0] - P[11][8]*S_inv[5][0]) + P[11][9] + P[1][9]*(-P[11][0]*S_inv[0][1] - P[11][1]*S_inv[1][1] - P[11][2]*S_inv[2][1] - P[11][6]*S_inv[3][1] - P[11][7]*S_inv[4][1] - P[11][8]*S_inv[5][1]) + P[2][9]*(-P[11][0]*S_inv[0][2] - P[11][1]*S_inv[1][2] - P[11][2]*S_inv[2][2] - P[11][6]*S_inv[3][2] - P[11][7]*S_inv[4][2] - P[11][8]*S_inv[5][2]) + P[6][9]*(-P[11][0]*S_inv[0][3] - P[11][1]*S_inv[1][3] - P[11][2]*S_inv[2][3] - P[11][6]*S_inv[3][3] - P[11][7]*S_inv[4][3] - P[11][8]*S_inv[5][3]) + P[7][9]*(-P[11][0]*S_inv[0][4] - P[11][1]*S_inv[1][4] - P[11][2]*S_inv[2][4] - P[11][6]*S_inv[3][4] - P[11][7]*S_inv[4][4] - P[11][8]*S_inv[5][4]) + P[8][9]*(-P[11][0]*S_inv[0][5] - P[11][1]*S_inv[1][5] - P[11][2]*S_inv[2][5] - P[11][6]*S_inv[3][5] - P[11][7]*S_inv[4][5] - P[11][8]*S_inv[5][5]);
    P_up[11][10] = P[0][10]*(-P[11][0]*S_inv[0][0] - P[11][1]*S_inv[1][0] - P[11][2]*S_inv[2][0] - P[11][6]*S_inv[3][0] - P[11][7]*S_inv[4][0] - P[11][8]*S_inv[5][0]) + P[11][10] + P[1][10]*(-P[11][0]*S_inv[0][1] - P[11][1]*S_inv[1][1] - P[11][2]*S_inv[2][1] - P[11][6]*S_inv[3][1] - P[11][7]*S_inv[4][1] - P[11][8]*S_inv[5][1]) + P[2][10]*(-P[11][0]*S_inv[0][2] - P[11][1]*S_inv[1][2] - P[11][2]*S_inv[2][2] - P[11][6]*S_inv[3][2] - P[11][7]*S_inv[4][2] - P[11][8]*S_inv[5][2]) + P[6][10]*(-P[11][0]*S_inv[0][3] - P[11][1]*S_inv[1][3] - P[11][2]*S_inv[2][3] - P[11][6]*S_inv[3][3] - P[11][7]*S_inv[4][3] - P[11][8]*S_inv[5][3]) + P[7][10]*(-P[11][0]*S_inv[0][4] - P[11][1]*S_inv[1][4] - P[11][2]*S_inv[2][4] - P[11][6]*S_inv[3][4] - P[11][7]*S_inv[4][4] - P[11][8]*S_inv[5][4]) + P[8][10]*(-P[11][0]*S_inv[0][5] - P[11][1]*S_inv[1][5] - P[11][2]*S_inv[2][5] - P[11][6]*S_inv[3][5] - P[11][7]*S_inv[4][5] - P[11][8]*S_inv[5][5]);
    P_up[11][11] = P[0][11]*(-P[11][0]*S_inv[0][0] - P[11][1]*S_inv[1][0] - P[11][2]*S_inv[2][0] - P[11][6]*S_inv[3][0] - P[11][7]*S_inv[4][0] - P[11][8]*S_inv[5][0]) + P[11][11] + P[1][11]*(-P[11][0]*S_inv[0][1] - P[11][1]*S_inv[1][1] - P[11][2]*S_inv[2][1] - P[11][6]*S_inv[3][1] - P[11][7]*S_inv[4][1] - P[11][8]*S_inv[5][1]) + P[2][11]*(-P[11][0]*S_inv[0][2] - P[11][1]*S_inv[1][2] - P[11][2]*S_inv[2][2] - P[11][6]*S_inv[3][2] - P[11][7]*S_inv[4][2] - P[11][8]*S_inv[5][2]) + P[6][11]*(-P[11][0]*S_inv[0][3] - P[11][1]*S_inv[1][3] - P[11][2]*S_inv[2][3] - P[11][6]*S_inv[3][3] - P[11][7]*S_inv[4][3] - P[11][8]*S_inv[5][3]) + P[7][11]*(-P[11][0]*S_inv[0][4] - P[11][1]*S_inv[1][4] - P[11][2]*S_inv[2][4] - P[11][6]*S_inv[3][4] - P[11][7]*S_inv[4][4] - P[11][8]*S_inv[5][4]) + P[8][11]*(-P[11][0]*S_inv[0][5] - P[11][1]*S_inv[1][5] - P[11][2]*S_inv[2][5] - P[11][6]*S_inv[3][5] - P[11][7]*S_inv[4][5] - P[11][8]*S_inv[5][5]);
    P_up[11][12] = P[0][12]*(-P[11][0]*S_inv[0][0] - P[11][1]*S_inv[1][0] - P[11][2]*S_inv[2][0] - P[11][6]*S_inv[3][0] - P[11][7]*S_inv[4][0] - P[11][8]*S_inv[5][0]) + P[11][12] + P[1][12]*(-P[11][0]*S_inv[0][1] - P[11][1]*S_inv[1][1] - P[11][2]*S_inv[2][1] - P[11][6]*S_inv[3][1] - P[11][7]*S_inv[4][1] - P[11][8]*S_inv[5][1]) + P[2][12]*(-P[11][0]*S_inv[0][2] - P[11][1]*S_inv[1][2] - P[11][2]*S_inv[2][2] - P[11][6]*S_inv[3][2] - P[11][7]*S_inv[4][2] - P[11][8]*S_inv[5][2]) + P[6][12]*(-P[11][0]*S_inv[0][3] - P[11][1]*S_inv[1][3] - P[11][2]*S_inv[2][3] - P[11][6]*S_inv[3][3] - P[11][7]*S_inv[4][3] - P[11][8]*S_inv[5][3]) + P[7][12]*(-P[11][0]*S_inv[0][4] - P[11][1]*S_inv[1][4] - P[11][2]*S_inv[2][4] - P[11][6]*S_inv[3][4] - P[11][7]*S_inv[4][4] - P[11][8]*S_inv[5][4]) + P[8][12]*(-P[11][0]*S_inv[0][5] - P[11][1]*S_inv[1][5] - P[11][2]*S_inv[2][5] - P[11][6]*S_inv[3][5] - P[11][7]*S_inv[4][5] - P[11][8]*S_inv[5][5]);
    P_up[11][13] = P[0][13]*(-P[11][0]*S_inv[0][0] - P[11][1]*S_inv[1][0] - P[11][2]*S_inv[2][0] - P[11][6]*S_inv[3][0] - P[11][7]*S_inv[4][0] - P[11][8]*S_inv[5][0]) + P[11][13] + P[1][13]*(-P[11][0]*S_inv[0][1] - P[11][1]*S_inv[1][1] - P[11][2]*S_inv[2][1] - P[11][6]*S_inv[3][1] - P[11][7]*S_inv[4][1] - P[11][8]*S_inv[5][1]) + P[2][13]*(-P[11][0]*S_inv[0][2] - P[11][1]*S_inv[1][2] - P[11][2]*S_inv[2][2] - P[11][6]*S_inv[3][2] - P[11][7]*S_inv[4][2] - P[11][8]*S_inv[5][2]) + P[6][13]*(-P[11][0]*S_inv[0][3] - P[11][1]*S_inv[1][3] - P[11][2]*S_inv[2][3] - P[11][6]*S_inv[3][3] - P[11][7]*S_inv[4][3] - P[11][8]*S_inv[5][3]) + P[7][13]*(-P[11][0]*S_inv[0][4] - P[11][1]*S_inv[1][4] - P[11][2]*S_inv[2][4] - P[11][6]*S_inv[3][4] - P[11][7]*S_inv[4][4] - P[11][8]*S_inv[5][4]) + P[8][13]*(-P[11][0]*S_inv[0][5] - P[11][1]*S_inv[1][5] - P[11][2]*S_inv[2][5] - P[11][6]*S_inv[3][5] - P[11][7]*S_inv[4][5] - P[11][8]*S_inv[5][5]);
    P_up[11][14] = P[0][14]*(-P[11][0]*S_inv[0][0] - P[11][1]*S_inv[1][0] - P[11][2]*S_inv[2][0] - P[11][6]*S_inv[3][0] - P[11][7]*S_inv[4][0] - P[11][8]*S_inv[5][0]) + P[11][14] + P[1][14]*(-P[11][0]*S_inv[0][1] - P[11][1]*S_inv[1][1] - P[11][2]*S_inv[2][1] - P[11][6]*S_inv[3][1] - P[11][7]*S_inv[4][1] - P[11][8]*S_inv[5][1]) + P[2][14]*(-P[11][0]*S_inv[0][2] - P[11][1]*S_inv[1][2] - P[11][2]*S_inv[2][2] - P[11][6]*S_inv[3][2] - P[11][7]*S_inv[4][2] - P[11][8]*S_inv[5][2]) + P[6][14]*(-P[11][0]*S_inv[0][3] - P[11][1]*S_inv[1][3] - P[11][2]*S_inv[2][3] - P[11][6]*S_inv[3][3] - P[11][7]*S_inv[4][3] - P[11][8]*S_inv[5][3]) + P[7][14]*(-P[11][0]*S_inv[0][4] - P[11][1]*S_inv[1][4] - P[11][2]*S_inv[2][4] - P[11][6]*S_inv[3][4] - P[11][7]*S_inv[4][4] - P[11][8]*S_inv[5][4]) + P[8][14]*(-P[11][0]*S_inv[0][5] - P[11][1]*S_inv[1][5] - P[11][2]*S_inv[2][5] - P[11][6]*S_inv[3][5] - P[11][7]*S_inv[4][5] - P[11][8]*S_inv[5][5]);
    P_up[12][0] = P[0][0]*(-P[12][0]*S_inv[0][0] - P[12][1]*S_inv[1][0] - P[12][2]*S_inv[2][0] - P[12][6]*S_inv[3][0] - P[12][7]*S_inv[4][0] - P[12][8]*S_inv[5][0]) + P[12][0] + P[1][0]*(-P[12][0]*S_inv[0][1] - P[12][1]*S_inv[1][1] - P[12][2]*S_inv[2][1] - P[12][6]*S_inv[3][1] - P[12][7]*S_inv[4][1] - P[12][8]*S_inv[5][1]) + P[2][0]*(-P[12][0]*S_inv[0][2] - P[12][1]*S_inv[1][2] - P[12][2]*S_inv[2][2] - P[12][6]*S_inv[3][2] - P[12][7]*S_inv[4][2] - P[12][8]*S_inv[5][2]) + P[6][0]*(-P[12][0]*S_inv[0][3] - P[12][1]*S_inv[1][3] - P[12][2]*S_inv[2][3] - P[12][6]*S_inv[3][3] - P[12][7]*S_inv[4][3] - P[12][8]*S_inv[5][3]) + P[7][0]*(-P[12][0]*S_inv[0][4] - P[12][1]*S_inv[1][4] - P[12][2]*S_inv[2][4] - P[12][6]*S_inv[3][4] - P[12][7]*S_inv[4][4] - P[12][8]*S_inv[5][4]) + P[8][0]*(-P[12][0]*S_inv[0][5] - P[12][1]*S_inv[1][5] - P[12][2]*S_inv[2][5] - P[12][6]*S_inv[3][5] - P[12][7]*S_inv[4][5] - P[12][8]*S_inv[5][5]);
    P_up[12][1] = P[0][1]*(-P[12][0]*S_inv[0][0] - P[12][1]*S_inv[1][0] - P[12][2]*S_inv[2][0] - P[12][6]*S_inv[3][0] - P[12][7]*S_inv[4][0] - P[12][8]*S_inv[5][0]) + P[12][1] + P[1][1]*(-P[12][0]*S_inv[0][1] - P[12][1]*S_inv[1][1] - P[12][2]*S_inv[2][1] - P[12][6]*S_inv[3][1] - P[12][7]*S_inv[4][1] - P[12][8]*S_inv[5][1]) + P[2][1]*(-P[12][0]*S_inv[0][2] - P[12][1]*S_inv[1][2] - P[12][2]*S_inv[2][2] - P[12][6]*S_inv[3][2] - P[12][7]*S_inv[4][2] - P[12][8]*S_inv[5][2]) + P[6][1]*(-P[12][0]*S_inv[0][3] - P[12][1]*S_inv[1][3] - P[12][2]*S_inv[2][3] - P[12][6]*S_inv[3][3] - P[12][7]*S_inv[4][3] - P[12][8]*S_inv[5][3]) + P[7][1]*(-P[12][0]*S_inv[0][4] - P[12][1]*S_inv[1][4] - P[12][2]*S_inv[2][4] - P[12][6]*S_inv[3][4] - P[12][7]*S_inv[4][4] - P[12][8]*S_inv[5][4]) + P[8][1]*(-P[12][0]*S_inv[0][5] - P[12][1]*S_inv[1][5] - P[12][2]*S_inv[2][5] - P[12][6]*S_inv[3][5] - P[12][7]*S_inv[4][5] - P[12][8]*S_inv[5][5]);
    P_up[12][2] = P[0][2]*(-P[12][0]*S_inv[0][0] - P[12][1]*S_inv[1][0] - P[12][2]*S_inv[2][0] - P[12][6]*S_inv[3][0] - P[12][7]*S_inv[4][0] - P[12][8]*S_inv[5][0]) + P[12][2] + P[1][2]*(-P[12][0]*S_inv[0][1] - P[12][1]*S_inv[1][1] - P[12][2]*S_inv[2][1] - P[12][6]*S_inv[3][1] - P[12][7]*S_inv[4][1] - P[12][8]*S_inv[5][1]) + P[2][2]*(-P[12][0]*S_inv[0][2] - P[12][1]*S_inv[1][2] - P[12][2]*S_inv[2][2] - P[12][6]*S_inv[3][2] - P[12][7]*S_inv[4][2] - P[12][8]*S_inv[5][2]) + P[6][2]*(-P[12][0]*S_inv[0][3] - P[12][1]*S_inv[1][3] - P[12][2]*S_inv[2][3] - P[12][6]*S_inv[3][3] - P[12][7]*S_inv[4][3] - P[12][8]*S_inv[5][3]) + P[7][2]*(-P[12][0]*S_inv[0][4] - P[12][1]*S_inv[1][4] - P[12][2]*S_inv[2][4] - P[12][6]*S_inv[3][4] - P[12][7]*S_inv[4][4] - P[12][8]*S_inv[5][4]) + P[8][2]*(-P[12][0]*S_inv[0][5] - P[12][1]*S_inv[1][5] - P[12][2]*S_inv[2][5] - P[12][6]*S_inv[3][5] - P[12][7]*S_inv[4][5] - P[12][8]*S_inv[5][5]);
    P_up[12][3] = P[0][3]*(-P[12][0]*S_inv[0][0] - P[12][1]*S_inv[1][0] - P[12][2]*S_inv[2][0] - P[12][6]*S_inv[3][0] - P[12][7]*S_inv[4][0] - P[12][8]*S_inv[5][0]) + P[12][3] + P[1][3]*(-P[12][0]*S_inv[0][1] - P[12][1]*S_inv[1][1] - P[12][2]*S_inv[2][1] - P[12][6]*S_inv[3][1] - P[12][7]*S_inv[4][1] - P[12][8]*S_inv[5][1]) + P[2][3]*(-P[12][0]*S_inv[0][2] - P[12][1]*S_inv[1][2] - P[12][2]*S_inv[2][2] - P[12][6]*S_inv[3][2] - P[12][7]*S_inv[4][2] - P[12][8]*S_inv[5][2]) + P[6][3]*(-P[12][0]*S_inv[0][3] - P[12][1]*S_inv[1][3] - P[12][2]*S_inv[2][3] - P[12][6]*S_inv[3][3] - P[12][7]*S_inv[4][3] - P[12][8]*S_inv[5][3]) + P[7][3]*(-P[12][0]*S_inv[0][4] - P[12][1]*S_inv[1][4] - P[12][2]*S_inv[2][4] - P[12][6]*S_inv[3][4] - P[12][7]*S_inv[4][4] - P[12][8]*S_inv[5][4]) + P[8][3]*(-P[12][0]*S_inv[0][5] - P[12][1]*S_inv[1][5] - P[12][2]*S_inv[2][5] - P[12][6]*S_inv[3][5] - P[12][7]*S_inv[4][5] - P[12][8]*S_inv[5][5]);
    P_up[12][4] = P[0][4]*(-P[12][0]*S_inv[0][0] - P[12][1]*S_inv[1][0] - P[12][2]*S_inv[2][0] - P[12][6]*S_inv[3][0] - P[12][7]*S_inv[4][0] - P[12][8]*S_inv[5][0]) + P[12][4] + P[1][4]*(-P[12][0]*S_inv[0][1] - P[12][1]*S_inv[1][1] - P[12][2]*S_inv[2][1] - P[12][6]*S_inv[3][1] - P[12][7]*S_inv[4][1] - P[12][8]*S_inv[5][1]) + P[2][4]*(-P[12][0]*S_inv[0][2] - P[12][1]*S_inv[1][2] - P[12][2]*S_inv[2][2] - P[12][6]*S_inv[3][2] - P[12][7]*S_inv[4][2] - P[12][8]*S_inv[5][2]) + P[6][4]*(-P[12][0]*S_inv[0][3] - P[12][1]*S_inv[1][3] - P[12][2]*S_inv[2][3] - P[12][6]*S_inv[3][3] - P[12][7]*S_inv[4][3] - P[12][8]*S_inv[5][3]) + P[7][4]*(-P[12][0]*S_inv[0][4] - P[12][1]*S_inv[1][4] - P[12][2]*S_inv[2][4] - P[12][6]*S_inv[3][4] - P[12][7]*S_inv[4][4] - P[12][8]*S_inv[5][4]) + P[8][4]*(-P[12][0]*S_inv[0][5] - P[12][1]*S_inv[1][5] - P[12][2]*S_inv[2][5] - P[12][6]*S_inv[3][5] - P[12][7]*S_inv[4][5] - P[12][8]*S_inv[5][5]);
    P_up[12][5] = P[0][5]*(-P[12][0]*S_inv[0][0] - P[12][1]*S_inv[1][0] - P[12][2]*S_inv[2][0] - P[12][6]*S_inv[3][0] - P[12][7]*S_inv[4][0] - P[12][8]*S_inv[5][0]) + P[12][5] + P[1][5]*(-P[12][0]*S_inv[0][1] - P[12][1]*S_inv[1][1] - P[12][2]*S_inv[2][1] - P[12][6]*S_inv[3][1] - P[12][7]*S_inv[4][1] - P[12][8]*S_inv[5][1]) + P[2][5]*(-P[12][0]*S_inv[0][2] - P[12][1]*S_inv[1][2] - P[12][2]*S_inv[2][2] - P[12][6]*S_inv[3][2] - P[12][7]*S_inv[4][2] - P[12][8]*S_inv[5][2]) + P[6][5]*(-P[12][0]*S_inv[0][3] - P[12][1]*S_inv[1][3] - P[12][2]*S_inv[2][3] - P[12][6]*S_inv[3][3] - P[12][7]*S_inv[4][3] - P[12][8]*S_inv[5][3]) + P[7][5]*(-P[12][0]*S_inv[0][4] - P[12][1]*S_inv[1][4] - P[12][2]*S_inv[2][4] - P[12][6]*S_inv[3][4] - P[12][7]*S_inv[4][4] - P[12][8]*S_inv[5][4]) + P[8][5]*(-P[12][0]*S_inv[0][5] - P[12][1]*S_inv[1][5] - P[12][2]*S_inv[2][5] - P[12][6]*S_inv[3][5] - P[12][7]*S_inv[4][5] - P[12][8]*S_inv[5][5]);
    P_up[12][6] = P[0][6]*(-P[12][0]*S_inv[0][0] - P[12][1]*S_inv[1][0] - P[12][2]*S_inv[2][0] - P[12][6]*S_inv[3][0] - P[12][7]*S_inv[4][0] - P[12][8]*S_inv[5][0]) + P[12][6] + P[1][6]*(-P[12][0]*S_inv[0][1] - P[12][1]*S_inv[1][1] - P[12][2]*S_inv[2][1] - P[12][6]*S_inv[3][1] - P[12][7]*S_inv[4][1] - P[12][8]*S_inv[5][1]) + P[2][6]*(-P[12][0]*S_inv[0][2] - P[12][1]*S_inv[1][2] - P[12][2]*S_inv[2][2] - P[12][6]*S_inv[3][2] - P[12][7]*S_inv[4][2] - P[12][8]*S_inv[5][2]) + P[6][6]*(-P[12][0]*S_inv[0][3] - P[12][1]*S_inv[1][3] - P[12][2]*S_inv[2][3] - P[12][6]*S_inv[3][3] - P[12][7]*S_inv[4][3] - P[12][8]*S_inv[5][3]) + P[7][6]*(-P[12][0]*S_inv[0][4] - P[12][1]*S_inv[1][4] - P[12][2]*S_inv[2][4] - P[12][6]*S_inv[3][4] - P[12][7]*S_inv[4][4] - P[12][8]*S_inv[5][4]) + P[8][6]*(-P[12][0]*S_inv[0][5] - P[12][1]*S_inv[1][5] - P[12][2]*S_inv[2][5] - P[12][6]*S_inv[3][5] - P[12][7]*S_inv[4][5] - P[12][8]*S_inv[5][5]);
    P_up[12][7] = P[0][7]*(-P[12][0]*S_inv[0][0] - P[12][1]*S_inv[1][0] - P[12][2]*S_inv[2][0] - P[12][6]*S_inv[3][0] - P[12][7]*S_inv[4][0] - P[12][8]*S_inv[5][0]) + P[12][7] + P[1][7]*(-P[12][0]*S_inv[0][1] - P[12][1]*S_inv[1][1] - P[12][2]*S_inv[2][1] - P[12][6]*S_inv[3][1] - P[12][7]*S_inv[4][1] - P[12][8]*S_inv[5][1]) + P[2][7]*(-P[12][0]*S_inv[0][2] - P[12][1]*S_inv[1][2] - P[12][2]*S_inv[2][2] - P[12][6]*S_inv[3][2] - P[12][7]*S_inv[4][2] - P[12][8]*S_inv[5][2]) + P[6][7]*(-P[12][0]*S_inv[0][3] - P[12][1]*S_inv[1][3] - P[12][2]*S_inv[2][3] - P[12][6]*S_inv[3][3] - P[12][7]*S_inv[4][3] - P[12][8]*S_inv[5][3]) + P[7][7]*(-P[12][0]*S_inv[0][4] - P[12][1]*S_inv[1][4] - P[12][2]*S_inv[2][4] - P[12][6]*S_inv[3][4] - P[12][7]*S_inv[4][4] - P[12][8]*S_inv[5][4]) + P[8][7]*(-P[12][0]*S_inv[0][5] - P[12][1]*S_inv[1][5] - P[12][2]*S_inv[2][5] - P[12][6]*S_inv[3][5] - P[12][7]*S_inv[4][5] - P[12][8]*S_inv[5][5]);
    P_up[12][8] = P[0][8]*(-P[12][0]*S_inv[0][0] - P[12][1]*S_inv[1][0] - P[12][2]*S_inv[2][0] - P[12][6]*S_inv[3][0] - P[12][7]*S_inv[4][0] - P[12][8]*S_inv[5][0]) + P[12][8] + P[1][8]*(-P[12][0]*S_inv[0][1] - P[12][1]*S_inv[1][1] - P[12][2]*S_inv[2][1] - P[12][6]*S_inv[3][1] - P[12][7]*S_inv[4][1] - P[12][8]*S_inv[5][1]) + P[2][8]*(-P[12][0]*S_inv[0][2] - P[12][1]*S_inv[1][2] - P[12][2]*S_inv[2][2] - P[12][6]*S_inv[3][2] - P[12][7]*S_inv[4][2] - P[12][8]*S_inv[5][2]) + P[6][8]*(-P[12][0]*S_inv[0][3] - P[12][1]*S_inv[1][3] - P[12][2]*S_inv[2][3] - P[12][6]*S_inv[3][3] - P[12][7]*S_inv[4][3] - P[12][8]*S_inv[5][3]) + P[7][8]*(-P[12][0]*S_inv[0][4] - P[12][1]*S_inv[1][4] - P[12][2]*S_inv[2][4] - P[12][6]*S_inv[3][4] - P[12][7]*S_inv[4][4] - P[12][8]*S_inv[5][4]) + P[8][8]*(-P[12][0]*S_inv[0][5] - P[12][1]*S_inv[1][5] - P[12][2]*S_inv[2][5] - P[12][6]*S_inv[3][5] - P[12][7]*S_inv[4][5] - P[12][8]*S_inv[5][5]);
    P_up[12][9] = P[0][9]*(-P[12][0]*S_inv[0][0] - P[12][1]*S_inv[1][0] - P[12][2]*S_inv[2][0] - P[12][6]*S_inv[3][0] - P[12][7]*S_inv[4][0] - P[12][8]*S_inv[5][0]) + P[12][9] + P[1][9]*(-P[12][0]*S_inv[0][1] - P[12][1]*S_inv[1][1] - P[12][2]*S_inv[2][1] - P[12][6]*S_inv[3][1] - P[12][7]*S_inv[4][1] - P[12][8]*S_inv[5][1]) + P[2][9]*(-P[12][0]*S_inv[0][2] - P[12][1]*S_inv[1][2] - P[12][2]*S_inv[2][2] - P[12][6]*S_inv[3][2] - P[12][7]*S_inv[4][2] - P[12][8]*S_inv[5][2]) + P[6][9]*(-P[12][0]*S_inv[0][3] - P[12][1]*S_inv[1][3] - P[12][2]*S_inv[2][3] - P[12][6]*S_inv[3][3] - P[12][7]*S_inv[4][3] - P[12][8]*S_inv[5][3]) + P[7][9]*(-P[12][0]*S_inv[0][4] - P[12][1]*S_inv[1][4] - P[12][2]*S_inv[2][4] - P[12][6]*S_inv[3][4] - P[12][7]*S_inv[4][4] - P[12][8]*S_inv[5][4]) + P[8][9]*(-P[12][0]*S_inv[0][5] - P[12][1]*S_inv[1][5] - P[12][2]*S_inv[2][5] - P[12][6]*S_inv[3][5] - P[12][7]*S_inv[4][5] - P[12][8]*S_inv[5][5]);
    P_up[12][10] = P[0][10]*(-P[12][0]*S_inv[0][0] - P[12][1]*S_inv[1][0] - P[12][2]*S_inv[2][0] - P[12][6]*S_inv[3][0] - P[12][7]*S_inv[4][0] - P[12][8]*S_inv[5][0]) + P[12][10] + P[1][10]*(-P[12][0]*S_inv[0][1] - P[12][1]*S_inv[1][1] - P[12][2]*S_inv[2][1] - P[12][6]*S_inv[3][1] - P[12][7]*S_inv[4][1] - P[12][8]*S_inv[5][1]) + P[2][10]*(-P[12][0]*S_inv[0][2] - P[12][1]*S_inv[1][2] - P[12][2]*S_inv[2][2] - P[12][6]*S_inv[3][2] - P[12][7]*S_inv[4][2] - P[12][8]*S_inv[5][2]) + P[6][10]*(-P[12][0]*S_inv[0][3] - P[12][1]*S_inv[1][3] - P[12][2]*S_inv[2][3] - P[12][6]*S_inv[3][3] - P[12][7]*S_inv[4][3] - P[12][8]*S_inv[5][3]) + P[7][10]*(-P[12][0]*S_inv[0][4] - P[12][1]*S_inv[1][4] - P[12][2]*S_inv[2][4] - P[12][6]*S_inv[3][4] - P[12][7]*S_inv[4][4] - P[12][8]*S_inv[5][4]) + P[8][10]*(-P[12][0]*S_inv[0][5] - P[12][1]*S_inv[1][5] - P[12][2]*S_inv[2][5] - P[12][6]*S_inv[3][5] - P[12][7]*S_inv[4][5] - P[12][8]*S_inv[5][5]);
    P_up[12][11] = P[0][11]*(-P[12][0]*S_inv[0][0] - P[12][1]*S_inv[1][0] - P[12][2]*S_inv[2][0] - P[12][6]*S_inv[3][0] - P[12][7]*S_inv[4][0] - P[12][8]*S_inv[5][0]) + P[12][11] + P[1][11]*(-P[12][0]*S_inv[0][1] - P[12][1]*S_inv[1][1] - P[12][2]*S_inv[2][1] - P[12][6]*S_inv[3][1] - P[12][7]*S_inv[4][1] - P[12][8]*S_inv[5][1]) + P[2][11]*(-P[12][0]*S_inv[0][2] - P[12][1]*S_inv[1][2] - P[12][2]*S_inv[2][2] - P[12][6]*S_inv[3][2] - P[12][7]*S_inv[4][2] - P[12][8]*S_inv[5][2]) + P[6][11]*(-P[12][0]*S_inv[0][3] - P[12][1]*S_inv[1][3] - P[12][2]*S_inv[2][3] - P[12][6]*S_inv[3][3] - P[12][7]*S_inv[4][3] - P[12][8]*S_inv[5][3]) + P[7][11]*(-P[12][0]*S_inv[0][4] - P[12][1]*S_inv[1][4] - P[12][2]*S_inv[2][4] - P[12][6]*S_inv[3][4] - P[12][7]*S_inv[4][4] - P[12][8]*S_inv[5][4]) + P[8][11]*(-P[12][0]*S_inv[0][5] - P[12][1]*S_inv[1][5] - P[12][2]*S_inv[2][5] - P[12][6]*S_inv[3][5] - P[12][7]*S_inv[4][5] - P[12][8]*S_inv[5][5]);
    P_up[12][12] = P[0][12]*(-P[12][0]*S_inv[0][0] - P[12][1]*S_inv[1][0] - P[12][2]*S_inv[2][0] - P[12][6]*S_inv[3][0] - P[12][7]*S_inv[4][0] - P[12][8]*S_inv[5][0]) + P[12][12] + P[1][12]*(-P[12][0]*S_inv[0][1] - P[12][1]*S_inv[1][1] - P[12][2]*S_inv[2][1] - P[12][6]*S_inv[3][1] - P[12][7]*S_inv[4][1] - P[12][8]*S_inv[5][1]) + P[2][12]*(-P[12][0]*S_inv[0][2] - P[12][1]*S_inv[1][2] - P[12][2]*S_inv[2][2] - P[12][6]*S_inv[3][2] - P[12][7]*S_inv[4][2] - P[12][8]*S_inv[5][2]) + P[6][12]*(-P[12][0]*S_inv[0][3] - P[12][1]*S_inv[1][3] - P[12][2]*S_inv[2][3] - P[12][6]*S_inv[3][3] - P[12][7]*S_inv[4][3] - P[12][8]*S_inv[5][3]) + P[7][12]*(-P[12][0]*S_inv[0][4] - P[12][1]*S_inv[1][4] - P[12][2]*S_inv[2][4] - P[12][6]*S_inv[3][4] - P[12][7]*S_inv[4][4] - P[12][8]*S_inv[5][4]) + P[8][12]*(-P[12][0]*S_inv[0][5] - P[12][1]*S_inv[1][5] - P[12][2]*S_inv[2][5] - P[12][6]*S_inv[3][5] - P[12][7]*S_inv[4][5] - P[12][8]*S_inv[5][5]);
    P_up[12][13] = P[0][13]*(-P[12][0]*S_inv[0][0] - P[12][1]*S_inv[1][0] - P[12][2]*S_inv[2][0] - P[12][6]*S_inv[3][0] - P[12][7]*S_inv[4][0] - P[12][8]*S_inv[5][0]) + P[12][13] + P[1][13]*(-P[12][0]*S_inv[0][1] - P[12][1]*S_inv[1][1] - P[12][2]*S_inv[2][1] - P[12][6]*S_inv[3][1] - P[12][7]*S_inv[4][1] - P[12][8]*S_inv[5][1]) + P[2][13]*(-P[12][0]*S_inv[0][2] - P[12][1]*S_inv[1][2] - P[12][2]*S_inv[2][2] - P[12][6]*S_inv[3][2] - P[12][7]*S_inv[4][2] - P[12][8]*S_inv[5][2]) + P[6][13]*(-P[12][0]*S_inv[0][3] - P[12][1]*S_inv[1][3] - P[12][2]*S_inv[2][3] - P[12][6]*S_inv[3][3] - P[12][7]*S_inv[4][3] - P[12][8]*S_inv[5][3]) + P[7][13]*(-P[12][0]*S_inv[0][4] - P[12][1]*S_inv[1][4] - P[12][2]*S_inv[2][4] - P[12][6]*S_inv[3][4] - P[12][7]*S_inv[4][4] - P[12][8]*S_inv[5][4]) + P[8][13]*(-P[12][0]*S_inv[0][5] - P[12][1]*S_inv[1][5] - P[12][2]*S_inv[2][5] - P[12][6]*S_inv[3][5] - P[12][7]*S_inv[4][5] - P[12][8]*S_inv[5][5]);
    P_up[12][14] = P[0][14]*(-P[12][0]*S_inv[0][0] - P[12][1]*S_inv[1][0] - P[12][2]*S_inv[2][0] - P[12][6]*S_inv[3][0] - P[12][7]*S_inv[4][0] - P[12][8]*S_inv[5][0]) + P[12][14] + P[1][14]*(-P[12][0]*S_inv[0][1] - P[12][1]*S_inv[1][1] - P[12][2]*S_inv[2][1] - P[12][6]*S_inv[3][1] - P[12][7]*S_inv[4][1] - P[12][8]*S_inv[5][1]) + P[2][14]*(-P[12][0]*S_inv[0][2] - P[12][1]*S_inv[1][2] - P[12][2]*S_inv[2][2] - P[12][6]*S_inv[3][2] - P[12][7]*S_inv[4][2] - P[12][8]*S_inv[5][2]) + P[6][14]*(-P[12][0]*S_inv[0][3] - P[12][1]*S_inv[1][3] - P[12][2]*S_inv[2][3] - P[12][6]*S_inv[3][3] - P[12][7]*S_inv[4][3] - P[12][8]*S_inv[5][3]) + P[7][14]*(-P[12][0]*S_inv[0][4] - P[12][1]*S_inv[1][4] - P[12][2]*S_inv[2][4] - P[12][6]*S_inv[3][4] - P[12][7]*S_inv[4][4] - P[12][8]*S_inv[5][4]) + P[8][14]*(-P[12][0]*S_inv[0][5] - P[12][1]*S_inv[1][5] - P[12][2]*S_inv[2][5] - P[12][6]*S_inv[3][5] - P[12][7]*S_inv[4][5] - P[12][8]*S_inv[5][5]);
    P_up[13][0] = P[0][0]*(-P[13][0]*S_inv[0][0] - P[13][1]*S_inv[1][0] - P[13][2]*S_inv[2][0] - P[13][6]*S_inv[3][0] - P[13][7]*S_inv[4][0] - P[13][8]*S_inv[5][0]) + P[13][0] + P[1][0]*(-P[13][0]*S_inv[0][1] - P[13][1]*S_inv[1][1] - P[13][2]*S_inv[2][1] - P[13][6]*S_inv[3][1] - P[13][7]*S_inv[4][1] - P[13][8]*S_inv[5][1]) + P[2][0]*(-P[13][0]*S_inv[0][2] - P[13][1]*S_inv[1][2] - P[13][2]*S_inv[2][2] - P[13][6]*S_inv[3][2] - P[13][7]*S_inv[4][2] - P[13][8]*S_inv[5][2]) + P[6][0]*(-P[13][0]*S_inv[0][3] - P[13][1]*S_inv[1][3] - P[13][2]*S_inv[2][3] - P[13][6]*S_inv[3][3] - P[13][7]*S_inv[4][3] - P[13][8]*S_inv[5][3]) + P[7][0]*(-P[13][0]*S_inv[0][4] - P[13][1]*S_inv[1][4] - P[13][2]*S_inv[2][4] - P[13][6]*S_inv[3][4] - P[13][7]*S_inv[4][4] - P[13][8]*S_inv[5][4]) + P[8][0]*(-P[13][0]*S_inv[0][5] - P[13][1]*S_inv[1][5] - P[13][2]*S_inv[2][5] - P[13][6]*S_inv[3][5] - P[13][7]*S_inv[4][5] - P[13][8]*S_inv[5][5]);
    P_up[13][1] = P[0][1]*(-P[13][0]*S_inv[0][0] - P[13][1]*S_inv[1][0] - P[13][2]*S_inv[2][0] - P[13][6]*S_inv[3][0] - P[13][7]*S_inv[4][0] - P[13][8]*S_inv[5][0]) + P[13][1] + P[1][1]*(-P[13][0]*S_inv[0][1] - P[13][1]*S_inv[1][1] - P[13][2]*S_inv[2][1] - P[13][6]*S_inv[3][1] - P[13][7]*S_inv[4][1] - P[13][8]*S_inv[5][1]) + P[2][1]*(-P[13][0]*S_inv[0][2] - P[13][1]*S_inv[1][2] - P[13][2]*S_inv[2][2] - P[13][6]*S_inv[3][2] - P[13][7]*S_inv[4][2] - P[13][8]*S_inv[5][2]) + P[6][1]*(-P[13][0]*S_inv[0][3] - P[13][1]*S_inv[1][3] - P[13][2]*S_inv[2][3] - P[13][6]*S_inv[3][3] - P[13][7]*S_inv[4][3] - P[13][8]*S_inv[5][3]) + P[7][1]*(-P[13][0]*S_inv[0][4] - P[13][1]*S_inv[1][4] - P[13][2]*S_inv[2][4] - P[13][6]*S_inv[3][4] - P[13][7]*S_inv[4][4] - P[13][8]*S_inv[5][4]) + P[8][1]*(-P[13][0]*S_inv[0][5] - P[13][1]*S_inv[1][5] - P[13][2]*S_inv[2][5] - P[13][6]*S_inv[3][5] - P[13][7]*S_inv[4][5] - P[13][8]*S_inv[5][5]);
    P_up[13][2] = P[0][2]*(-P[13][0]*S_inv[0][0] - P[13][1]*S_inv[1][0] - P[13][2]*S_inv[2][0] - P[13][6]*S_inv[3][0] - P[13][7]*S_inv[4][0] - P[13][8]*S_inv[5][0]) + P[13][2] + P[1][2]*(-P[13][0]*S_inv[0][1] - P[13][1]*S_inv[1][1] - P[13][2]*S_inv[2][1] - P[13][6]*S_inv[3][1] - P[13][7]*S_inv[4][1] - P[13][8]*S_inv[5][1]) + P[2][2]*(-P[13][0]*S_inv[0][2] - P[13][1]*S_inv[1][2] - P[13][2]*S_inv[2][2] - P[13][6]*S_inv[3][2] - P[13][7]*S_inv[4][2] - P[13][8]*S_inv[5][2]) + P[6][2]*(-P[13][0]*S_inv[0][3] - P[13][1]*S_inv[1][3] - P[13][2]*S_inv[2][3] - P[13][6]*S_inv[3][3] - P[13][7]*S_inv[4][3] - P[13][8]*S_inv[5][3]) + P[7][2]*(-P[13][0]*S_inv[0][4] - P[13][1]*S_inv[1][4] - P[13][2]*S_inv[2][4] - P[13][6]*S_inv[3][4] - P[13][7]*S_inv[4][4] - P[13][8]*S_inv[5][4]) + P[8][2]*(-P[13][0]*S_inv[0][5] - P[13][1]*S_inv[1][5] - P[13][2]*S_inv[2][5] - P[13][6]*S_inv[3][5] - P[13][7]*S_inv[4][5] - P[13][8]*S_inv[5][5]);
    P_up[13][3] = P[0][3]*(-P[13][0]*S_inv[0][0] - P[13][1]*S_inv[1][0] - P[13][2]*S_inv[2][0] - P[13][6]*S_inv[3][0] - P[13][7]*S_inv[4][0] - P[13][8]*S_inv[5][0]) + P[13][3] + P[1][3]*(-P[13][0]*S_inv[0][1] - P[13][1]*S_inv[1][1] - P[13][2]*S_inv[2][1] - P[13][6]*S_inv[3][1] - P[13][7]*S_inv[4][1] - P[13][8]*S_inv[5][1]) + P[2][3]*(-P[13][0]*S_inv[0][2] - P[13][1]*S_inv[1][2] - P[13][2]*S_inv[2][2] - P[13][6]*S_inv[3][2] - P[13][7]*S_inv[4][2] - P[13][8]*S_inv[5][2]) + P[6][3]*(-P[13][0]*S_inv[0][3] - P[13][1]*S_inv[1][3] - P[13][2]*S_inv[2][3] - P[13][6]*S_inv[3][3] - P[13][7]*S_inv[4][3] - P[13][8]*S_inv[5][3]) + P[7][3]*(-P[13][0]*S_inv[0][4] - P[13][1]*S_inv[1][4] - P[13][2]*S_inv[2][4] - P[13][6]*S_inv[3][4] - P[13][7]*S_inv[4][4] - P[13][8]*S_inv[5][4]) + P[8][3]*(-P[13][0]*S_inv[0][5] - P[13][1]*S_inv[1][5] - P[13][2]*S_inv[2][5] - P[13][6]*S_inv[3][5] - P[13][7]*S_inv[4][5] - P[13][8]*S_inv[5][5]);
    P_up[13][4] = P[0][4]*(-P[13][0]*S_inv[0][0] - P[13][1]*S_inv[1][0] - P[13][2]*S_inv[2][0] - P[13][6]*S_inv[3][0] - P[13][7]*S_inv[4][0] - P[13][8]*S_inv[5][0]) + P[13][4] + P[1][4]*(-P[13][0]*S_inv[0][1] - P[13][1]*S_inv[1][1] - P[13][2]*S_inv[2][1] - P[13][6]*S_inv[3][1] - P[13][7]*S_inv[4][1] - P[13][8]*S_inv[5][1]) + P[2][4]*(-P[13][0]*S_inv[0][2] - P[13][1]*S_inv[1][2] - P[13][2]*S_inv[2][2] - P[13][6]*S_inv[3][2] - P[13][7]*S_inv[4][2] - P[13][8]*S_inv[5][2]) + P[6][4]*(-P[13][0]*S_inv[0][3] - P[13][1]*S_inv[1][3] - P[13][2]*S_inv[2][3] - P[13][6]*S_inv[3][3] - P[13][7]*S_inv[4][3] - P[13][8]*S_inv[5][3]) + P[7][4]*(-P[13][0]*S_inv[0][4] - P[13][1]*S_inv[1][4] - P[13][2]*S_inv[2][4] - P[13][6]*S_inv[3][4] - P[13][7]*S_inv[4][4] - P[13][8]*S_inv[5][4]) + P[8][4]*(-P[13][0]*S_inv[0][5] - P[13][1]*S_inv[1][5] - P[13][2]*S_inv[2][5] - P[13][6]*S_inv[3][5] - P[13][7]*S_inv[4][5] - P[13][8]*S_inv[5][5]);
    P_up[13][5] = P[0][5]*(-P[13][0]*S_inv[0][0] - P[13][1]*S_inv[1][0] - P[13][2]*S_inv[2][0] - P[13][6]*S_inv[3][0] - P[13][7]*S_inv[4][0] - P[13][8]*S_inv[5][0]) + P[13][5] + P[1][5]*(-P[13][0]*S_inv[0][1] - P[13][1]*S_inv[1][1] - P[13][2]*S_inv[2][1] - P[13][6]*S_inv[3][1] - P[13][7]*S_inv[4][1] - P[13][8]*S_inv[5][1]) + P[2][5]*(-P[13][0]*S_inv[0][2] - P[13][1]*S_inv[1][2] - P[13][2]*S_inv[2][2] - P[13][6]*S_inv[3][2] - P[13][7]*S_inv[4][2] - P[13][8]*S_inv[5][2]) + P[6][5]*(-P[13][0]*S_inv[0][3] - P[13][1]*S_inv[1][3] - P[13][2]*S_inv[2][3] - P[13][6]*S_inv[3][3] - P[13][7]*S_inv[4][3] - P[13][8]*S_inv[5][3]) + P[7][5]*(-P[13][0]*S_inv[0][4] - P[13][1]*S_inv[1][4] - P[13][2]*S_inv[2][4] - P[13][6]*S_inv[3][4] - P[13][7]*S_inv[4][4] - P[13][8]*S_inv[5][4]) + P[8][5]*(-P[13][0]*S_inv[0][5] - P[13][1]*S_inv[1][5] - P[13][2]*S_inv[2][5] - P[13][6]*S_inv[3][5] - P[13][7]*S_inv[4][5] - P[13][8]*S_inv[5][5]);
    P_up[13][6] = P[0][6]*(-P[13][0]*S_inv[0][0] - P[13][1]*S_inv[1][0] - P[13][2]*S_inv[2][0] - P[13][6]*S_inv[3][0] - P[13][7]*S_inv[4][0] - P[13][8]*S_inv[5][0]) + P[13][6] + P[1][6]*(-P[13][0]*S_inv[0][1] - P[13][1]*S_inv[1][1] - P[13][2]*S_inv[2][1] - P[13][6]*S_inv[3][1] - P[13][7]*S_inv[4][1] - P[13][8]*S_inv[5][1]) + P[2][6]*(-P[13][0]*S_inv[0][2] - P[13][1]*S_inv[1][2] - P[13][2]*S_inv[2][2] - P[13][6]*S_inv[3][2] - P[13][7]*S_inv[4][2] - P[13][8]*S_inv[5][2]) + P[6][6]*(-P[13][0]*S_inv[0][3] - P[13][1]*S_inv[1][3] - P[13][2]*S_inv[2][3] - P[13][6]*S_inv[3][3] - P[13][7]*S_inv[4][3] - P[13][8]*S_inv[5][3]) + P[7][6]*(-P[13][0]*S_inv[0][4] - P[13][1]*S_inv[1][4] - P[13][2]*S_inv[2][4] - P[13][6]*S_inv[3][4] - P[13][7]*S_inv[4][4] - P[13][8]*S_inv[5][4]) + P[8][6]*(-P[13][0]*S_inv[0][5] - P[13][1]*S_inv[1][5] - P[13][2]*S_inv[2][5] - P[13][6]*S_inv[3][5] - P[13][7]*S_inv[4][5] - P[13][8]*S_inv[5][5]);
    P_up[13][7] = P[0][7]*(-P[13][0]*S_inv[0][0] - P[13][1]*S_inv[1][0] - P[13][2]*S_inv[2][0] - P[13][6]*S_inv[3][0] - P[13][7]*S_inv[4][0] - P[13][8]*S_inv[5][0]) + P[13][7] + P[1][7]*(-P[13][0]*S_inv[0][1] - P[13][1]*S_inv[1][1] - P[13][2]*S_inv[2][1] - P[13][6]*S_inv[3][1] - P[13][7]*S_inv[4][1] - P[13][8]*S_inv[5][1]) + P[2][7]*(-P[13][0]*S_inv[0][2] - P[13][1]*S_inv[1][2] - P[13][2]*S_inv[2][2] - P[13][6]*S_inv[3][2] - P[13][7]*S_inv[4][2] - P[13][8]*S_inv[5][2]) + P[6][7]*(-P[13][0]*S_inv[0][3] - P[13][1]*S_inv[1][3] - P[13][2]*S_inv[2][3] - P[13][6]*S_inv[3][3] - P[13][7]*S_inv[4][3] - P[13][8]*S_inv[5][3]) + P[7][7]*(-P[13][0]*S_inv[0][4] - P[13][1]*S_inv[1][4] - P[13][2]*S_inv[2][4] - P[13][6]*S_inv[3][4] - P[13][7]*S_inv[4][4] - P[13][8]*S_inv[5][4]) + P[8][7]*(-P[13][0]*S_inv[0][5] - P[13][1]*S_inv[1][5] - P[13][2]*S_inv[2][5] - P[13][6]*S_inv[3][5] - P[13][7]*S_inv[4][5] - P[13][8]*S_inv[5][5]);
    P_up[13][8] = P[0][8]*(-P[13][0]*S_inv[0][0] - P[13][1]*S_inv[1][0] - P[13][2]*S_inv[2][0] - P[13][6]*S_inv[3][0] - P[13][7]*S_inv[4][0] - P[13][8]*S_inv[5][0]) + P[13][8] + P[1][8]*(-P[13][0]*S_inv[0][1] - P[13][1]*S_inv[1][1] - P[13][2]*S_inv[2][1] - P[13][6]*S_inv[3][1] - P[13][7]*S_inv[4][1] - P[13][8]*S_inv[5][1]) + P[2][8]*(-P[13][0]*S_inv[0][2] - P[13][1]*S_inv[1][2] - P[13][2]*S_inv[2][2] - P[13][6]*S_inv[3][2] - P[13][7]*S_inv[4][2] - P[13][8]*S_inv[5][2]) + P[6][8]*(-P[13][0]*S_inv[0][3] - P[13][1]*S_inv[1][3] - P[13][2]*S_inv[2][3] - P[13][6]*S_inv[3][3] - P[13][7]*S_inv[4][3] - P[13][8]*S_inv[5][3]) + P[7][8]*(-P[13][0]*S_inv[0][4] - P[13][1]*S_inv[1][4] - P[13][2]*S_inv[2][4] - P[13][6]*S_inv[3][4] - P[13][7]*S_inv[4][4] - P[13][8]*S_inv[5][4]) + P[8][8]*(-P[13][0]*S_inv[0][5] - P[13][1]*S_inv[1][5] - P[13][2]*S_inv[2][5] - P[13][6]*S_inv[3][5] - P[13][7]*S_inv[4][5] - P[13][8]*S_inv[5][5]);
    P_up[13][9] = P[0][9]*(-P[13][0]*S_inv[0][0] - P[13][1]*S_inv[1][0] - P[13][2]*S_inv[2][0] - P[13][6]*S_inv[3][0] - P[13][7]*S_inv[4][0] - P[13][8]*S_inv[5][0]) + P[13][9] + P[1][9]*(-P[13][0]*S_inv[0][1] - P[13][1]*S_inv[1][1] - P[13][2]*S_inv[2][1] - P[13][6]*S_inv[3][1] - P[13][7]*S_inv[4][1] - P[13][8]*S_inv[5][1]) + P[2][9]*(-P[13][0]*S_inv[0][2] - P[13][1]*S_inv[1][2] - P[13][2]*S_inv[2][2] - P[13][6]*S_inv[3][2] - P[13][7]*S_inv[4][2] - P[13][8]*S_inv[5][2]) + P[6][9]*(-P[13][0]*S_inv[0][3] - P[13][1]*S_inv[1][3] - P[13][2]*S_inv[2][3] - P[13][6]*S_inv[3][3] - P[13][7]*S_inv[4][3] - P[13][8]*S_inv[5][3]) + P[7][9]*(-P[13][0]*S_inv[0][4] - P[13][1]*S_inv[1][4] - P[13][2]*S_inv[2][4] - P[13][6]*S_inv[3][4] - P[13][7]*S_inv[4][4] - P[13][8]*S_inv[5][4]) + P[8][9]*(-P[13][0]*S_inv[0][5] - P[13][1]*S_inv[1][5] - P[13][2]*S_inv[2][5] - P[13][6]*S_inv[3][5] - P[13][7]*S_inv[4][5] - P[13][8]*S_inv[5][5]);
    P_up[13][10] = P[0][10]*(-P[13][0]*S_inv[0][0] - P[13][1]*S_inv[1][0] - P[13][2]*S_inv[2][0] - P[13][6]*S_inv[3][0] - P[13][7]*S_inv[4][0] - P[13][8]*S_inv[5][0]) + P[13][10] + P[1][10]*(-P[13][0]*S_inv[0][1] - P[13][1]*S_inv[1][1] - P[13][2]*S_inv[2][1] - P[13][6]*S_inv[3][1] - P[13][7]*S_inv[4][1] - P[13][8]*S_inv[5][1]) + P[2][10]*(-P[13][0]*S_inv[0][2] - P[13][1]*S_inv[1][2] - P[13][2]*S_inv[2][2] - P[13][6]*S_inv[3][2] - P[13][7]*S_inv[4][2] - P[13][8]*S_inv[5][2]) + P[6][10]*(-P[13][0]*S_inv[0][3] - P[13][1]*S_inv[1][3] - P[13][2]*S_inv[2][3] - P[13][6]*S_inv[3][3] - P[13][7]*S_inv[4][3] - P[13][8]*S_inv[5][3]) + P[7][10]*(-P[13][0]*S_inv[0][4] - P[13][1]*S_inv[1][4] - P[13][2]*S_inv[2][4] - P[13][6]*S_inv[3][4] - P[13][7]*S_inv[4][4] - P[13][8]*S_inv[5][4]) + P[8][10]*(-P[13][0]*S_inv[0][5] - P[13][1]*S_inv[1][5] - P[13][2]*S_inv[2][5] - P[13][6]*S_inv[3][5] - P[13][7]*S_inv[4][5] - P[13][8]*S_inv[5][5]);
    P_up[13][11] = P[0][11]*(-P[13][0]*S_inv[0][0] - P[13][1]*S_inv[1][0] - P[13][2]*S_inv[2][0] - P[13][6]*S_inv[3][0] - P[13][7]*S_inv[4][0] - P[13][8]*S_inv[5][0]) + P[13][11] + P[1][11]*(-P[13][0]*S_inv[0][1] - P[13][1]*S_inv[1][1] - P[13][2]*S_inv[2][1] - P[13][6]*S_inv[3][1] - P[13][7]*S_inv[4][1] - P[13][8]*S_inv[5][1]) + P[2][11]*(-P[13][0]*S_inv[0][2] - P[13][1]*S_inv[1][2] - P[13][2]*S_inv[2][2] - P[13][6]*S_inv[3][2] - P[13][7]*S_inv[4][2] - P[13][8]*S_inv[5][2]) + P[6][11]*(-P[13][0]*S_inv[0][3] - P[13][1]*S_inv[1][3] - P[13][2]*S_inv[2][3] - P[13][6]*S_inv[3][3] - P[13][7]*S_inv[4][3] - P[13][8]*S_inv[5][3]) + P[7][11]*(-P[13][0]*S_inv[0][4] - P[13][1]*S_inv[1][4] - P[13][2]*S_inv[2][4] - P[13][6]*S_inv[3][4] - P[13][7]*S_inv[4][4] - P[13][8]*S_inv[5][4]) + P[8][11]*(-P[13][0]*S_inv[0][5] - P[13][1]*S_inv[1][5] - P[13][2]*S_inv[2][5] - P[13][6]*S_inv[3][5] - P[13][7]*S_inv[4][5] - P[13][8]*S_inv[5][5]);
    P_up[13][12] = P[0][12]*(-P[13][0]*S_inv[0][0] - P[13][1]*S_inv[1][0] - P[13][2]*S_inv[2][0] - P[13][6]*S_inv[3][0] - P[13][7]*S_inv[4][0] - P[13][8]*S_inv[5][0]) + P[13][12] + P[1][12]*(-P[13][0]*S_inv[0][1] - P[13][1]*S_inv[1][1] - P[13][2]*S_inv[2][1] - P[13][6]*S_inv[3][1] - P[13][7]*S_inv[4][1] - P[13][8]*S_inv[5][1]) + P[2][12]*(-P[13][0]*S_inv[0][2] - P[13][1]*S_inv[1][2] - P[13][2]*S_inv[2][2] - P[13][6]*S_inv[3][2] - P[13][7]*S_inv[4][2] - P[13][8]*S_inv[5][2]) + P[6][12]*(-P[13][0]*S_inv[0][3] - P[13][1]*S_inv[1][3] - P[13][2]*S_inv[2][3] - P[13][6]*S_inv[3][3] - P[13][7]*S_inv[4][3] - P[13][8]*S_inv[5][3]) + P[7][12]*(-P[13][0]*S_inv[0][4] - P[13][1]*S_inv[1][4] - P[13][2]*S_inv[2][4] - P[13][6]*S_inv[3][4] - P[13][7]*S_inv[4][4] - P[13][8]*S_inv[5][4]) + P[8][12]*(-P[13][0]*S_inv[0][5] - P[13][1]*S_inv[1][5] - P[13][2]*S_inv[2][5] - P[13][6]*S_inv[3][5] - P[13][7]*S_inv[4][5] - P[13][8]*S_inv[5][5]);
    P_up[13][13] = P[0][13]*(-P[13][0]*S_inv[0][0] - P[13][1]*S_inv[1][0] - P[13][2]*S_inv[2][0] - P[13][6]*S_inv[3][0] - P[13][7]*S_inv[4][0] - P[13][8]*S_inv[5][0]) + P[13][13] + P[1][13]*(-P[13][0]*S_inv[0][1] - P[13][1]*S_inv[1][1] - P[13][2]*S_inv[2][1] - P[13][6]*S_inv[3][1] - P[13][7]*S_inv[4][1] - P[13][8]*S_inv[5][1]) + P[2][13]*(-P[13][0]*S_inv[0][2] - P[13][1]*S_inv[1][2] - P[13][2]*S_inv[2][2] - P[13][6]*S_inv[3][2] - P[13][7]*S_inv[4][2] - P[13][8]*S_inv[5][2]) + P[6][13]*(-P[13][0]*S_inv[0][3] - P[13][1]*S_inv[1][3] - P[13][2]*S_inv[2][3] - P[13][6]*S_inv[3][3] - P[13][7]*S_inv[4][3] - P[13][8]*S_inv[5][3]) + P[7][13]*(-P[13][0]*S_inv[0][4] - P[13][1]*S_inv[1][4] - P[13][2]*S_inv[2][4] - P[13][6]*S_inv[3][4] - P[13][7]*S_inv[4][4] - P[13][8]*S_inv[5][4]) + P[8][13]*(-P[13][0]*S_inv[0][5] - P[13][1]*S_inv[1][5] - P[13][2]*S_inv[2][5] - P[13][6]*S_inv[3][5] - P[13][7]*S_inv[4][5] - P[13][8]*S_inv[5][5]);
    P_up[13][14] = P[0][14]*(-P[13][0]*S_inv[0][0] - P[13][1]*S_inv[1][0] - P[13][2]*S_inv[2][0] - P[13][6]*S_inv[3][0] - P[13][7]*S_inv[4][0] - P[13][8]*S_inv[5][0]) + P[13][14] + P[1][14]*(-P[13][0]*S_inv[0][1] - P[13][1]*S_inv[1][1] - P[13][2]*S_inv[2][1] - P[13][6]*S_inv[3][1] - P[13][7]*S_inv[4][1] - P[13][8]*S_inv[5][1]) + P[2][14]*(-P[13][0]*S_inv[0][2] - P[13][1]*S_inv[1][2] - P[13][2]*S_inv[2][2] - P[13][6]*S_inv[3][2] - P[13][7]*S_inv[4][2] - P[13][8]*S_inv[5][2]) + P[6][14]*(-P[13][0]*S_inv[0][3] - P[13][1]*S_inv[1][3] - P[13][2]*S_inv[2][3] - P[13][6]*S_inv[3][3] - P[13][7]*S_inv[4][3] - P[13][8]*S_inv[5][3]) + P[7][14]*(-P[13][0]*S_inv[0][4] - P[13][1]*S_inv[1][4] - P[13][2]*S_inv[2][4] - P[13][6]*S_inv[3][4] - P[13][7]*S_inv[4][4] - P[13][8]*S_inv[5][4]) + P[8][14]*(-P[13][0]*S_inv[0][5] - P[13][1]*S_inv[1][5] - P[13][2]*S_inv[2][5] - P[13][6]*S_inv[3][5] - P[13][7]*S_inv[4][5] - P[13][8]*S_inv[5][5]);
    P_up[14][0] = P[0][0]*(-P[14][0]*S_inv[0][0] - P[14][1]*S_inv[1][0] - P[14][2]*S_inv[2][0] - P[14][6]*S_inv[3][0] - P[14][7]*S_inv[4][0] - P[14][8]*S_inv[5][0]) + P[14][0] + P[1][0]*(-P[14][0]*S_inv[0][1] - P[14][1]*S_inv[1][1] - P[14][2]*S_inv[2][1] - P[14][6]*S_inv[3][1] - P[14][7]*S_inv[4][1] - P[14][8]*S_inv[5][1]) + P[2][0]*(-P[14][0]*S_inv[0][2] - P[14][1]*S_inv[1][2] - P[14][2]*S_inv[2][2] - P[14][6]*S_inv[3][2] - P[14][7]*S_inv[4][2] - P[14][8]*S_inv[5][2]) + P[6][0]*(-P[14][0]*S_inv[0][3] - P[14][1]*S_inv[1][3] - P[14][2]*S_inv[2][3] - P[14][6]*S_inv[3][3] - P[14][7]*S_inv[4][3] - P[14][8]*S_inv[5][3]) + P[7][0]*(-P[14][0]*S_inv[0][4] - P[14][1]*S_inv[1][4] - P[14][2]*S_inv[2][4] - P[14][6]*S_inv[3][4] - P[14][7]*S_inv[4][4] - P[14][8]*S_inv[5][4]) + P[8][0]*(-P[14][0]*S_inv[0][5] - P[14][1]*S_inv[1][5] - P[14][2]*S_inv[2][5] - P[14][6]*S_inv[3][5] - P[14][7]*S_inv[4][5] - P[14][8]*S_inv[5][5]);
    P_up[14][1] = P[0][1]*(-P[14][0]*S_inv[0][0] - P[14][1]*S_inv[1][0] - P[14][2]*S_inv[2][0] - P[14][6]*S_inv[3][0] - P[14][7]*S_inv[4][0] - P[14][8]*S_inv[5][0]) + P[14][1] + P[1][1]*(-P[14][0]*S_inv[0][1] - P[14][1]*S_inv[1][1] - P[14][2]*S_inv[2][1] - P[14][6]*S_inv[3][1] - P[14][7]*S_inv[4][1] - P[14][8]*S_inv[5][1]) + P[2][1]*(-P[14][0]*S_inv[0][2] - P[14][1]*S_inv[1][2] - P[14][2]*S_inv[2][2] - P[14][6]*S_inv[3][2] - P[14][7]*S_inv[4][2] - P[14][8]*S_inv[5][2]) + P[6][1]*(-P[14][0]*S_inv[0][3] - P[14][1]*S_inv[1][3] - P[14][2]*S_inv[2][3] - P[14][6]*S_inv[3][3] - P[14][7]*S_inv[4][3] - P[14][8]*S_inv[5][3]) + P[7][1]*(-P[14][0]*S_inv[0][4] - P[14][1]*S_inv[1][4] - P[14][2]*S_inv[2][4] - P[14][6]*S_inv[3][4] - P[14][7]*S_inv[4][4] - P[14][8]*S_inv[5][4]) + P[8][1]*(-P[14][0]*S_inv[0][5] - P[14][1]*S_inv[1][5] - P[14][2]*S_inv[2][5] - P[14][6]*S_inv[3][5] - P[14][7]*S_inv[4][5] - P[14][8]*S_inv[5][5]);
    P_up[14][2] = P[0][2]*(-P[14][0]*S_inv[0][0] - P[14][1]*S_inv[1][0] - P[14][2]*S_inv[2][0] - P[14][6]*S_inv[3][0] - P[14][7]*S_inv[4][0] - P[14][8]*S_inv[5][0]) + P[14][2] + P[1][2]*(-P[14][0]*S_inv[0][1] - P[14][1]*S_inv[1][1] - P[14][2]*S_inv[2][1] - P[14][6]*S_inv[3][1] - P[14][7]*S_inv[4][1] - P[14][8]*S_inv[5][1]) + P[2][2]*(-P[14][0]*S_inv[0][2] - P[14][1]*S_inv[1][2] - P[14][2]*S_inv[2][2] - P[14][6]*S_inv[3][2] - P[14][7]*S_inv[4][2] - P[14][8]*S_inv[5][2]) + P[6][2]*(-P[14][0]*S_inv[0][3] - P[14][1]*S_inv[1][3] - P[14][2]*S_inv[2][3] - P[14][6]*S_inv[3][3] - P[14][7]*S_inv[4][3] - P[14][8]*S_inv[5][3]) + P[7][2]*(-P[14][0]*S_inv[0][4] - P[14][1]*S_inv[1][4] - P[14][2]*S_inv[2][4] - P[14][6]*S_inv[3][4] - P[14][7]*S_inv[4][4] - P[14][8]*S_inv[5][4]) + P[8][2]*(-P[14][0]*S_inv[0][5] - P[14][1]*S_inv[1][5] - P[14][2]*S_inv[2][5] - P[14][6]*S_inv[3][5] - P[14][7]*S_inv[4][5] - P[14][8]*S_inv[5][5]);
    P_up[14][3] = P[0][3]*(-P[14][0]*S_inv[0][0] - P[14][1]*S_inv[1][0] - P[14][2]*S_inv[2][0] - P[14][6]*S_inv[3][0] - P[14][7]*S_inv[4][0] - P[14][8]*S_inv[5][0]) + P[14][3] + P[1][3]*(-P[14][0]*S_inv[0][1] - P[14][1]*S_inv[1][1] - P[14][2]*S_inv[2][1] - P[14][6]*S_inv[3][1] - P[14][7]*S_inv[4][1] - P[14][8]*S_inv[5][1]) + P[2][3]*(-P[14][0]*S_inv[0][2] - P[14][1]*S_inv[1][2] - P[14][2]*S_inv[2][2] - P[14][6]*S_inv[3][2] - P[14][7]*S_inv[4][2] - P[14][8]*S_inv[5][2]) + P[6][3]*(-P[14][0]*S_inv[0][3] - P[14][1]*S_inv[1][3] - P[14][2]*S_inv[2][3] - P[14][6]*S_inv[3][3] - P[14][7]*S_inv[4][3] - P[14][8]*S_inv[5][3]) + P[7][3]*(-P[14][0]*S_inv[0][4] - P[14][1]*S_inv[1][4] - P[14][2]*S_inv[2][4] - P[14][6]*S_inv[3][4] - P[14][7]*S_inv[4][4] - P[14][8]*S_inv[5][4]) + P[8][3]*(-P[14][0]*S_inv[0][5] - P[14][1]*S_inv[1][5] - P[14][2]*S_inv[2][5] - P[14][6]*S_inv[3][5] - P[14][7]*S_inv[4][5] - P[14][8]*S_inv[5][5]);
    P_up[14][4] = P[0][4]*(-P[14][0]*S_inv[0][0] - P[14][1]*S_inv[1][0] - P[14][2]*S_inv[2][0] - P[14][6]*S_inv[3][0] - P[14][7]*S_inv[4][0] - P[14][8]*S_inv[5][0]) + P[14][4] + P[1][4]*(-P[14][0]*S_inv[0][1] - P[14][1]*S_inv[1][1] - P[14][2]*S_inv[2][1] - P[14][6]*S_inv[3][1] - P[14][7]*S_inv[4][1] - P[14][8]*S_inv[5][1]) + P[2][4]*(-P[14][0]*S_inv[0][2] - P[14][1]*S_inv[1][2] - P[14][2]*S_inv[2][2] - P[14][6]*S_inv[3][2] - P[14][7]*S_inv[4][2] - P[14][8]*S_inv[5][2]) + P[6][4]*(-P[14][0]*S_inv[0][3] - P[14][1]*S_inv[1][3] - P[14][2]*S_inv[2][3] - P[14][6]*S_inv[3][3] - P[14][7]*S_inv[4][3] - P[14][8]*S_inv[5][3]) + P[7][4]*(-P[14][0]*S_inv[0][4] - P[14][1]*S_inv[1][4] - P[14][2]*S_inv[2][4] - P[14][6]*S_inv[3][4] - P[14][7]*S_inv[4][4] - P[14][8]*S_inv[5][4]) + P[8][4]*(-P[14][0]*S_inv[0][5] - P[14][1]*S_inv[1][5] - P[14][2]*S_inv[2][5] - P[14][6]*S_inv[3][5] - P[14][7]*S_inv[4][5] - P[14][8]*S_inv[5][5]);
    P_up[14][5] = P[0][5]*(-P[14][0]*S_inv[0][0] - P[14][1]*S_inv[1][0] - P[14][2]*S_inv[2][0] - P[14][6]*S_inv[3][0] - P[14][7]*S_inv[4][0] - P[14][8]*S_inv[5][0]) + P[14][5] + P[1][5]*(-P[14][0]*S_inv[0][1] - P[14][1]*S_inv[1][1] - P[14][2]*S_inv[2][1] - P[14][6]*S_inv[3][1] - P[14][7]*S_inv[4][1] - P[14][8]*S_inv[5][1]) + P[2][5]*(-P[14][0]*S_inv[0][2] - P[14][1]*S_inv[1][2] - P[14][2]*S_inv[2][2] - P[14][6]*S_inv[3][2] - P[14][7]*S_inv[4][2] - P[14][8]*S_inv[5][2]) + P[6][5]*(-P[14][0]*S_inv[0][3] - P[14][1]*S_inv[1][3] - P[14][2]*S_inv[2][3] - P[14][6]*S_inv[3][3] - P[14][7]*S_inv[4][3] - P[14][8]*S_inv[5][3]) + P[7][5]*(-P[14][0]*S_inv[0][4] - P[14][1]*S_inv[1][4] - P[14][2]*S_inv[2][4] - P[14][6]*S_inv[3][4] - P[14][7]*S_inv[4][4] - P[14][8]*S_inv[5][4]) + P[8][5]*(-P[14][0]*S_inv[0][5] - P[14][1]*S_inv[1][5] - P[14][2]*S_inv[2][5] - P[14][6]*S_inv[3][5] - P[14][7]*S_inv[4][5] - P[14][8]*S_inv[5][5]);
    P_up[14][6] = P[0][6]*(-P[14][0]*S_inv[0][0] - P[14][1]*S_inv[1][0] - P[14][2]*S_inv[2][0] - P[14][6]*S_inv[3][0] - P[14][7]*S_inv[4][0] - P[14][8]*S_inv[5][0]) + P[14][6] + P[1][6]*(-P[14][0]*S_inv[0][1] - P[14][1]*S_inv[1][1] - P[14][2]*S_inv[2][1] - P[14][6]*S_inv[3][1] - P[14][7]*S_inv[4][1] - P[14][8]*S_inv[5][1]) + P[2][6]*(-P[14][0]*S_inv[0][2] - P[14][1]*S_inv[1][2] - P[14][2]*S_inv[2][2] - P[14][6]*S_inv[3][2] - P[14][7]*S_inv[4][2] - P[14][8]*S_inv[5][2]) + P[6][6]*(-P[14][0]*S_inv[0][3] - P[14][1]*S_inv[1][3] - P[14][2]*S_inv[2][3] - P[14][6]*S_inv[3][3] - P[14][7]*S_inv[4][3] - P[14][8]*S_inv[5][3]) + P[7][6]*(-P[14][0]*S_inv[0][4] - P[14][1]*S_inv[1][4] - P[14][2]*S_inv[2][4] - P[14][6]*S_inv[3][4] - P[14][7]*S_inv[4][4] - P[14][8]*S_inv[5][4]) + P[8][6]*(-P[14][0]*S_inv[0][5] - P[14][1]*S_inv[1][5] - P[14][2]*S_inv[2][5] - P[14][6]*S_inv[3][5] - P[14][7]*S_inv[4][5] - P[14][8]*S_inv[5][5]);
    P_up[14][7] = P[0][7]*(-P[14][0]*S_inv[0][0] - P[14][1]*S_inv[1][0] - P[14][2]*S_inv[2][0] - P[14][6]*S_inv[3][0] - P[14][7]*S_inv[4][0] - P[14][8]*S_inv[5][0]) + P[14][7] + P[1][7]*(-P[14][0]*S_inv[0][1] - P[14][1]*S_inv[1][1] - P[14][2]*S_inv[2][1] - P[14][6]*S_inv[3][1] - P[14][7]*S_inv[4][1] - P[14][8]*S_inv[5][1]) + P[2][7]*(-P[14][0]*S_inv[0][2] - P[14][1]*S_inv[1][2] - P[14][2]*S_inv[2][2] - P[14][6]*S_inv[3][2] - P[14][7]*S_inv[4][2] - P[14][8]*S_inv[5][2]) + P[6][7]*(-P[14][0]*S_inv[0][3] - P[14][1]*S_inv[1][3] - P[14][2]*S_inv[2][3] - P[14][6]*S_inv[3][3] - P[14][7]*S_inv[4][3] - P[14][8]*S_inv[5][3]) + P[7][7]*(-P[14][0]*S_inv[0][4] - P[14][1]*S_inv[1][4] - P[14][2]*S_inv[2][4] - P[14][6]*S_inv[3][4] - P[14][7]*S_inv[4][4] - P[14][8]*S_inv[5][4]) + P[8][7]*(-P[14][0]*S_inv[0][5] - P[14][1]*S_inv[1][5] - P[14][2]*S_inv[2][5] - P[14][6]*S_inv[3][5] - P[14][7]*S_inv[4][5] - P[14][8]*S_inv[5][5]);
    P_up[14][8] = P[0][8]*(-P[14][0]*S_inv[0][0] - P[14][1]*S_inv[1][0] - P[14][2]*S_inv[2][0] - P[14][6]*S_inv[3][0] - P[14][7]*S_inv[4][0] - P[14][8]*S_inv[5][0]) + P[14][8] + P[1][8]*(-P[14][0]*S_inv[0][1] - P[14][1]*S_inv[1][1] - P[14][2]*S_inv[2][1] - P[14][6]*S_inv[3][1] - P[14][7]*S_inv[4][1] - P[14][8]*S_inv[5][1]) + P[2][8]*(-P[14][0]*S_inv[0][2] - P[14][1]*S_inv[1][2] - P[14][2]*S_inv[2][2] - P[14][6]*S_inv[3][2] - P[14][7]*S_inv[4][2] - P[14][8]*S_inv[5][2]) + P[6][8]*(-P[14][0]*S_inv[0][3] - P[14][1]*S_inv[1][3] - P[14][2]*S_inv[2][3] - P[14][6]*S_inv[3][3] - P[14][7]*S_inv[4][3] - P[14][8]*S_inv[5][3]) + P[7][8]*(-P[14][0]*S_inv[0][4] - P[14][1]*S_inv[1][4] - P[14][2]*S_inv[2][4] - P[14][6]*S_inv[3][4] - P[14][7]*S_inv[4][4] - P[14][8]*S_inv[5][4]) + P[8][8]*(-P[14][0]*S_inv[0][5] - P[14][1]*S_inv[1][5] - P[14][2]*S_inv[2][5] - P[14][6]*S_inv[3][5] - P[14][7]*S_inv[4][5] - P[14][8]*S_inv[5][5]);
    P_up[14][9] = P[0][9]*(-P[14][0]*S_inv[0][0] - P[14][1]*S_inv[1][0] - P[14][2]*S_inv[2][0] - P[14][6]*S_inv[3][0] - P[14][7]*S_inv[4][0] - P[14][8]*S_inv[5][0]) + P[14][9] + P[1][9]*(-P[14][0]*S_inv[0][1] - P[14][1]*S_inv[1][1] - P[14][2]*S_inv[2][1] - P[14][6]*S_inv[3][1] - P[14][7]*S_inv[4][1] - P[14][8]*S_inv[5][1]) + P[2][9]*(-P[14][0]*S_inv[0][2] - P[14][1]*S_inv[1][2] - P[14][2]*S_inv[2][2] - P[14][6]*S_inv[3][2] - P[14][7]*S_inv[4][2] - P[14][8]*S_inv[5][2]) + P[6][9]*(-P[14][0]*S_inv[0][3] - P[14][1]*S_inv[1][3] - P[14][2]*S_inv[2][3] - P[14][6]*S_inv[3][3] - P[14][7]*S_inv[4][3] - P[14][8]*S_inv[5][3]) + P[7][9]*(-P[14][0]*S_inv[0][4] - P[14][1]*S_inv[1][4] - P[14][2]*S_inv[2][4] - P[14][6]*S_inv[3][4] - P[14][7]*S_inv[4][4] - P[14][8]*S_inv[5][4]) + P[8][9]*(-P[14][0]*S_inv[0][5] - P[14][1]*S_inv[1][5] - P[14][2]*S_inv[2][5] - P[14][6]*S_inv[3][5] - P[14][7]*S_inv[4][5] - P[14][8]*S_inv[5][5]);
    P_up[14][10] = P[0][10]*(-P[14][0]*S_inv[0][0] - P[14][1]*S_inv[1][0] - P[14][2]*S_inv[2][0] - P[14][6]*S_inv[3][0] - P[14][7]*S_inv[4][0] - P[14][8]*S_inv[5][0]) + P[14][10] + P[1][10]*(-P[14][0]*S_inv[0][1] - P[14][1]*S_inv[1][1] - P[14][2]*S_inv[2][1] - P[14][6]*S_inv[3][1] - P[14][7]*S_inv[4][1] - P[14][8]*S_inv[5][1]) + P[2][10]*(-P[14][0]*S_inv[0][2] - P[14][1]*S_inv[1][2] - P[14][2]*S_inv[2][2] - P[14][6]*S_inv[3][2] - P[14][7]*S_inv[4][2] - P[14][8]*S_inv[5][2]) + P[6][10]*(-P[14][0]*S_inv[0][3] - P[14][1]*S_inv[1][3] - P[14][2]*S_inv[2][3] - P[14][6]*S_inv[3][3] - P[14][7]*S_inv[4][3] - P[14][8]*S_inv[5][3]) + P[7][10]*(-P[14][0]*S_inv[0][4] - P[14][1]*S_inv[1][4] - P[14][2]*S_inv[2][4] - P[14][6]*S_inv[3][4] - P[14][7]*S_inv[4][4] - P[14][8]*S_inv[5][4]) + P[8][10]*(-P[14][0]*S_inv[0][5] - P[14][1]*S_inv[1][5] - P[14][2]*S_inv[2][5] - P[14][6]*S_inv[3][5] - P[14][7]*S_inv[4][5] - P[14][8]*S_inv[5][5]);
    P_up[14][11] = P[0][11]*(-P[14][0]*S_inv[0][0] - P[14][1]*S_inv[1][0] - P[14][2]*S_inv[2][0] - P[14][6]*S_inv[3][0] - P[14][7]*S_inv[4][0] - P[14][8]*S_inv[5][0]) + P[14][11] + P[1][11]*(-P[14][0]*S_inv[0][1] - P[14][1]*S_inv[1][1] - P[14][2]*S_inv[2][1] - P[14][6]*S_inv[3][1] - P[14][7]*S_inv[4][1] - P[14][8]*S_inv[5][1]) + P[2][11]*(-P[14][0]*S_inv[0][2] - P[14][1]*S_inv[1][2] - P[14][2]*S_inv[2][2] - P[14][6]*S_inv[3][2] - P[14][7]*S_inv[4][2] - P[14][8]*S_inv[5][2]) + P[6][11]*(-P[14][0]*S_inv[0][3] - P[14][1]*S_inv[1][3] - P[14][2]*S_inv[2][3] - P[14][6]*S_inv[3][3] - P[14][7]*S_inv[4][3] - P[14][8]*S_inv[5][3]) + P[7][11]*(-P[14][0]*S_inv[0][4] - P[14][1]*S_inv[1][4] - P[14][2]*S_inv[2][4] - P[14][6]*S_inv[3][4] - P[14][7]*S_inv[4][4] - P[14][8]*S_inv[5][4]) + P[8][11]*(-P[14][0]*S_inv[0][5] - P[14][1]*S_inv[1][5] - P[14][2]*S_inv[2][5] - P[14][6]*S_inv[3][5] - P[14][7]*S_inv[4][5] - P[14][8]*S_inv[5][5]);
    P_up[14][12] = P[0][12]*(-P[14][0]*S_inv[0][0] - P[14][1]*S_inv[1][0] - P[14][2]*S_inv[2][0] - P[14][6]*S_inv[3][0] - P[14][7]*S_inv[4][0] - P[14][8]*S_inv[5][0]) + P[14][12] + P[1][12]*(-P[14][0]*S_inv[0][1] - P[14][1]*S_inv[1][1] - P[14][2]*S_inv[2][1] - P[14][6]*S_inv[3][1] - P[14][7]*S_inv[4][1] - P[14][8]*S_inv[5][1]) + P[2][12]*(-P[14][0]*S_inv[0][2] - P[14][1]*S_inv[1][2] - P[14][2]*S_inv[2][2] - P[14][6]*S_inv[3][2] - P[14][7]*S_inv[4][2] - P[14][8]*S_inv[5][2]) + P[6][12]*(-P[14][0]*S_inv[0][3] - P[14][1]*S_inv[1][3] - P[14][2]*S_inv[2][3] - P[14][6]*S_inv[3][3] - P[14][7]*S_inv[4][3] - P[14][8]*S_inv[5][3]) + P[7][12]*(-P[14][0]*S_inv[0][4] - P[14][1]*S_inv[1][4] - P[14][2]*S_inv[2][4] - P[14][6]*S_inv[3][4] - P[14][7]*S_inv[4][4] - P[14][8]*S_inv[5][4]) + P[8][12]*(-P[14][0]*S_inv[0][5] - P[14][1]*S_inv[1][5] - P[14][2]*S_inv[2][5] - P[14][6]*S_inv[3][5] - P[14][7]*S_inv[4][5] - P[14][8]*S_inv[5][5]);
    P_up[14][13] = P[0][13]*(-P[14][0]*S_inv[0][0] - P[14][1]*S_inv[1][0] - P[14][2]*S_inv[2][0] - P[14][6]*S_inv[3][0] - P[14][7]*S_inv[4][0] - P[14][8]*S_inv[5][0]) + P[14][13] + P[1][13]*(-P[14][0]*S_inv[0][1] - P[14][1]*S_inv[1][1] - P[14][2]*S_inv[2][1] - P[14][6]*S_inv[3][1] - P[14][7]*S_inv[4][1] - P[14][8]*S_inv[5][1]) + P[2][13]*(-P[14][0]*S_inv[0][2] - P[14][1]*S_inv[1][2] - P[14][2]*S_inv[2][2] - P[14][6]*S_inv[3][2] - P[14][7]*S_inv[4][2] - P[14][8]*S_inv[5][2]) + P[6][13]*(-P[14][0]*S_inv[0][3] - P[14][1]*S_inv[1][3] - P[14][2]*S_inv[2][3] - P[14][6]*S_inv[3][3] - P[14][7]*S_inv[4][3] - P[14][8]*S_inv[5][3]) + P[7][13]*(-P[14][0]*S_inv[0][4] - P[14][1]*S_inv[1][4] - P[14][2]*S_inv[2][4] - P[14][6]*S_inv[3][4] - P[14][7]*S_inv[4][4] - P[14][8]*S_inv[5][4]) + P[8][13]*(-P[14][0]*S_inv[0][5] - P[14][1]*S_inv[1][5] - P[14][2]*S_inv[2][5] - P[14][6]*S_inv[3][5] - P[14][7]*S_inv[4][5] - P[14][8]*S_inv[5][5]);
    P_up[14][14] = P[0][14]*(-P[14][0]*S_inv[0][0] - P[14][1]*S_inv[1][0] - P[14][2]*S_inv[2][0] - P[14][6]*S_inv[3][0] - P[14][7]*S_inv[4][0] - P[14][8]*S_inv[5][0]) + P[14][14] + P[1][14]*(-P[14][0]*S_inv[0][1] - P[14][1]*S_inv[1][1] - P[14][2]*S_inv[2][1] - P[14][6]*S_inv[3][1] - P[14][7]*S_inv[4][1] - P[14][8]*S_inv[5][1]) + P[2][14]*(-P[14][0]*S_inv[0][2] - P[14][1]*S_inv[1][2] - P[14][2]*S_inv[2][2] - P[14][6]*S_inv[3][2] - P[14][7]*S_inv[4][2] - P[14][8]*S_inv[5][2]) + P[6][14]*(-P[14][0]*S_inv[0][3] - P[14][1]*S_inv[1][3] - P[14][2]*S_inv[2][3] - P[14][6]*S_inv[3][3] - P[14][7]*S_inv[4][3] - P[14][8]*S_inv[5][3]) + P[7][14]*(-P[14][0]*S_inv[0][4] - P[14][1]*S_inv[1][4] - P[14][2]*S_inv[2][4] - P[14][6]*S_inv[3][4] - P[14][7]*S_inv[4][4] - P[14][8]*S_inv[5][4]) + P[8][14]*(-P[14][0]*S_inv[0][5] - P[14][1]*S_inv[1][5] - P[14][2]*S_inv[2][5] - P[14][6]*S_inv[3][5] - P[14][7]*S_inv[4][5] - P[14][8]*S_inv[5][5]);

    // [3] overwrite state and covariance
    int i,j;
    for(i=0;i<N_STATES;i++) {
        X[i] = X_up[i];
        for(j=0;j<N_STATES;j++) {
            P[i][j] = P_up[i][j];
        }
    }
}